"use strict";(self.webpackChunkpixelplanet=self.webpackChunkpixelplanet||[]).push([[545],{865:(t,e,i)=>{i.r(e),i.d(e,{default:()=>ae});var s=i(7294),a=i(743),n=i(5823),r=i.n(n),h=Object.defineProperty,o=(t,e)=>{for(var i in e)h(t,i,{get:e[i],enumerable:!0})},m=(t,e,i)=>(((t,e,i)=>{e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);o({},{bt709:()=>l});var l={};o(l,{Y:()=>u,x:()=>_,y:()=>c});var u=(t=>(t[t.RED=.2126]="RED",t[t.GREEN=.7152]="GREEN",t[t.BLUE=.0722]="BLUE",t[t.WHITE=1]="WHITE",t))(u||{}),_=(t=>(t[t.RED=.64]="RED",t[t.GREEN=.3]="GREEN",t[t.BLUE=.15]="BLUE",t[t.WHITE=.3127]="WHITE",t))(_||{}),c=(t=>(t[t.RED=.33]="RED",t[t.GREEN=.6]="GREEN",t[t.BLUE=.06]="BLUE",t[t.WHITE=.329]="WHITE",t))(c||{});function d(t){return t>.04045?((t+.055)/1.055)**2.4:t/12.92}function g(t,e,i){return{x:.4124*(t=d(t/255))+.3576*(e=d(e/255))+.1805*(i=d(i/255)),y:.2126*t+.7152*e+.0722*i,z:.0193*t+.1192*e+.9505*i}}o({},{lab2rgb:()=>q,lab2xyz:()=>G,rgb2hsl:()=>k,rgb2lab:()=>E,rgb2xyz:()=>g,xyz2lab:()=>C,xyz2rgb:()=>T});var p={};function M(t){return t*(Math.PI/180)}function b(t,e,i){let s=t;return s<e&&(s=e),s<i&&(s=i),s}function f(t,e,i){let s=t;return s>e&&(s=e),s>i&&(s=i),s}function x(t,e,i){return t>i&&(t=i),t<e&&(t=e),0|t}function w(t){return(t=Math.round(t))>255?t=255:t<0&&(t=0),t}function y(t){return t>255?t=255:t<0&&(t=0),t}function S(t,e){const i=typeof t[0];let s;if("number"===i||"string"===i){const i=Object.create(null);for(let e=0,s=t.length;e<s;e++){const s=t[e];i[s]||0===i[s]||(i[s]=e)}s=t.sort(((t,s)=>e(t,s)||i[t]-i[s]))}else{const i=t.slice(0);s=t.sort(((t,s)=>e(t,s)||i.indexOf(t)-i.indexOf(s)))}return s}function k(t,e,i){const s=f(t,e,i),a=b(t,e,i),n=a-s,r=(s+a)/510;let h=0;r>0&&r<1&&(h=n/(r<.5?a+s:510-a-s));let o=0;return n>0&&(o=a===t?(e-i)/n:a===e?2+(i-t)/n:4+(t-e)/n,o*=60,o<0&&(o+=360)),{h:o,s:h,l:r}}o(p,{degrees2radians:()=>M,inRange0to255:()=>y,inRange0to255Rounded:()=>w,intInRange:()=>x,max3:()=>b,min3:()=>f,stableSort:()=>S});var v=.95047,A=1,B=1.08883;function z(t){return t>.008856?t**(1/3):7.787*t+16/116}function C(t,e,i){if(t=z(t/v),e=z(e/A),i=z(i/B),116*e-16<0)throw new Error("xxx");return{L:Math.max(0,116*e-16),a:500*(t-e),b:200*(e-i)}}function E(t,e,i){const s=g(t,e,i);return C(s.x,s.y,s.z)}var I=.95047,P=1,R=1.08883;function D(t){return t>.206893034?t**3:(t-16/116)/7.787}function G(t,e,i){const s=(t+16)/116,a=s-i/200;return{x:I*D(e/500+s),y:P*D(s),z:R*D(a)}}function N(t){return t>.0031308?1.055*t**(1/2.4)-.055:12.92*t}function T(t,e,i){const s=N(3.2406*t+-1.5372*e+-.4986*i),a=N(-.9689*t+1.8758*e+.0415*i),n=N(.0557*t+-.204*e+1.057*i);return{r:w(255*s),g:w(255*a),b:w(255*n)}}function q(t,e,i){const s=G(t,e,i);return T(s.x,s.y,s.z)}var H={};o(H,{AbstractDistanceCalculator:()=>L,AbstractEuclidean:()=>j,AbstractManhattan:()=>V,CIE94GraphicArts:()=>F,CIE94Textiles:()=>W,CIEDE2000:()=>O,CMetric:()=>K,Euclidean:()=>X,EuclideanBT709:()=>$,EuclideanBT709NoAlpha:()=>Y,Manhattan:()=>J,ManhattanBT709:()=>tt,ManhattanNommyde:()=>Z,PNGQuant:()=>et});var L=class{constructor(){m(this,"_maxDistance"),m(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(t,e,i,s){this._whitePoint={r:t>0?255/t:0,g:e>0?255/e:0,b:i>0?255/i:0,a:s>0?255/s:0},this._maxDistance=this.calculateRaw(t,e,i,s,0,0,0,0)}calculateNormalized(t,e){return this.calculateRaw(t.r,t.g,t.b,t.a,e.r,e.g,e.b,e.a)/this._maxDistance}},U=class extends L{calculateRaw(t,e,i,s,a,n,r,h){const o=E(y(t*this._whitePoint.r),y(e*this._whitePoint.g),y(i*this._whitePoint.b)),m=E(y(a*this._whitePoint.r),y(n*this._whitePoint.g),y(r*this._whitePoint.b)),l=o.L-m.L,u=o.a-m.a,_=o.b-m.b,c=Math.sqrt(o.a*o.a+o.b*o.b),d=c-Math.sqrt(m.a*m.a+m.b*m.b);let g=u*u+_*_-d*d;g=g<0?0:Math.sqrt(g);const p=(h-s)*this._whitePoint.a*this._kA;return Math.sqrt((l/this._Kl)**2+(d/(1+this._K1*c))**2+(g/(1+this._K2*c))**2+p**2)}},W=class extends U{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},F=class extends U{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},Q=class extends L{_setDefaults(){}static _calculatehp(t,e){const i=Math.atan2(t,e);return i>=0?i:i+Q._deg360InRad}static _calculateRT(t,e){const i=e**7,s=2*Math.sqrt(i/(i+Q._pow25to7)),a=Q._deg30InRad*Math.exp(-(((t-Q._deg275InRad)/Q._deg25InRad)**2));return-Math.sin(2*a)*s}static _calculateT(t){return 1-.17*Math.cos(t-Q._deg30InRad)+.24*Math.cos(2*t)+.32*Math.cos(3*t+Q._deg6InRad)-.2*Math.cos(4*t-Q._deg63InRad)}static _calculate_ahp(t,e,i,s){const a=i+s;return 0===t?a:e<=Q._deg180InRad?a/2:a<Q._deg360InRad?(a+Q._deg360InRad)/2:(a-Q._deg360InRad)/2}static _calculate_dHp(t,e,i,s){let a;return a=0===t?0:e<=Q._deg180InRad?i-s:i<=s?i-s+Q._deg360InRad:i-s-Q._deg360InRad,2*Math.sqrt(t)*Math.sin(a/2)}calculateRaw(t,e,i,s,a,n,r,h){const o=E(y(t*this._whitePoint.r),y(e*this._whitePoint.g),y(i*this._whitePoint.b)),m=E(y(a*this._whitePoint.r),y(n*this._whitePoint.g),y(r*this._whitePoint.b)),l=(h-s)*this._whitePoint.a*Q._kA,u=this.calculateRawInLab(o,m);return Math.sqrt(u+l*l)}calculateRawInLab(t,e){const i=t.L,s=t.a,a=t.b,n=e.L,r=e.a,h=e.b,o=((Math.sqrt(s*s+a*a)+Math.sqrt(r*r+h*h))/2)**7,m=.5*(1-Math.sqrt(o/(o+Q._pow25to7))),l=(1+m)*s,u=(1+m)*r,_=Math.sqrt(l*l+a*a),c=Math.sqrt(u*u+h*h),d=_*c,g=Q._calculatehp(a,l),p=Q._calculatehp(h,u),M=Math.abs(g-p),b=n-i,f=c-_,x=Q._calculate_dHp(d,M,p,g),w=Q._calculate_ahp(d,M,g,p),y=(_+c)/2,S=((i+n)/2-50)**2,k=f/(1+.045*y),v=x/(1+.015*Q._calculateT(w)*y);return(b/(1+.015*S/Math.sqrt(20+S)))**2+k**2+v**2+Q._calculateRT(w,y)*k*v}},O=Q;m(O,"_kA",25/255),m(O,"_pow25to7",25**7),m(O,"_deg360InRad",M(360)),m(O,"_deg180InRad",M(180)),m(O,"_deg30InRad",M(30)),m(O,"_deg6InRad",M(6)),m(O,"_deg63InRad",M(63)),m(O,"_deg275InRad",M(275)),m(O,"_deg25InRad",M(25));var K=class extends L{calculateRaw(t,e,i,s,a,n,r,h){const o=(t+a)/2*this._whitePoint.r,m=(t-a)*this._whitePoint.r,l=(e-n)*this._whitePoint.g,u=(i-r)*this._whitePoint.b,_=((512+o)*m*m>>8)+4*l*l+((767-o)*u*u>>8),c=(h-s)*this._whitePoint.a;return Math.sqrt(_+c*c)}_setDefaults(){}},j=class extends L{calculateRaw(t,e,i,s,a,n,r,h){const o=a-t,m=n-e,l=r-i,u=h-s;return Math.sqrt(this._kR*o*o+this._kG*m*m+this._kB*l*l+this._kA*u*u)}},X=class extends j{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},$=class extends j{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},Y=class extends j{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},V=class extends L{calculateRaw(t,e,i,s,a,n,r,h){let o=a-t,m=n-e,l=r-i,u=h-s;return o<0&&(o=0-o),m<0&&(m=0-m),l<0&&(l=0-l),u<0&&(u=0-u),this._kR*o+this._kG*m+this._kB*l+this._kA*u}},J=class extends V{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},Z=class extends V{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},tt=class extends V{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},et=class extends L{calculateRaw(t,e,i,s,a,n,r,h){const o=(h-s)*this._whitePoint.a;return this._colordifferenceCh(t*this._whitePoint.r,a*this._whitePoint.r,o)+this._colordifferenceCh(e*this._whitePoint.g,n*this._whitePoint.g,o)+this._colordifferenceCh(i*this._whitePoint.b,r*this._whitePoint.b,o)}_colordifferenceCh(t,e,i){const s=t-e,a=s+i;return s*s+a*a}_setDefaults(){}};o({},{AbstractPaletteQuantizer:()=>it,ColorHistogram:()=>ft,NeuQuant:()=>dt,NeuQuantFloat:()=>Mt,RGBQuant:()=>wt,WuColorCube:()=>Bt,WuQuant:()=>Ct});var it=class{quantizeSync(){for(const t of this.quantize())if(t.palette)return t.palette;throw new Error("unreachable")}},st=class{constructor(){m(this,"r"),m(this,"g"),m(this,"b"),m(this,"a"),m(this,"uint32"),m(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(t){const e=new st;return e.r=0|t[0],e.g=0|t[1],e.b=0|t[2],e.a=0|t[3],e._loadUINT32(),e._loadQuadruplet(),e}static createByRGBA(t,e,i,s){const a=new st;return a.r=0|t,a.g=0|e,a.b=0|i,a.a=0|s,a._loadUINT32(),a._loadQuadruplet(),a}static createByUint32(t){const e=new st;return e.uint32=t>>>0,e._loadRGBA(),e._loadQuadruplet(),e}from(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.uint32=t.uint32,this.rgba[0]=t.r,this.rgba[1]=t.g,this.rgba[2]=t.b,this.rgba[3]=t.a}getLuminosity(t){let e=this.r,i=this.g,s=this.b;return t&&(e=Math.min(255,255-this.a+this.a*e/255),i=Math.min(255,255-this.a+this.a*i/255),s=Math.min(255,255-this.a+this.a*s/255)),.2126*e+.7152*i+.0722*s}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},at=class{constructor(){m(this,"_pointArray"),m(this,"_width"),m(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(t){this._width=t}setHeight(t){this._height=t}getPointArray(){return this._pointArray}clone(){const t=new at;t._width=this._width,t._height=this._height;for(let e=0,i=this._pointArray.length;e<i;e++)t._pointArray[e]=st.createByUint32(0|this._pointArray[e].uint32);return t}toUint32Array(){const t=this._pointArray.length,e=new Uint32Array(t);for(let i=0;i<t;i++)e[i]=this._pointArray[i].uint32;return e}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(t){const e=t.naturalWidth,i=t.naturalHeight,s=document.createElement("canvas");return s.width=e,s.height=i,s.getContext("2d").drawImage(t,0,0,e,i,0,0,e,i),at.fromHTMLCanvasElement(s)}static fromHTMLCanvasElement(t){const e=t.width,i=t.height,s=t.getContext("2d").getImageData(0,0,e,i);return at.fromImageData(s)}static fromImageData(t){const e=t.width,i=t.height;return at.fromUint8Array(t.data,e,i)}static fromUint8Array(t,e,i){switch(Object.prototype.toString.call(t)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:t=new Uint8Array(t)}const s=new Uint32Array(t.buffer);return at.fromUint32Array(s,e,i)}static fromUint32Array(t,e,i){const s=new at;s._width=e,s._height=i;for(let e=0,i=t.length;e<i;e++)s._pointArray[e]=st.createByUint32(0|t[e]);return s}static fromBuffer(t,e,i){const s=new Uint32Array(t.buffer,t.byteOffset,t.byteLength/Uint32Array.BYTES_PER_ELEMENT);return at.fromUint32Array(s,e,i)}};function nt(t,e){const i=360/e;for(let s=1,a=i-i/2;s<e;s++,a+=i)if(t>=a&&t<a+i)return s;return 0}var rt=class{constructor(){m(this,"_pointContainer"),m(this,"_pointArray",[]),m(this,"_i32idx",{}),this._pointContainer=new at,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(t){this._pointArray.push(t),this._pointContainer.setWidth(this._pointArray.length)}has(t){for(let e=this._pointArray.length-1;e>=0;e--)if(t.uint32===this._pointArray[e].uint32)return!0;return!1}getNearestColor(t,e){return this._pointArray[0|this._getNearestIndex(t,e)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(t){return"number"==typeof this._i32idx[t]?this._i32idx[t]:-1}_getNearestIndex(t,e){let i=this._nearestPointFromCache(""+e.uint32);if(i>=0)return i;let s=Number.MAX_VALUE;i=0;for(let a=0,n=this._pointArray.length;a<n;a++){const n=this._pointArray[a],r=t.calculateRaw(e.r,e.g,e.b,e.a,n.r,n.g,n.b,n.a);r<s&&(s=r,i=a)}return this._i32idx[e.uint32]=i,i}sort(){this._i32idx={},this._pointArray.sort(((t,e)=>{const i=k(t.r,t.g,t.b),s=k(e.r,e.g,e.b),a=t.r===t.g&&t.g===t.b?0:1+nt(i.h,10),n=(e.r===e.g&&e.g===e.b?0:1+nt(s.h,10))-a;if(n)return-n;const r=t.getLuminosity(!0),h=e.getLuminosity(!0);if(h-r!=0)return h-r;const o=(100*s.s|0)-(100*i.s|0);return o?-o:0}))}},ht={};o(ht,{HueStatistics:()=>mt,Palette:()=>rt,Point:()=>st,PointContainer:()=>at,ProgressTracker:()=>ut,arithmetic:()=>p});var ot=class{constructor(){m(this,"num",0),m(this,"cols",[])}},mt=class{constructor(t,e){m(this,"_numGroups"),m(this,"_minCols"),m(this,"_stats"),m(this,"_groupsFull"),this._numGroups=t,this._minCols=e,this._stats=[];for(let e=0;e<=t;e++)this._stats[e]=new ot;this._groupsFull=0}check(t){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const e=255&t,i=t>>>8&255,s=t>>>16&255,a=e===i&&i===s?0:1+nt(k(e,i,s).h,this._numGroups),n=this._stats[a],r=this._minCols;n.num++,n.num>r||(n.num===r&&this._groupsFull++,n.num<=r&&this._stats[a].cols.push(t))}injectIntoDictionary(t){for(let e=0;e<=this._numGroups;e++)this._stats[e].num<=this._minCols&&this._stats[e].cols.forEach((e=>{t[e]?t[e]++:t[e]=1}))}injectIntoArray(t){for(let e=0;e<=this._numGroups;e++)this._stats[e].num<=this._minCols&&this._stats[e].cols.forEach((e=>{-1===t.indexOf(e)&&t.push(e)}))}},lt=class{constructor(t,e){m(this,"progress"),m(this,"_step"),m(this,"_range"),m(this,"_last"),m(this,"_progressRange"),this._range=t,this._progressRange=e,this._step=Math.max(1,this._range/(lt.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(t){return t-this._last>=this._step&&(this._last=t,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ut=lt;m(ut,"steps",100);var _t=class{constructor(t){m(this,"r"),m(this,"g"),m(this,"b"),m(this,"a"),this.r=this.g=this.b=this.a=t}toPoint(){return st.createByRGBA(this.r>>3,this.g>>3,this.b>>3,this.a>>3)}subtract(t,e,i,s){this.r-=0|t,this.g-=0|e,this.b-=0|i,this.a-=0|s}},ct=class extends it{constructor(t,e=256){super(),m(this,"_pointArray"),m(this,"_networkSize"),m(this,"_network"),m(this,"_sampleFactor"),m(this,"_radPower"),m(this,"_freq"),m(this,"_bias"),m(this,"_distance"),this._distance=t,this._pointArray=[],this._sampleFactor=1,this._networkSize=e,this._distance.setWhitePoint(2040,2040,2040,2040)}sample(t){this._pointArray=this._pointArray.concat(t.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let t=0;t<this._networkSize;t++)this._network[t]=new _t((t<<11)/this._networkSize|0),this._freq[t]=ct._initialBias/this._networkSize|0,this._bias[t]=0}*_learn(){let t=this._sampleFactor;const e=this._pointArray.length;e<ct._minpicturebytes&&(t=1);const i=30+(t-1)/3|0,s=e/t|0;let a,n=s/ct._nCycles|0,r=ct._initAlpha,h=(this._networkSize>>3)*ct._radiusBias,o=h>>ct._radiusBiasShift;o<=1&&(o=0);for(let t=0;t<o;t++)this._radPower[t]=r*((o*o-t*t)*ct._radBias/(o*o))>>>0;a=e<ct._minpicturebytes?1:e%ct._prime1!=0?ct._prime1:e%ct._prime2!=0?ct._prime2:e%ct._prime3!=0?ct._prime3:ct._prime4;const m=new ut(s,99);for(let t=0,l=0;t<s;){m.shouldNotify(t)&&(yield{progress:m.progress});const s=this._pointArray[l],u=s.b<<3,_=s.g<<3,c=s.r<<3,d=s.a<<3,g=this._contest(u,_,c,d);if(this._alterSingle(r,g,u,_,c,d),0!==o&&this._alterNeighbour(o,g,u,_,c,d),l+=a,l>=e&&(l-=e),t++,0===n&&(n=1),t%n==0){r-=r/i|0,h-=h/ct._radiusDecrease|0,o=h>>ct._radiusBiasShift,o<=1&&(o=0);for(let t=0;t<o;t++)this._radPower[t]=r*((o*o-t*t)*ct._radBias/(o*o))>>>0}}}_buildPalette(){const t=new rt;return this._network.forEach((e=>{t.add(e.toPoint())})),t.sort(),t}_alterNeighbour(t,e,i,s,a,n){let r=e-t;r<-1&&(r=-1);let h=e+t;h>this._networkSize&&(h=this._networkSize);let o=e+1,m=e-1,l=1;for(;o<h||m>r;){const t=this._radPower[l++]/ct._alphaRadBias;if(o<h){const e=this._network[o++];e.subtract(t*(e.r-a),t*(e.g-s),t*(e.b-i),t*(e.a-n))}if(m>r){const e=this._network[m--];e.subtract(t*(e.r-a),t*(e.g-s),t*(e.b-i),t*(e.a-n))}}}_alterSingle(t,e,i,s,a,n){t/=ct._initAlpha;const r=this._network[e];r.subtract(t*(r.r-a),t*(r.g-s),t*(r.b-i),t*(r.a-n))}_contest(t,e,i,s){let a=~(1<<31),n=a,r=-1,h=r;for(let o=0;o<this._networkSize;o++){const m=this._network[o],l=8160*this._distance.calculateNormalized(m,{r:i,g:e,b:t,a:s})|0;l<a&&(a=l,r=o);const u=l-(this._bias[o]>>ct._initialBiasShift-3);u<n&&(n=u,h=o);const _=this._freq[o]>>ct._betaShift;this._freq[o]-=_,this._bias[o]+=_<<ct._gammaShift}return this._freq[r]+=ct._beta,this._bias[r]-=ct._betaGamma,h}},dt=ct;m(dt,"_prime1",499),m(dt,"_prime2",491),m(dt,"_prime3",487),m(dt,"_prime4",503),m(dt,"_minpicturebytes",ct._prime4),m(dt,"_nCycles",100),m(dt,"_initialBiasShift",16),m(dt,"_initialBias",1<<ct._initialBiasShift),m(dt,"_gammaShift",10),m(dt,"_betaShift",10),m(dt,"_beta",ct._initialBias>>ct._betaShift),m(dt,"_betaGamma",ct._initialBias<<ct._gammaShift-ct._betaShift),m(dt,"_radiusBiasShift",6),m(dt,"_radiusBias",1<<ct._radiusBiasShift),m(dt,"_radiusDecrease",30),m(dt,"_alphaBiasShift",10),m(dt,"_initAlpha",1<<ct._alphaBiasShift),m(dt,"_radBiasShift",8),m(dt,"_radBias",1<<ct._radBiasShift),m(dt,"_alphaRadBiasShift",ct._alphaBiasShift+ct._radBiasShift),m(dt,"_alphaRadBias",1<<ct._alphaRadBiasShift);var gt=class{constructor(t){m(this,"r"),m(this,"g"),m(this,"b"),m(this,"a"),this.r=this.g=this.b=this.a=t}toPoint(){return st.createByRGBA(this.r>>3,this.g>>3,this.b>>3,this.a>>3)}subtract(t,e,i,s){this.r-=t,this.g-=e,this.b-=i,this.a-=s}},pt=class extends it{constructor(t,e=256){super(),m(this,"_pointArray"),m(this,"_networkSize"),m(this,"_network"),m(this,"_sampleFactor"),m(this,"_radPower"),m(this,"_freq"),m(this,"_bias"),m(this,"_distance"),this._distance=t,this._pointArray=[],this._sampleFactor=1,this._networkSize=e,this._distance.setWhitePoint(2040,2040,2040,2040)}sample(t){this._pointArray=this._pointArray.concat(t.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let t=0;t<this._networkSize;t++)this._network[t]=new gt((t<<11)/this._networkSize),this._freq[t]=pt._initialBias/this._networkSize,this._bias[t]=0}*_learn(){let t=this._sampleFactor;const e=this._pointArray.length;e<pt._minpicturebytes&&(t=1);const i=30+(t-1)/3,s=e/t;let a,n=s/pt._nCycles|0,r=pt._initAlpha,h=(this._networkSize>>3)*pt._radiusBias,o=h>>pt._radiusBiasShift;o<=1&&(o=0);for(let t=0;t<o;t++)this._radPower[t]=r*((o*o-t*t)*pt._radBias/(o*o));a=e<pt._minpicturebytes?1:e%pt._prime1!=0?pt._prime1:e%pt._prime2!=0?pt._prime2:e%pt._prime3!=0?pt._prime3:pt._prime4;const m=new ut(s,99);for(let t=0,l=0;t<s;){m.shouldNotify(t)&&(yield{progress:m.progress});const s=this._pointArray[l],u=s.b<<3,_=s.g<<3,c=s.r<<3,d=s.a<<3,g=this._contest(u,_,c,d);if(this._alterSingle(r,g,u,_,c,d),0!==o&&this._alterNeighbour(o,g,u,_,c,d),l+=a,l>=e&&(l-=e),t++,0===n&&(n=1),t%n==0){r-=r/i,h-=h/pt._radiusDecrease,o=h>>pt._radiusBiasShift,o<=1&&(o=0);for(let t=0;t<o;t++)this._radPower[t]=r*((o*o-t*t)*pt._radBias/(o*o))}}}_buildPalette(){const t=new rt;return this._network.forEach((e=>{t.add(e.toPoint())})),t.sort(),t}_alterNeighbour(t,e,i,s,a,n){let r=e-t;r<-1&&(r=-1);let h=e+t;h>this._networkSize&&(h=this._networkSize);let o=e+1,m=e-1,l=1;for(;o<h||m>r;){const t=this._radPower[l++]/pt._alphaRadBias;if(o<h){const e=this._network[o++];e.subtract(t*(e.r-a),t*(e.g-s),t*(e.b-i),t*(e.a-n))}if(m>r){const e=this._network[m--];e.subtract(t*(e.r-a),t*(e.g-s),t*(e.b-i),t*(e.a-n))}}}_alterSingle(t,e,i,s,a,n){t/=pt._initAlpha;const r=this._network[e];r.subtract(t*(r.r-a),t*(r.g-s),t*(r.b-i),t*(r.a-n))}_contest(t,e,i,s){let a=~(1<<31),n=a,r=-1,h=r;for(let o=0;o<this._networkSize;o++){const m=this._network[o],l=8160*this._distance.calculateNormalized(m,{r:i,g:e,b:t,a:s});l<a&&(a=l,r=o);const u=l-(this._bias[o]>>pt._initialBiasShift-3);u<n&&(n=u,h=o);const _=this._freq[o]>>pt._betaShift;this._freq[o]-=_,this._bias[o]+=_<<pt._gammaShift}return this._freq[r]+=pt._beta,this._bias[r]-=pt._betaGamma,h}},Mt=pt;m(Mt,"_prime1",499),m(Mt,"_prime2",491),m(Mt,"_prime3",487),m(Mt,"_prime4",503),m(Mt,"_minpicturebytes",pt._prime4),m(Mt,"_nCycles",100),m(Mt,"_initialBiasShift",16),m(Mt,"_initialBias",1<<pt._initialBiasShift),m(Mt,"_gammaShift",10),m(Mt,"_betaShift",10),m(Mt,"_beta",pt._initialBias>>pt._betaShift),m(Mt,"_betaGamma",pt._initialBias<<pt._gammaShift-pt._betaShift),m(Mt,"_radiusBiasShift",6),m(Mt,"_radiusBias",1<<pt._radiusBiasShift),m(Mt,"_radiusDecrease",30),m(Mt,"_alphaBiasShift",10),m(Mt,"_initAlpha",1<<pt._alphaBiasShift),m(Mt,"_radBiasShift",8),m(Mt,"_radBias",1<<pt._radBiasShift),m(Mt,"_alphaRadBiasShift",pt._alphaBiasShift+pt._radBiasShift),m(Mt,"_alphaRadBias",1<<pt._alphaRadBiasShift);var bt=class{constructor(t,e){m(this,"_method"),m(this,"_hueStats"),m(this,"_histogram"),m(this,"_initColors"),m(this,"_minHueCols"),this._method=t,this._minHueCols=e<<2,this._initColors=e<<2,this._hueStats=new mt(bt._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(t){switch(this._method){case 1:this._colorStats1D(t);break;case 2:this._colorStats2D(t)}}getImportanceSortedColorsIDXI32(){const t=S(Object.keys(this._histogram),((t,e)=>this._histogram[e]-this._histogram[t]));if(0===t.length)return[];let e;switch(this._method){case 1:const i=Math.min(t.length,this._initColors),s=t[i-1],a=this._histogram[s];e=t.slice(0,i);let n=i;const r=t.length;for(;n<r&&this._histogram[t[n]]===a;)e.push(t[n++]);this._hueStats.injectIntoArray(e);break;case 2:e=t;break;default:throw new Error("Incorrect method")}return e.map((t=>+t))}_colorStats1D(t){const e=this._histogram,i=t.getPointArray(),s=i.length;for(let t=0;t<s;t++){const s=i[t].uint32;this._hueStats.check(s),s in e?e[s]++:e[s]=1}}_colorStats2D(t){const e=t.getWidth(),i=t.getHeight(),s=t.getPointArray(),a=bt._boxSize[0],n=bt._boxSize[1],r=a*n,h=this._makeBoxes(e,i,a,n),o=this._histogram;h.forEach((t=>{let i=Math.round(t.w*t.h/r)*bt._boxPixels;i<2&&(i=2);const a={};this._iterateBox(t,e,(t=>{const e=s[t].uint32;this._hueStats.check(e),e in o?o[e]++:e in a?++a[e]>=i&&(o[e]=a[e]):a[e]=1}))})),this._hueStats.injectIntoDictionary(o)}_iterateBox(t,e,i){const s=t,a=s.y*e+s.x,n=(s.y+s.h-1)*e+(s.x+s.w-1),r=e-s.w+1;let h=0,o=a;do{i.call(this,o),o+=++h%s.w==0?r:1}while(o<=n)}_makeBoxes(t,e,i,s){const a=t%i,n=e%s,r=t-a,h=e-n,o=[];for(let m=0;m<e;m+=s)for(let e=0;e<t;e+=i)o.push({x:e,y:m,w:e===r?a:i,h:m===h?n:s});return o}},ft=bt;m(ft,"_boxSize",[64,64]),m(ft,"_boxPixels",2),m(ft,"_hueGroups",10);var xt=class{constructor(t,e,i){m(this,"index"),m(this,"color"),m(this,"distance"),this.index=t,this.color=e,this.distance=i}},wt=class extends it{constructor(t,e=256,i=2){super(),m(this,"_colors"),m(this,"_initialDistance"),m(this,"_distanceIncrement"),m(this,"_histogram"),m(this,"_distance"),this._distance=t,this._colors=e,this._histogram=new ft(i,e),this._initialDistance=.01,this._distanceIncrement=.005}sample(t){this._histogram.sample(t)}*quantize(){const t=this._histogram.getImportanceSortedColorsIDXI32();if(0===t.length)throw new Error("No colors in image");yield*this._buildPalette(t)}*_buildPalette(t){const e=new rt,i=e.getPointContainer().getPointArray(),s=new Array(t.length);for(let e=0;e<t.length;e++)i.push(st.createByUint32(t[e])),s[e]=1;const a=i.length,n=[];let r=a,h=this._initialDistance;const o=new ut(r-this._colors,99);for(;r>this._colors;){n.length=0;for(let t=0;t<a;t++){if(o.shouldNotify(a-r)&&(yield{progress:o.progress}),0===s[t])continue;const e=i[t];for(let o=t+1;o<a;o++){if(0===s[o])continue;const t=i[o],a=this._distance.calculateNormalized(e,t);a<h&&(n.push(new xt(o,t,a)),s[o]=0,r--)}}h+=r>3*this._colors?this._initialDistance:this._distanceIncrement}if(r<this._colors){S(n,((t,e)=>e.distance-t.distance));let t=0;for(;r<this._colors&&t<n.length;)s[n[t].index]=1,r++,t++}let m=i.length;for(let t=m-1;t>=0;t--)0===s[t]&&(t!==m-1&&(i[t]=i[m-1]),--m);i.length=m,e.sort(),yield{palette:e,progress:100}}};function yt(t){const e=[];for(let i=0;i<t;i++)e[i]=0;return e}function St(t,e,i,s){const a=new Array(t);for(let n=0;n<t;n++){a[n]=new Array(e);for(let t=0;t<e;t++){a[n][t]=new Array(i);for(let e=0;e<i;e++){a[n][t][e]=new Array(s);for(let i=0;i<s;i++)a[n][t][e][i]=0}}}return a}function kt(t,e,i){const s=new Array(t);for(let a=0;a<t;a++){s[a]=new Array(e);for(let t=0;t<e;t++){s[a][t]=new Array(i);for(let e=0;e<i;e++)s[a][t][e]=0}}return s}function vt(t,e,i,s,a){for(let n=0;n<e;n++){t[n]=[];for(let e=0;e<i;e++){t[n][e]=[];for(let i=0;i<s;i++)t[n][e][i]=a}}}function At(t,e,i){for(let s=0;s<e;s++)t[s]=i}var Bt=class{constructor(){m(this,"redMinimum"),m(this,"redMaximum"),m(this,"greenMinimum"),m(this,"greenMaximum"),m(this,"blueMinimum"),m(this,"blueMaximum"),m(this,"volume"),m(this,"alphaMinimum"),m(this,"alphaMaximum")}},zt=class extends it{constructor(t,e=256,i=5){super(),m(this,"_reds"),m(this,"_greens"),m(this,"_blues"),m(this,"_alphas"),m(this,"_sums"),m(this,"_weights"),m(this,"_momentsRed"),m(this,"_momentsGreen"),m(this,"_momentsBlue"),m(this,"_momentsAlpha"),m(this,"_moments"),m(this,"_table"),m(this,"_pixels"),m(this,"_cubes"),m(this,"_colors"),m(this,"_significantBitsPerChannel"),m(this,"_maxSideIndex"),m(this,"_alphaMaxSideIndex"),m(this,"_sideSize"),m(this,"_alphaSideSize"),m(this,"_distance"),this._distance=t,this._setQuality(i),this._initialize(e)}sample(t){const e=t.getPointArray();for(let t=0,i=e.length;t<i;t++)this._addColor(e[t]);this._pixels=this._pixels.concat(e)}*quantize(){yield*this._preparePalette();const t=new rt;for(let e=0;e<this._colors;e++)if(this._sums[e]>0){const i=this._sums[e],s=this._reds[e]/i,a=this._greens[e]/i,n=this._blues[e]/i,r=this._alphas[e]/i,h=st.createByRGBA(0|s,0|a,0|n,0|r);t.add(h)}t.sort(),yield{palette:t,progress:100}}*_preparePalette(){yield*this._calculateMoments();let t=0;const e=yt(this._colors);for(let i=1;i<this._colors;++i){this._cut(this._cubes[t],this._cubes[i])?(e[t]=this._cubes[t].volume>1?this._calculateVariance(this._cubes[t]):0,e[i]=this._cubes[i].volume>1?this._calculateVariance(this._cubes[i]):0):(e[t]=0,i--),t=0;let s=e[0];for(let a=1;a<=i;++a)e[a]>s&&(s=e[a],t=a);if(s<=0){this._colors=i+1;break}}const i=[],s=[],a=[],n=[];for(let t=0;t<this._colors;++t){const e=zt._volume(this._cubes[t],this._weights);e>0?(i[t]=zt._volume(this._cubes[t],this._momentsRed)/e|0,s[t]=zt._volume(this._cubes[t],this._momentsGreen)/e|0,a[t]=zt._volume(this._cubes[t],this._momentsBlue)/e|0,n[t]=zt._volume(this._cubes[t],this._momentsAlpha)/e|0):(i[t]=0,s[t]=0,a[t]=0,n[t]=0)}this._reds=yt(this._colors+1),this._greens=yt(this._colors+1),this._blues=yt(this._colors+1),this._alphas=yt(this._colors+1),this._sums=yt(this._colors+1);for(let t=0,e=this._pixels.length;t<e;t++){const e=this._pixels[t];let r=-1,h=Number.MAX_VALUE;for(let t=0;t<this._colors;t++){const o=i[t],m=s[t],l=a[t],u=n[t],_=this._distance.calculateRaw(o,m,l,u,e.r,e.g,e.b,e.a);_<h&&(h=_,r=t)}this._reds[r]+=e.r,this._greens[r]+=e.g,this._blues[r]+=e.b,this._alphas[r]+=e.a,this._sums[r]++}}_addColor(t){const e=8-this._significantBitsPerChannel,i=1+(t.r>>e),s=1+(t.g>>e),a=1+(t.b>>e),n=1+(t.a>>e);this._weights[n][i][s][a]++,this._momentsRed[n][i][s][a]+=t.r,this._momentsGreen[n][i][s][a]+=t.g,this._momentsBlue[n][i][s][a]+=t.b,this._momentsAlpha[n][i][s][a]+=t.a,this._moments[n][i][s][a]+=this._table[t.r]+this._table[t.g]+this._table[t.b]+this._table[t.a]}*_calculateMoments(){const t=[],e=[],i=[],s=[],a=[],n=[],r=kt(this._sideSize,this._sideSize,this._sideSize),h=kt(this._sideSize,this._sideSize,this._sideSize),o=kt(this._sideSize,this._sideSize,this._sideSize),m=kt(this._sideSize,this._sideSize,this._sideSize),l=kt(this._sideSize,this._sideSize,this._sideSize),u=kt(this._sideSize,this._sideSize,this._sideSize);let _=0;const c=new ut(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let d=1;d<=this._alphaMaxSideIndex;++d){vt(r,this._sideSize,this._sideSize,this._sideSize,0),vt(h,this._sideSize,this._sideSize,this._sideSize,0),vt(o,this._sideSize,this._sideSize,this._sideSize,0),vt(m,this._sideSize,this._sideSize,this._sideSize,0),vt(l,this._sideSize,this._sideSize,this._sideSize,0),vt(u,this._sideSize,this._sideSize,this._sideSize,0);for(let g=1;g<=this._maxSideIndex;++g,++_){c.shouldNotify(_)&&(yield{progress:c.progress}),At(t,this._sideSize,0),At(e,this._sideSize,0),At(i,this._sideSize,0),At(s,this._sideSize,0),At(a,this._sideSize,0),At(n,this._sideSize,0);for(let _=1;_<=this._maxSideIndex;++_){let c=0,p=0,M=0,b=0,f=0,x=0;for(let w=1;w<=this._maxSideIndex;++w)c+=this._weights[d][g][_][w],p+=this._momentsRed[d][g][_][w],M+=this._momentsGreen[d][g][_][w],b+=this._momentsBlue[d][g][_][w],f+=this._momentsAlpha[d][g][_][w],x+=this._moments[d][g][_][w],t[w]+=c,e[w]+=p,i[w]+=M,s[w]+=b,a[w]+=f,n[w]+=x,r[g][_][w]=r[g-1][_][w]+t[w],h[g][_][w]=h[g-1][_][w]+e[w],o[g][_][w]=o[g-1][_][w]+i[w],m[g][_][w]=m[g-1][_][w]+s[w],l[g][_][w]=l[g-1][_][w]+a[w],u[g][_][w]=u[g-1][_][w]+n[w],this._weights[d][g][_][w]=this._weights[d-1][g][_][w]+r[g][_][w],this._momentsRed[d][g][_][w]=this._momentsRed[d-1][g][_][w]+h[g][_][w],this._momentsGreen[d][g][_][w]=this._momentsGreen[d-1][g][_][w]+o[g][_][w],this._momentsBlue[d][g][_][w]=this._momentsBlue[d-1][g][_][w]+m[g][_][w],this._momentsAlpha[d][g][_][w]=this._momentsAlpha[d-1][g][_][w]+l[g][_][w],this._moments[d][g][_][w]=this._moments[d-1][g][_][w]+u[g][_][w]}}}}static _volumeFloat(t,e){return e[t.alphaMaximum][t.redMaximum][t.greenMaximum][t.blueMaximum]-e[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMaximum]-e[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMaximum]+e[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMaximum]-e[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMaximum]+e[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMaximum]+e[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMaximum]-e[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(e[t.alphaMaximum][t.redMaximum][t.greenMaximum][t.blueMinimum]-e[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMinimum]-e[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMinimum]+e[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]-e[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMinimum]+e[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]+e[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]-e[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum])}static _volume(t,e){return 0|zt._volumeFloat(t,e)}static _top(t,e,i,s){let a;switch(e){case zt._alpha:a=s[i][t.redMaximum][t.greenMaximum][t.blueMaximum]-s[i][t.redMaximum][t.greenMinimum][t.blueMaximum]-s[i][t.redMinimum][t.greenMaximum][t.blueMaximum]+s[i][t.redMinimum][t.greenMinimum][t.blueMaximum]-(s[i][t.redMaximum][t.greenMaximum][t.blueMinimum]-s[i][t.redMaximum][t.greenMinimum][t.blueMinimum]-s[i][t.redMinimum][t.greenMaximum][t.blueMinimum]+s[i][t.redMinimum][t.greenMinimum][t.blueMinimum]);break;case zt._red:a=s[t.alphaMaximum][i][t.greenMaximum][t.blueMaximum]-s[t.alphaMaximum][i][t.greenMinimum][t.blueMaximum]-s[t.alphaMinimum][i][t.greenMaximum][t.blueMaximum]+s[t.alphaMinimum][i][t.greenMinimum][t.blueMaximum]-(s[t.alphaMaximum][i][t.greenMaximum][t.blueMinimum]-s[t.alphaMaximum][i][t.greenMinimum][t.blueMinimum]-s[t.alphaMinimum][i][t.greenMaximum][t.blueMinimum]+s[t.alphaMinimum][i][t.greenMinimum][t.blueMinimum]);break;case zt._green:a=s[t.alphaMaximum][t.redMaximum][i][t.blueMaximum]-s[t.alphaMaximum][t.redMinimum][i][t.blueMaximum]-s[t.alphaMinimum][t.redMaximum][i][t.blueMaximum]+s[t.alphaMinimum][t.redMinimum][i][t.blueMaximum]-(s[t.alphaMaximum][t.redMaximum][i][t.blueMinimum]-s[t.alphaMaximum][t.redMinimum][i][t.blueMinimum]-s[t.alphaMinimum][t.redMaximum][i][t.blueMinimum]+s[t.alphaMinimum][t.redMinimum][i][t.blueMinimum]);break;case zt._blue:a=s[t.alphaMaximum][t.redMaximum][t.greenMaximum][i]-s[t.alphaMaximum][t.redMaximum][t.greenMinimum][i]-s[t.alphaMaximum][t.redMinimum][t.greenMaximum][i]+s[t.alphaMaximum][t.redMinimum][t.greenMinimum][i]-(s[t.alphaMinimum][t.redMaximum][t.greenMaximum][i]-s[t.alphaMinimum][t.redMaximum][t.greenMinimum][i]-s[t.alphaMinimum][t.redMinimum][t.greenMaximum][i]+s[t.alphaMinimum][t.redMinimum][t.greenMinimum][i]);break;default:throw new Error("impossible")}return 0|a}static _bottom(t,e,i){switch(e){case zt._alpha:return-i[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMaximum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMaximum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMaximum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(-i[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMinimum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);case zt._red:return-i[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMaximum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMaximum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMaximum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(-i[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMinimum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);case zt._green:return-i[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMaximum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMaximum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMaximum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(-i[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);case zt._blue:return-i[t.alphaMaximum][t.redMaximum][t.greenMaximum][t.blueMinimum]+i[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]-(-i[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMinimum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);default:return 0}}_calculateVariance(t){const e=zt._volume(t,this._momentsRed),i=zt._volume(t,this._momentsGreen),s=zt._volume(t,this._momentsBlue),a=zt._volume(t,this._momentsAlpha);return zt._volumeFloat(t,this._moments)-(e*e+i*i+s*s+a*a)/zt._volume(t,this._weights)}_maximize(t,e,i,s,a,n,r,h,o){const m=0|zt._bottom(t,e,this._momentsRed),l=0|zt._bottom(t,e,this._momentsGreen),u=0|zt._bottom(t,e,this._momentsBlue),_=0|zt._bottom(t,e,this._momentsAlpha),c=0|zt._bottom(t,e,this._weights);let d=0,g=-1;for(let p=i;p<s;++p){let i=m+zt._top(t,e,p,this._momentsRed),s=l+zt._top(t,e,p,this._momentsGreen),M=u+zt._top(t,e,p,this._momentsBlue),b=_+zt._top(t,e,p,this._momentsAlpha),f=c+zt._top(t,e,p,this._weights);if(0!==f){let t=i*i+s*s+M*M+b*b,e=t/f;i=a-i,s=n-s,M=r-M,b=h-b,f=o-f,0!==f&&(t=i*i+s*s+M*M+b*b,e+=t/f,e>d&&(d=e,g=p))}}return{max:d,position:g}}_cut(t,e){let i;const s=zt._volume(t,this._momentsRed),a=zt._volume(t,this._momentsGreen),n=zt._volume(t,this._momentsBlue),r=zt._volume(t,this._momentsAlpha),h=zt._volume(t,this._weights),o=this._maximize(t,zt._red,t.redMinimum+1,t.redMaximum,s,a,n,r,h),m=this._maximize(t,zt._green,t.greenMinimum+1,t.greenMaximum,s,a,n,r,h),l=this._maximize(t,zt._blue,t.blueMinimum+1,t.blueMaximum,s,a,n,r,h),u=this._maximize(t,zt._alpha,t.alphaMinimum+1,t.alphaMaximum,s,a,n,r,h);if(u.max>=o.max&&u.max>=m.max&&u.max>=l.max){if(i=zt._alpha,u.position<0)return!1}else i=o.max>=u.max&&o.max>=m.max&&o.max>=l.max?zt._red:m.max>=u.max&&m.max>=o.max&&m.max>=l.max?zt._green:zt._blue;switch(e.redMaximum=t.redMaximum,e.greenMaximum=t.greenMaximum,e.blueMaximum=t.blueMaximum,e.alphaMaximum=t.alphaMaximum,i){case zt._red:e.redMinimum=t.redMaximum=o.position,e.greenMinimum=t.greenMinimum,e.blueMinimum=t.blueMinimum,e.alphaMinimum=t.alphaMinimum;break;case zt._green:e.greenMinimum=t.greenMaximum=m.position,e.redMinimum=t.redMinimum,e.blueMinimum=t.blueMinimum,e.alphaMinimum=t.alphaMinimum;break;case zt._blue:e.blueMinimum=t.blueMaximum=l.position,e.redMinimum=t.redMinimum,e.greenMinimum=t.greenMinimum,e.alphaMinimum=t.alphaMinimum;break;case zt._alpha:e.alphaMinimum=t.alphaMaximum=u.position,e.blueMinimum=t.blueMinimum,e.redMinimum=t.redMinimum,e.greenMinimum=t.greenMinimum}return t.volume=(t.redMaximum-t.redMinimum)*(t.greenMaximum-t.greenMinimum)*(t.blueMaximum-t.blueMinimum)*(t.alphaMaximum-t.alphaMinimum),e.volume=(e.redMaximum-e.redMinimum)*(e.greenMaximum-e.greenMinimum)*(e.blueMaximum-e.blueMinimum)*(e.alphaMaximum-e.alphaMinimum),!0}_initialize(t){this._colors=t,this._cubes=[];for(let e=0;e<t;e++)this._cubes[e]=new Bt;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=St(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=St(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=St(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=St(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=St(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=St(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let t=0;t<256;++t)this._table[t]=t*t;this._pixels=[]}_setQuality(t=5){this._significantBitsPerChannel=t,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},Ct=zt;m(Ct,"_alpha",3),m(Ct,"_red",2),m(Ct,"_green",1),m(Ct,"_blue",0);var Et={};o(Et,{AbstractImageQuantizer:()=>It,ErrorDiffusionArray:()=>Dt,ErrorDiffusionArrayKernel:()=>Rt,ErrorDiffusionRiemersma:()=>qt,NearestColor:()=>Pt});var It=class{quantizeSync(t,e){for(const i of this.quantize(t,e))if(i.pointContainer)return i.pointContainer;throw new Error("unreachable")}},Pt=class extends It{constructor(t){super(),m(this,"_distance"),this._distance=t}*quantize(t,e){const i=t.getPointArray(),s=t.getWidth(),a=t.getHeight(),n=new ut(a,99);for(let t=0;t<a;t++){n.shouldNotify(t)&&(yield{progress:n.progress});for(let a=0,n=t*s;a<s;a++,n++){const t=i[n];t.from(e.getNearestColor(this._distance,t))}}yield{pointContainer:t,progress:100}}},Rt=(t=>(t[t.FloydSteinberg=0]="FloydSteinberg",t[t.FalseFloydSteinberg=1]="FalseFloydSteinberg",t[t.Stucki=2]="Stucki",t[t.Atkinson=3]="Atkinson",t[t.Jarvis=4]="Jarvis",t[t.Burkes=5]="Burkes",t[t.Sierra=6]="Sierra",t[t.TwoSierra=7]="TwoSierra",t[t.SierraLite=8]="SierraLite",t))(Rt||{}),Dt=class extends It{constructor(t,e,i=!0,s=0,a=!1){super(),m(this,"_minColorDistance"),m(this,"_serpentine"),m(this,"_kernel"),m(this,"_calculateErrorLikeGIMP"),m(this,"_distance"),this._setKernel(e),this._distance=t,this._minColorDistance=s,this._serpentine=i,this._calculateErrorLikeGIMP=a}*quantize(t,e){const i=t.getPointArray(),s=new st,a=t.getWidth(),n=t.getHeight(),r=[];let h=1,o=1;for(const t of this._kernel){const e=t[2]+1;o<e&&(o=e)}for(let t=0;t<o;t++)this._fillErrorLine(r[t]=[],a);const m=new ut(n,99);for(let t=0;t<n;t++){m.shouldNotify(t)&&(yield{progress:m.progress}),this._serpentine&&(h*=-1);const o=t*a,l=1===h?0:a-1,u=1===h?a:-1;this._fillErrorLine(r[0],a),r.push(r.shift());const _=r[0];for(let m=l,c=o+l;m!==u;m+=h,c+=h){const o=i[c],l=_[m];s.from(o);const u=st.createByRGBA(w(o.r+l[0]),w(o.g+l[1]),w(o.b+l[2]),w(o.a+l[3])),d=e.getNearestColor(this._distance,u);if(o.from(d),this._minColorDistance&&this._distance.calculateNormalized(s,d)<this._minColorDistance)continue;let g,p,M,b;this._calculateErrorLikeGIMP?(g=u.r-d.r,p=u.g-d.g,M=u.b-d.b,b=u.a-d.a):(g=s.r-d.r,p=s.g-d.g,M=s.b-d.b,b=s.a-d.a);const f=1===h?0:this._kernel.length-1,x=1===h?this._kernel.length:-1;for(let e=f;e!==x;e+=h){const i=this._kernel[e][1]*h,s=this._kernel[e][2];if(i+m>=0&&i+m<a&&s+t>=0&&s+t<n){const t=this._kernel[e][0],a=r[s][i+m];a[0]+=g*t,a[1]+=p*t,a[2]+=M*t,a[3]+=b*t}}}}yield{pointContainer:t,progress:100}}_fillErrorLine(t,e){t.length>e&&(t.length=e);const i=t.length;for(let e=0;e<i;e++){const i=t[e];i[0]=i[1]=i[2]=i[3]=0}for(let s=i;s<e;s++)t[s]=[0,0,0,0]}_setKernel(t){switch(t){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${t}`)}}};function*Gt(t,e,i){const s=Math.max(t,e),a={width:t,height:e,level:Math.floor(Math.log(s)/Math.log(2)+1),callback:i,tracker:new ut(t*e,99),index:0,x:0,y:0};yield*Nt(a,1),Tt(a,0)}function*Nt(t,e){if(!(t.level<1)){switch(t.tracker.shouldNotify(t.index)&&(yield{progress:t.tracker.progress}),t.level--,e){case 2:yield*Nt(t,1),Tt(t,3),yield*Nt(t,2),Tt(t,4),yield*Nt(t,2),Tt(t,2),yield*Nt(t,4);break;case 3:yield*Nt(t,4),Tt(t,2),yield*Nt(t,3),Tt(t,1),yield*Nt(t,3),Tt(t,3),yield*Nt(t,1);break;case 1:yield*Nt(t,2),Tt(t,4),yield*Nt(t,1),Tt(t,3),yield*Nt(t,1),Tt(t,1),yield*Nt(t,3);break;case 4:yield*Nt(t,3),Tt(t,1),yield*Nt(t,4),Tt(t,2),yield*Nt(t,4),Tt(t,4),yield*Nt(t,2)}t.level++}}function Tt(t,e){switch(t.x>=0&&t.x<t.width&&t.y>=0&&t.y<t.height&&(t.callback(t.x,t.y),t.index++),e){case 2:t.x--;break;case 3:t.x++;break;case 1:t.y--;break;case 4:t.y++}}var qt=class extends It{constructor(t,e=16,i=1){super(),m(this,"_distance"),m(this,"_weights"),m(this,"_errorQueueSize"),this._distance=t,this._errorQueueSize=e,this._weights=qt._createWeights(i,e)}*quantize(t,e){const i=t.getPointArray(),s=t.getWidth(),a=t.getHeight(),n=[];let r=0;for(let t=0;t<this._errorQueueSize;t++)n[t]={r:0,g:0,b:0,a:0};yield*Gt(s,a,((t,a)=>{const h=i[t+a*s];let{r:o,g:m,b:l,a:u}=h;for(let t=0;t<this._errorQueueSize;t++){const e=this._weights[t],i=n[(t+r)%this._errorQueueSize];o+=i.r*e,m+=i.g*e,l+=i.b*e,u+=i.a*e}const _=st.createByRGBA(w(o),w(m),w(l),w(u)),c=e.getNearestColor(this._distance,_);r=(r+1)%this._errorQueueSize;const d=(r+this._errorQueueSize-1)%this._errorQueueSize;n[d].r=h.r-c.r,n[d].g=h.g-c.g,n[d].b=h.b-c.b,n[d].a=h.a-c.a,h.from(c)})),yield{pointContainer:t,progress:100}}static _createWeights(t,e){const i=[],s=Math.exp(Math.log(e)/(e-1));for(let a=0,n=1;a<e;a++)i[a]=(n+.5|0)/e*t,n*=s;return i}};o({},{ssim:()=>Ut});var Ht=.01,Lt=.03;function Ut(t,e){if(t.getHeight()!==e.getHeight()||t.getWidth()!==e.getWidth())throw new Error("Images have different sizes!");const i=(255*Ht)**2,s=(255*Lt)**2;let a=0,n=0;return function(t,e,i){const s=t.getWidth(),a=t.getHeight();for(let n=0;n<a;n+=8)for(let r=0;r<s;r+=8){const h=Math.min(8,s-r),o=Math.min(8,a-n),m=Wt(t,r,n,h,o),l=Wt(e,r,n,h,o);i(m,l,Ft(m),Ft(l))}}(t,e,((t,e,r,h)=>{let o=0,m=0,l=0;for(let i=0;i<t.length;i++)m+=(t[i]-r)**2,l+=(e[i]-h)**2,o+=(t[i]-r)*(e[i]-h);const u=t.length-1;m/=u,l/=u,o/=u,n+=(2*r*h+i)*(2*o+s)/((r**2+h**2+i)*(m+l+s)),a++})),n/a}function Wt(t,e,i,s,a){const n=t.getPointArray(),r=[];let h=0;for(let o=i;o<i+a;o++){const i=o*t.getWidth();for(let t=e;t<e+s;t++){const e=n[i+t];r[h]=.2126*e.r+.7152*e.g+.0722*e.b,h++}}return r}function Ft(t){let e=0;for(const i of t)e+=i;return e/t.length}"function"==typeof setImmediate?setImmediate:"undefined"!=typeof process&&(null==process||process.nextTick);const Qt=["Euclidean","Manhattan","CIEDE2000","CIE94Textiles","CIE94GraphicArts","EuclideanBT709NoAlpha","EuclideanBT709","ManhattanBT709","CMetric","PNGQuant","ManhattanNommyde"],Ot=["Nearest","Riemersma","FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"];function Kt(t,e,i,s){const{width:a,height:n}=t,r=document.createElement("canvas"),h=r.getContext("2d");r.width=5*a,r.height=5*n,h.imageSmoothingEnabled=!1,h.mozImageSmoothingEnabled=!1,h.webkitImageSmoothingEnabled=!1,h.msImageSmoothingEnabled=!1,h.save(),h.scale(5,5),h.drawImage(t,0,0),h.restore(),h.fillStyle=e?"#DDDDDD":"#222222";for(let t=0;t<=a;t+=1){const e=(t+1*i)%10==0?2:1;h.fillRect(5*t,0,e,r.height)}for(let t=0;t<=n;t+=1){const e=(t+1*s)%10==0?2:1;h.fillRect(0,5*t,r.width,e)}return r}function jt(t,e,i,s){const a=document.createElement("canvas");a.width=e,a.height=i;const n=a.getContext("2d"),r=e/t.width,h=i/t.height;if(s)n.save(),n.scale(r,h),n.drawImage(t,0,0),n.restore();else{const s=t.getContext("2d").getImageData(0,0,t.width,t.height),a=n.createImageData(e,i),{data:o}=s,{data:m}=a;for(let s=0;s<i;s+=1)for(let i=0;i<e;i+=1){let a=4*(Math.round(i/r)+Math.round(s/h)*t.width),n=4*(i+s*e);m[n++]=o[a++],m[n++]=o[a++],m[n++]=o[a++],m[n]=o[a]}n.putImageData(a,0,0)}return a}function Xt(t,e,i){return function(t,e,i){const s=i.strategy||"Nearest",a=i.colorDist||"Euclidean";return new Promise(((n,r)=>{const h=new ht.Palette;h.add(ht.Point.createByRGBA(0,0,0,0));for(let e=0;e<t.length;e+=1){const[i,s,a]=t[e],n=ht.Point.createByRGBA(i,s,a,255);h.add(n)}let o,m;switch(a){case"Euclidean":default:o=new H.Euclidean;break;case"Manhattan":o=new H.Manhattan;break;case"CIEDE2000":o=new H.CIEDE2000;break;case"CIE94Textiles":o=new H.CIE94Textiles;break;case"CIE94GraphicArts":o=new H.CIE94GraphicArts;break;case"EuclideanBT709NoAlpha":o=new H.EuclideanBT709NoAlpha;break;case"EuclideanBT709":o=new H.EuclideanBT709;break;case"ManhattanBT709":o=new H.ManhattanBT709;break;case"CMetric":o=new H.CMetric;break;case"PNGQuant":o=new H.PNGQuant;break;case"ManhattanNommyde":o=new H.ManhattanNommyde}if(o._setDefaults&&o._setDefaults(),"Nearest"===s)m=new Et.NearestColor(o);else if("Riemersma"===s)m=new Et.ErrorDiffusionRiemersma(o);else{let t=0;if(i.hasOwnProperty("minColorDistance")){const e=Number(i.minColorDistance);Number.isNaN(e)||(t=e/100*.2)}m=new Et.ErrorDiffusionArray(o,Et.ErrorDiffusionArrayKernel[s],!i.hasOwnProperty("serpentine")||i.serpentine,t,!!i.GIMPerror)}const l=m.quantize(e,h),u=()=>{try{const t=l.next();t.done?n(function(t){const e=t.getWidth(),i=t.getHeight(),s=t.toUint8Array(),a=document.createElement("canvas");a.width=e,a.height=i;const n=a.getContext("2d"),r=n.createImageData(e,i);return r.data.set(s),n.putImageData(r,0,0),a}(e)):(t.value.pointContainer&&(e=t.value.pointContainer),i.onProgress&&i.onProgress(Math.floor(25+3*t.value.progress/4)),setTimeout(u,0))}catch(t){r(t)}};setTimeout(u,0)}))}(t,ht.PointContainer.fromHTMLCanvasElement(e),i)}var $t=i(875);var Yt,Vt,Jt,Zt=i(917);function te(t,e,i,s){Jt||(Jt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var a=t&&t.defaultProps,n=arguments.length-3;if(e||0===n||(e={children:void 0}),1===n)e.children=s;else if(n>1){for(var r=new Array(n),h=0;h<n;h++)r[h]=arguments[h+3];e.children=r}if(e&&a)for(var o in a)void 0===e[o]&&(e[o]=a[o]);else e||(e=a||{});return{$$typeof:Jt,type:t,key:void 0===i?null:""+i,ref:null,props:e,_owner:null}}function ee(){document.getElementById("imgoutput").toBlob((t=>r()(t,"ppfunconvert.png")))}let ie=null,se=!1;const ae=function(){const[t,e,i]=(0,a.v9)((t=>[t.canvas.canvasId,t.canvas.canvases,t.gui.easterEgg]),a.wU),[n,h]=(0,s.useState)(t),[o,m]=(0,s.useState)(null),[l,u]=(0,s.useState)("Nearest"),[_,c]=(0,s.useState)("Euclidean"),[d,g]=(0,s.useState)(!0),[p,M]=(0,s.useState)({serpentine:!0,minColorDistance:0,GIMPerror:!1}),[b,f]=(0,s.useState)({enabled:!1,width:10,height:10,aa:!0}),[x,w]=(0,s.useState)({enabled:!1,light:!1,offsetX:0,offsetY:0}),[y,S]=(0,s.useState)(!1),[k,v]=(0,s.useState)(!1),[A,B]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(o){const t=e[n];!async function(t){if(t.imgCanvas&&(ie=t,!se)){for(se=!0;ie;){const{colors:t,imgCanvas:e,ditherOpts:i,grid:s,scaling:a}=ie;if(ie=null,e){let n=e;if(a.enabled){const{width:t,height:i,aa:s}=a;n=jt(e,t,i,s)}const r=document.getElementById("qprog");if(r.innerText="Loading...",n=await Xt(t,n,{...i,onProgress:t=>{r.innerText=`Loading... ${Math.round(t)} %`}}),r.innerText="Done",s.enabled){const{light:t,offsetX:e,offsetY:i}=s;n=Kt(n,t,e,i)}const h=document.getElementById("imgoutput");h.width=n.width,h.height=n.height,h.getContext("2d").drawImage(n,0,0)}}se=!1}}({colors:t.cli?t.colors.slice(t.cli):t.colors,imgCanvas:o,ditherOpts:{strategy:l,colorDist:_,...p},grid:x,scaling:b})}}),[n,o,l,_,p,b,x,e]);const{serpentine:z,minColorDistance:C,GIMPerror:E}=p,{enabled:I,light:P,offsetX:R,offsetY:D}=x,{enabled:G,width:N,height:T,aa:q}=b,H="Nearest"!==l&&"Riemersma"!==l;(0,s.useEffect)((()=>{H&&setTimeout((()=>S(!0)),10)}),[H]),(0,s.useEffect)((()=>{I&&setTimeout((()=>v(!0)),10)}),[I]),(0,s.useEffect)((()=>{G&&setTimeout((()=>B(!0)),10)}),[G]);const L=Yt||(Yt=te("a",{href:"https://www.gimp.org"},void 0,"GIMP"));return te("div",{className:"content"},void 0,te("div",{},void 0,"Choose Canvas",": ",te("select",{value:n,onChange:t=>{const e=t.target;h(e.options[e.selectedIndex].value)}},void 0,Object.keys(e).map((t=>e[t].v||e[t].hid&&!i?null:te("option",{value:t},t,e[t].title))))),te("h3",{},void 0,"Palette Download"),te("div",{},void 0,["Palette for ",L],": ",te("button",{type:"button",style:{display:"inline"},onClick:()=>{const t=e[n],{title:i,desc:s,colors:a,cli:h=0}=t;r()(function(t,e,i){let s=`GIMP Palette\n#Palette Name: Pixelplanet${t}\n#Description: ${e}\n#Colors: ${i.length}`;return i.forEach((t=>{s+="\n",t.forEach((t=>{s+=function(t){let e=`${t} `;return t<10?e+="  ":t<100&&(e+=" "),e}(t)})),s+=function(t){let e=" #";return t.forEach((t=>{t<16&&(e+="0"),e+=t.toString(16)})),e}(t)})),s}(i,s,a.slice(h)),`Pixelplanet${i}.gpl`)}},void 0,"Download")),te("h3",{},void 0,"Image Converter"),te("p",{},void 0,"Convert an image to canvas colors"),te("input",{type:"file",id:"imgfile",onChange:async t=>{const e=t.target,i=e.files&&e.files[0]?e.files[0]:null,s=await(0,$t.NE)(i);m(null),f({enabled:!1,width:s.width,height:s.height,aa:!0}),m(s)}}),te("p",{},void 0,"Choose Strategy",": ",te("select",{value:l,onChange:t=>{const e=t.target;u(e.options[e.selectedIndex].value)}},void 0,Ot.map((t=>te("option",{value:t},t,t))))),(H||y)&&te("div",{className:H&&y?"convBox show":"convBox",onTransitionEnd:()=>{H||S(!1)}},void 0,te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:z,onChange:t=>{M({...p,serpentine:t.target.checked})}}),"Serpentine"),te("span",{},void 0,"Minimum Color Distance",": ",te("input",{type:"number",step:"1",min:"0",max:"100",style:{width:"4em"},value:C,onChange:t=>{M({...p,minColorDistance:t.target.value})}})," "),te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:E,onChange:t=>{M({...p,GIMPerror:t.target.checked})}}),"Calculate like GIMP")),te("p",{},void 0,"Choose Color Mode",": ",te("select",{value:_,onChange:t=>{const e=t.target;c(e.options[e.selectedIndex].value)}},void 0,Qt.map((t=>te("option",{value:t},t,t))))),te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:I,onChange:t=>{w({...x,enabled:t.target.checked})}}),"Add Grid (uncheck if you need a 1:1 template)"),(I||k)&&te("div",{className:I&&k?"convBox show":"convBox",onTransitionEnd:()=>{I||v(!1)}},void 0,te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:P,onChange:t=>{w({...x,light:t.target.checked})}}),"Світлая Сїтка"),te("span",{},void 0,"Offset"," X: ",te("input",{type:"number",step:"1",min:"0",max:"10",style:{width:"2em"},value:R,onChange:t=>{w({...x,offsetX:t.target.value})}})," "),te("span",{},void 0,"Offset"," Y: ",te("input",{type:"number",step:"1",min:"0",max:"10",style:{width:"2em"},value:D,onChange:t=>{w({...x,offsetY:t.target.value})}}))),te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:G,onChange:t=>{f({...b,enabled:t.target.checked})}}),"Scale Image"),(G||A)&&te("div",{className:G&&A?"convBox show":"convBox",onTransitionEnd:()=>{G||B(!1)}},void 0,te("span",{},void 0,"Width",": ",te("input",{type:"number",step:"1",min:"1",max:"1024",style:{width:"3em"},value:N,onChange:t=>{const e=t.target.value>1024?1024:t.target.value;if(e)if(d&&o){const t=o.width/o.height,i=Math.round(e/t);if(i<=0)return;f({...b,width:e,height:i})}else f({...b,width:e})}})," "),te("span",{},void 0,"Height",": ",te("input",{type:"number",step:"1",min:"1",max:"1024",style:{width:"3em"},value:T,onChange:t=>{const e=t.target.value>1024?1024:t.target.value;if(e)if(d&&o){const t=o.width/o.height,i=Math.round(t*e);if(i<=0)return;f({...b,width:i,height:e})}else f({...b,height:e})}})),te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:d,onChange:t=>{g(t.target.checked)}}),"Keep Ratio"),te("p",{style:{fontHeight:16}},void 0,te("input",{type:"checkbox",checked:q,onChange:t=>{f({...b,aa:t.target.checked})}}),"Anti Aliasing"),te("button",{type:"button",onClick:()=>{o&&f({...b,width:o.width,height:o.height})}},void 0,"Reset")),o?te("div",{},void 0,Vt||(Vt=te("p",{id:"qprog"},void 0,"...")),te("p",{},void 0,te("canvas",{id:"imgoutput",style:{width:"80%",imageRendering:"crisp-edges"}})),te("button",{type:"button",onClick:ee},void 0,"Download Template"),"undefined"==typeof ClipboardItem?null:te("button",{type:"button",onClick:()=>{const t=document.getElementById("imgoutput");(0,Zt.w)(t)}},void 0,"Копіровати в Буфер Міньби")):null)}}}]);
(()=>{"use strict";var e,t,n,i={633:(e,t,n)=>{var i=n(7774),r=n(917),o=n(403);function s(e,t,n,i,r,o,s){return{type:"s/LIST_TEMPLATE",imageId:e,title:t,canvasId:n,x:i,y:r,width:o,height:s}}function a(e){return{type:"s/REM_TEMPLATE",title:e}}function l(e,t){return{type:"s/CHG_TEMPLATE",title:e,props:t}}var c=n(940),d=n(669);const u=["g","h","x","m","t","r","l","+","-"];var h=n(906),f=n(4890),p=n(3894),m=n(6734);const v={showGrid:!1,showPixelNotify:!1,showMvmCtrls:!1,autoZoomIn:!1,isPotato:!1,isLightGrid:!1,compactPalette:!1,paletteOpen:!0,mute:!1,chatNotify:!0,menuOpen:!1,onlineCanvas:!1,style:"default",holdPaint:c.EQ.OFF,easterEgg:!1,moveU:0,moveV:0,moveW:0},g={lastFetch:0,totalPixels:0,dailyTotalPixels:0,ranking:1488,dailyRanking:1488,online:{total:0},totalRanking:[],totalDailyRanking:[],dailyCRanking:[],prevTop:[],onlineStats:[],cHistStats:[],histStats:{users:[],stats:[]},pDailyStats:[],pHourlyStats:[]},w=15e3,y={mute:[],readTs:{},unread:{}},b={id:null,name:null,wait:null,coolDown:null,lastCoolDownEnd:null,messages:[],mailreg:!1,blockDm:!1,priv:!1,isOnMobile:!1,notification:null,userlvl:0},S=class{length;rgb;colors;abgr;fl;constructor(e){this.length=e.length,this.rgb=new Uint8Array(3*this.length),this.colors=new Array(this.length),this.abgr=new Uint32Array(this.length),this.fl=new Array(this.length);let t=0;for(let n=0;n<e.length;n++){const i=e[n][0],r=e[n][1],o=e[n][2];this.rgb[t++]=i,this.rgb[t++]=r,this.rgb[t++]=o,this.colors[n]=`rgb(${i}, ${r}, ${o})`,this.abgr[n]=4278190080|o<<16|r<<8|i,this.fl[n]=[i/256,r/256,o/256]}}isDark(e){return e*=3,.2126*this.rgb[e++]+.7152*this.rgb[e++]+.0722*this.rgb[e]<128}getIndexOfColor(e,t,n){const{rgb:i}=this;let r=i.length/3;for(;r>0;){r-=1;const o=3*r;if(i[o]===e&&i[o+1]===t&&i[o+2]===n)return r}return null}getClosestIndexOfColor(e,t,n){const{rgb:i}=this;let r=i.length/3,o=0,s=null;for(;r>0;){r-=1;const a=3*r;let l=(i[a]-e)**2;l+=(i[a+1]-t)**2,l+=(i[a+2]-n)**2,(null===s||s>l)&&(o=r,s=l)}return o}};var k=n(259);function E(e){const{canvasEndDate:t,isHistoricalView:n,is3D:i}=e;if(i&&n?e.isHistoricalView=!1:t&&!n&&(e.isHistoricalView=!0,e.historicalDate||(e.historicalDate=(0,k.UW)(t),e.historicalTime="0000")),e.isHistoricalView){const{historicalDate:t,canvasId:n,canvasSize:i,canvases:r}=e;e.historicalCanvasSize=(0,k.Ss)(t,i,r[n]?.historicalSizes)}return e}function C(e,t){const n=e.cli||0,{size:i,sd:r=null,ed:o=null,ident:s,colors:a}=e,l=!!e.v;let d=[0,0,c.A$],u=n;return t&&(d=t.view,u=t.selectedColor),{clrIgnore:n,canvasSize:i,canvasStartDate:r,canvasEndDate:o,canvasIdent:s,is3D:l,view:d,selectedColor:u,palette:new S(a,0)}}function T(e){const{hash:t}=window.location,n=decodeURIComponent(t).substring(1).split(",");let i=n[0],r=(0,k.s3)(e,i);if(!r&&window.ssv.dc&&(r=window.ssv.dc),!r||!window.ssv?.backupurl&&e[r].ed){r=c.V4;const t=e[c.V4];if(!t)return null;i=t.ident}const o=!!e[r].v,s=parseInt(n[1],10)||0,a=parseInt(n[2],10)||0;let l=parseInt(n[3],10);return Number.isNaN(l)?l=o?0:c.A$:o||(l=2**(l/10)),{canvasId:r,canvasIdent:i,view:[s,a,l]}}const I={canvasId:null,canvasIdent:"xx",canvases:{},canvasSize:65536,historicalCanvasSize:65536,is3D:null,canvasStartDate:null,canvasEndDate:null,canvasMaxTiledZoom:(0,k.W4)(65536),palette:new S([[0,0,0]]),clrIgnore:0,selectedColor:0,view:[0,0,c.A$],isHistoricalView:!1,historicalDate:null,historicalTime:null,hover:null,prevCanvasState:{}},x={ovEnabled:!1,mEnabled:!1,oOpacity:40,oSmallPxls:!0,oRightShift:!1,list:[]},N={channels:{},blocked:[],messages:{}};let _=0;const A={fetchingChunks:0,fetchingChat:!1,fetchingPixel:!1,fetchingApi:!1},L=(e,t)=>e&&e._persist&&e._persist.version===t?(console.log(`Store version: ${t}`),Promise.resolve(e)):(console.log("Newer version run, resetting store."),Promise.resolve({})),P={gui:(0,i.OJ)({key:"gui",storage:m.Z,version:17,migrate:L},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/TGL_GRID":return{...e,showGrid:!e.showGrid};case"s/TGL_PXL_NOTIFY":return{...e,showPixelNotify:!e.showPixelNotify};case"s/TGL_MVM_CTRLS":return{...e,showMvmCtrls:!e.showMvmCtrls};case"s/TGL_AUTO_ZOOM_IN":return{...e,autoZoomIn:!e.autoZoomIn};case"s/TGL_ONLINE_CANVAS":return{...e,onlineCanvas:!e.onlineCanvas};case"s/TGL_POTATO_MODE":return{...e,isPotato:!e.isPotato};case"s/TGL_LIGHT_GRID":return{...e,isLightGrid:!e.isLightGrid};case"s/TGL_COMPACT_PALETTE":return{...e,compactPalette:!e.compactPalette};case"s/TGL_OPEN_PALETTE":return{...e,paletteOpen:!e.paletteOpen};case"s/TGL_OPEN_MENU":return{...e,menuOpen:!e.menuOpen};case"s/TGL_MUTE":return{...e,mute:!e.mute};case"s/TGL_CHAT_NOTIFY":return{...e,chatNotify:!e.chatNotify};case"s/TGL_EASTER_EGG":return{...e,easterEgg:!e.easterEgg};case"s/SELECT_HOLD_PAINT":return{...e,holdPaint:t.value};case"s/SELECT_STYLE":{const{style:n}=t;return{...e,style:n}}case"SELECT_COLOR":{const{compactPalette:t}=e;let{paletteOpen:n}=e;return(t||window.innerWidth<300)&&(n=!1),{...e,paletteOpen:n}}case"s/SET_MOVE_U":{const{value:n}=t,i=n;return{...e,moveU:i}}case"s/SET_MOVE_V":{const{value:n}=t,i=n;return{...e,moveV:i}}case"s/SET_MOVE_W":{const{value:n}=t,i=n;return{...e,moveW:i}}case"s/CANCEL_MOVE":return{...e,moveU:0,moveV:0,moveW:0};case"persist/REHYDRATE":return{...e,easterEgg:!1,holdPaint:c.EQ.OFF,moveU:0,moveV:0,moveW:0};default:return e}})),ranks:(0,i.OJ)({key:"ranks",storage:m.Z,version:17,migrate:L},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REC_SET_PXLS":{const{rankedPxlCnt:n}=t;if(!n)return e;let{totalPixels:i,dailyTotalPixels:r}=e;return i+=n,r+=n,{...e,totalPixels:i,dailyTotalPixels:r}}case"REC_ONLINE":{const{online:n}=t;return{...e,online:n}}case"s/REC_ME":case"s/LOGIN":{if(!t.totalPixels)return e;const{totalPixels:n,dailyTotalPixels:i,ranking:r,dailyRanking:o}=t;return{...e,totalPixels:n,dailyTotalPixels:i,ranking:r,dailyRanking:o}}case"REC_STATS":{const{totalRanking:n,totalDailyRanking:i,dailyCRanking:r,prevTop:o,onlineStats:s,cHistStats:a,histStats:l,pDailyStats:c,pHourlyStats:d}=t,u={totalRanking:n,totalDailyRanking:i,dailyCRanking:r,prevTop:o,onlineStats:s,cHistStats:a,histStats:l,pDailyStats:c,pHourlyStats:d},h=Date.now();return{...e,lastFetch:h,...u}}default:return e}})),chatRead:(0,i.OJ)({key:"cr",storage:m.Z,version:17,migrate:L},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/REC_ME":case"s/LOGIN":{const{channels:n}=t,i=Object.keys(n),r={},o={};for(let t=0;t<i.length;t+=1){const s=i[t];e.readTs[s]?r[s]=e.readTs[s]:r[s]=0,o[s]=n[s][2]>r[s]}return{...e,readTs:r,unread:o}}case"s/ADD_CHAT_CHANNEL":{const[n]=Object.keys(t.channel);return{...e,readTs:{...e.readTs,[n]:e.readTs[n]||0},unread:{...e.unread,[n]:!0}}}case"s/REMOVE_CHAT_CHANNEL":{const{cid:n}=t;if(!e.readTs[n])return e;const i={...e.readTs};delete i[n];const r={...e.unread};return delete r[n],{...e,readTs:i,unread:r}}case"s/REC_CHAT_MESSAGE":{const{channel:n,isRead:i}=t,r=i?{...e.readTs,[n]:Date.now()+w}:e.readTs,o=i?e.unread:{...e.unread,[n]:!0};return{...e,readTs:r,unread:o}}case"OPEN_WIN":{const{windowType:n}=t;if("CHAT"!==n)return e;const i=t.args&&t.args.chatChannel||1;return{...e,readTs:{...e.readTs,[i]:Date.now()+w},unread:{...e.unread,[i]:!1}}}case"MARK_CHANNEL_AS_READ":{const{cid:n}=t;return{...e,readTs:{...e.readTs,[n]:Date.now()+w},unread:{...e.unread,[n]:!1}}}case"s/MUTE_CHAT_CHANNEL":{const{cid:n}=t;return{...e,mute:[...e.mute,n]}}case"s/UNMUTE_CHAT_CHANNEL":{const{cid:n}=t,i=e.mute.filter((e=>e!==n));return{...e,mute:i}}default:return e}})),templates:(0,i.OJ)({key:"tem",storage:m.Z,version:17,migrate:L},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/LIST_TEMPLATE":{const{imageId:n,title:i,canvasId:r,x:o,y:s,width:a,height:l}=t;return{...e,list:[...e.list,{enabled:!0,title:i,canvasId:r,x:o,y:s,imageId:n,width:a,height:l}]}}case"s/CHG_TEMPLATE":{const{title:n,props:i}=t,{list:r}=e,o=r.findIndex((e=>e.title===n));return-1===o?e:{...e,list:[...r.slice(0,o),{...r[o],...i},...r.slice(o+1)]}}case"s/REM_TEMPLATE":return{...e,list:e.list.filter((e=>e.title!==t.title))};case"s/UPD_TEMPLATE_IMG":{const{imageId:n,width:i,height:r}=t,{list:o}=e,s=o.findIndex((e=>e.imageId===n));return-1===s?e:{...e,list:[...o.slice(0,s),{...o[s],imageId:n,width:i,height:r},...o.slice(s+1)]}}case"s/TGL_OVENABLED":return{...e,ovEnabled:!e.ovEnabled};case"s/TGL_SMALLPXLS":return{...e,oSmallPxls:!e.oSmallPxls};case"s/TGL_RIGHTSHIFT":return{...e,oRightShift:!e.oRightShift};case"s/SET_O_OPACITY":return{...e,oOpacity:t.opacity};case"TEMPLATES_READY":return{...e,available:!0};case"persist/REHYDRATE":return{...e,available:!1};default:return e}})),user:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"COOLDOWN_SET":{const{coolDown:n}=t;return{...e,coolDown:n||null}}case"COOLDOWN_END":return{...e,coolDown:null,lastCoolDownEnd:Date.now(),wait:null};case"REC_SET_PXLS":{const{wait:n}=t;return{...e,wait:n?Date.now()+n:e.wait}}case"REC_COOLDOWN":{const{wait:n}=t,i=n?Date.now()+n:null;return{...e,wait:i,coolDown:null}}case"SET_MOBILE":{const{mobile:n}=t;return{...e,isOnMobile:n}}case"s/REC_ME":case"s/LOGIN":{const{id:n,name:i,mailreg:r,blockDm:o,priv:s,userlvl:a}=t,l=t.messages?t.messages:[];return{...e,id:n,name:i,messages:l,mailreg:r,blockDm:o,priv:s,userlvl:a}}case"s/LOGOUT":return{...e,id:null,name:null,messages:[],mailreg:!1,blockDm:!1,priv:!1,userlvl:0};case"s/SET_NAME":{const{name:n}=t;return{...e,name:n}}case"s/SET_BLOCKING_DM":{const{blockDm:n}=t;return{...e,blockDm:n}}case"s/SET_PRIVATE":{const{priv:n}=t;return{...e,priv:n}}case"SET_NOTIFICATION":return{...e,notification:t.notification};case"UNSET_NOTIFICATION":return{...e,notification:null};case"s/REM_FROM_MESSAGES":{const{message:n}=t,i=[...e.messages],r=i.indexOf(n);return r>-1&&i.splice(r),{...e,messages:i}}case"s/SET_MAILREG":{const{mailreg:n}=t;return{...e,mailreg:n}}default:return e}},canvas:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_HISTORICAL_TIME":{const{date:n,time:i}=t;return E({...e,historicalDate:n,historicalTime:i})}case"s/TGL_HISTORICAL_VIEW":return e.is3D||e.canvasEndDate?e:E({...e,isHistoricalView:!e.isHistoricalView});case"UPDATE_VIEW":{const{view:n}=t;return{...e,view:[...n]}}case"RELOAD_URL":{const{canvases:t}=e,n=T(t);if(!n)return e;if(n.canvasId!==e.canvasId){const{canvasId:i}=n,r=C(t[i],e.prevCanvasState[i]);return{...e,...r,...n}}return{...e,...n}}case"SELECT_COLOR":return{...e,selectedColor:t.color};case"SET_HOVER":{const{hover:n}=t;return{...e,hover:n}}case"UNSET_HOVER":return{...e,hover:null};case"s/SELECT_CANVAS":{let{canvasId:n}=t;const{canvases:i,prevCanvasState:r,canvasId:o}=e;let s=i[n];s||(n=c.V4,s=i[c.V4]);const a=C(s,r[n]);return E({...e,...a,canvasId:n,isHistoricalView:!e.canvasEndDate&&e.isHistoricalView,prevCanvasState:{...e.prevCanvasState,[o]:{view:e.view,selectedColor:e.selectedColor}}})}case"s/REC_ME":{const{canvases:n}=t;let{canvasId:i,view:r}=e;null===i&&({canvasId:i,view:r}=T(n));const o=C(n[i],e.prevCanvasState[i]);return E({...e,...o,canvasId:i,canvases:n,view:r})}default:return e}},chat:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/REC_ME":case"s/LOGIN":{const n={},i=t.channels,r=Object.keys(i);for(let e=0;e<r.length;e+=1){const t=r[e];n[Number(t)]=i[t]}return{...e,channels:n,blocked:t.blocked}}case"s/LOGOUT":{const t={...e.channels},n={...e.messages},i=Object.keys(t);for(let e=0;e<i.length;e+=1){const r=i[e];0!==t[r][1]&&(delete n[r],delete t[r])}return{...e,channels:t,blocked:[],messages:n}}case"s/BLOCK_USER":{const{userId:n,userName:i}=t,r=[...e.blocked,[n,i]],o={...e.channels},s=Object.keys(o);for(let t=0;t<s.length;t+=1){const i=s[t];if(1===o[i][1]&&o[i][3]===n)return delete o[i],{...e,channels:o,blocked:r}}return{...e,blocked:r}}case"s/UNBLOCK_USER":{const{userId:n}=t,i=e.blocked.filter((e=>e[0]!==n));return{...e,blocked:i}}case"s/ADD_CHAT_CHANNEL":{const{channel:n}=t,i=Number(Object.keys(n)[0]);return e.channels[i]?e:{...e,channels:{...e.channels,...n}}}case"s/REMOVE_CHAT_CHANNEL":{const{cid:n}=t;if(!e.channels[n])return e;const i={...e.channels},r={...e.messages};return delete r[n],delete i[n],{...e,channels:i,messages:r}}case"s/REC_CHAT_MESSAGE":{const{name:n,text:i,country:r,channel:o,user:s}=t;if(!e.messages[o]||!e.channels[o])return e;const a=Math.round(Date.now()/1e3);_+=1;const l={...e.messages,[o]:[...e.messages[o],[n,i,r,s,a,_]]};l[o].length>c.Kb&&l[o].splice(0,2);const d=[...e.channels[o]];return d[2]=Date.now(),{...e,channels:{...e.channels,[o]:d},messages:l}}case"s/REC_CHAT_HISTORY":{const{cid:n,history:i}=t;for(let e=0;e<i.length;e+=1)_+=1,i[e].push(_);return{...e,messages:{...e.messages,[n]:i}}}default:return e}},fetching:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/SET_CHAT_FETCHING":{const{fetching:n}=t;return{...e,fetchingChat:n}}case"SET_API_FETCHING":{const{fetching:n}=t;return{...e,fetchingApi:n}}case"REQ_BIG_CHUNK":{const{fetchingChunks:t}=e;return{...e,fetchingChunks:t+1}}case"REC_BIG_CHUNK":case"REC_BIG_CHUNK_FAILURE":{const{fetchingChunks:t}=e;return{...e,fetchingChunks:t-1}}case"SET_PXLS_FETCHING":{const{fetching:n}=t;return{...e,fetchingPixel:n}}default:return e}}};function O(e){let t=Math.floor(99999*Math.random())+1;for(;e.args[t];)t+=1;return t}function R(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=window.innerWidth,r=window.innerHeight;n&&(i=Math.floor(.7*i),r=Math.floor(Math.min(.8*r,900)));const o=e||i,s=t||r;return[(0,k.uZ)(o,70,i),(0,k.uZ)(s,50,r)]}function D(e,t,n,i){const r=e||0===e?e:Math.floor((window.innerWidth-n)/2),o=t||0===t?t:Math.floor((window.innerHeight-i)/2);return[(0,k.uZ)(r,70-n,window.innerWidth-70),(0,k.uZ)(o,0,window.innerHeight-30)]}function $(e){const{innerWidth:t,innerHeight:n}=window,{windows:i,positions:r}=e,o=t-70,s=n-30;let a=!1;const l={};for(let e=0;e<i.length;e+=1){const c=i[e].windowId,{xPos:d,yPos:u,width:h,height:f}=r[c],p=70-h;d>o||u>s||d<p||u<0||t>h||n>f?(a=!0,l[c]={xPos:(0,k.uZ)(d,p,o),yPos:(0,k.uZ)(u,0,s),width:Math.min(h,t-30),height:Math.min(f,n-30),z:r[c].z}):l[c]=r[c]}return a?{...e,positions:l}:e}function M(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.zMax>=50||t){const t={...e.positions},n=Object.keys(t),i=n.map((e=>t[e].z)).sort(((e,t)=>!t||e&&e>=t));for(let e=0;e<n.length;e+=1){const r=n[e];t[r]={...t[r],z:i.indexOf(t[r].z)}}e.zMax=i.length-1,e.positions=t}return e}const W={showWindows:window.innerWidth>604,zMax:0,windows:[],positions:{},args:{}},z={open:!1,alertType:null,title:null,message:null,btn:null},V=window.AudioContext||window.webkitAudioContext,H=V&&new V;function U(e){const t=new ArrayBuffer(2),n=new DataView(t);return n.setInt8(0,160),n.setInt8(1,Number(e)),t}var F=n(395),G=n(631);const B=new class{store=null;pixelTransferController=null;ws=null;getRenderer;constructor(){console.log("Creating WebSocketClient"),this.channelId=0,this.readyState=WebSocket.CLOSED,this.msgQueue=[],this.reqQueue=[],this.checkHealth=this.checkHealth.bind(this),setInterval(this.checkHealth,2e3)}initialize(e,t,n){return this.store=e,t&&(this.pixelTransferController=t),n&&(this.getRenderer=n),this.connect()}connect(){this.readyState=WebSocket.CONNECTING,this.ws&&console.log("WebSocket already open, not starting"),this.timeLastConnecting=Date.now();const e=`${"https:"===window.location.protocol?"wss:":"ws:"}//${G.uY||window.location.host}/ws`;this.ws=new WebSocket(e),this.ws.binaryType="arraybuffer",this.ws.onopen=this.onOpen.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onclose=this.onClose.bind(this),this.ws.onerror=e=>{console.error("Socket encountered error, closing socket",e)}}checkHealth(){if(this.readyState===WebSocket.OPEN){const e=Date.now();e-3e4>this.timeLastPing&&(console.log("Server is silent, killing websocket"),this.readyState=WebSocket.CLOSING,this.ws.close()),e-23e3>this.timeLastSent&&(this.send(new Uint8Array([176]).buffer),this.timeLastSent=e)}}sendWhenReady(e){this.timeLastSent=Date.now(),this.readyState===WebSocket.OPEN?this.ws.send(e):(console.log("Tried sending message when websocket was closed!"),this.msgQueue.push(e))}send(e){this.readyState===WebSocket.OPEN&&this.ws.send(e)}processMsgQueue(){for(;this.msgQueue.length>0;)this.sendWhenReady(this.msgQueue.shift())}onOpen(){const e=Date.now();this.timeLastPing=e,this.timeLastSent=e,this.store.dispatch((0,F.$s)()),this.readyState=WebSocket.OPEN,this.send(U(this.store.getState().canvas.canvasId));const t=this.getRenderer?.().recChunkIds;t?.length&&(console.log(`Register ${t.length} chunks`),this.send(function(e){const t=new ArrayBuffer(2+2*e.length),n=new Uint16Array(t);n[0]=163;for(let t=0;t<e.length;t+=1)n[t+1]=e[t];return t}(t))),this.processMsgQueue()}setCanvas(e){null!==e&&(console.log(`Notify websocket server that we changed canvas to ${e}`),this.send(U(e)))}registerChunk(e){const t=function(e){const t=new ArrayBuffer(3),n=new DataView(t);return n.setInt8(0,161),n.setInt16(1,e),t}(e);this.readyState===WebSocket.OPEN&&this.send(t)}deRegisterChunks(e){const t=function(e){const t=new ArrayBuffer(2+2*e.length),n=new Uint16Array(t);n[0]=164;for(let t=0;t<e.length;t+=1)n[t+1]=e[t];return t}(e);this.readyState===WebSocket.OPEN&&this.send(t)}sendCaptchaSolution(e,t){return new Promise(((n,i)=>{let r;const o=["cs",e=>{n(e),clearTimeout(r)}];this.reqQueue.push(o),r=setTimeout((()=>{const e=this.reqQueue.indexOf(o);~e&&this.reqQueue.splice(e,1),i(new Error("Timeout"))}),2e4),this.sendWhenReady(`cs,${JSON.stringify([e,t])}`)}))}sendPixelUpdate(e,t,n){return new Promise(((i,r)=>{let o;const s=["pu",e=>{i(e),clearTimeout(o)}];this.reqQueue.push(s),o=setTimeout((()=>{const e=this.reqQueue.indexOf(s);~e&&this.reqQueue.splice(e,1),r(new Error("Timeout"))}),2e4),this.sendWhenReady(function(e,t,n){const i=new ArrayBuffer(3+4*n.length),r=new DataView(i);r.setUint8(0,193),r.setUint8(1,e),r.setUint8(2,t);let o=2,s=n.length;for(;s;){s-=1;const[e,t]=n[s];r.setUint8(o+=1,e>>>16),r.setUint16(o+=1,65535&e),r.setUint8(o+=2,t)}return i}(e,t,n))}))}sendChatMessage(e,t){this.sendWhenReady(`cm,${JSON.stringify([e,t])}`)}onMessage(e){let{data:t}=e;try{"string"==typeof t?this.onTextMessage(t):this.onBinaryMessage(t)}catch(e){console.log(`An error occurred while parsing websocket message ${t}`,e)}}onTextMessage(e){const t=e.indexOf(",");if(-1===t)return;const n=e.slice(0,t),i=JSON.parse(e.slice(t+1));switch(n){case"cm":this.store.dispatch((0,F.pl)(...i));break;case"ac":this.store.dispatch((0,F.dm)(i));break;case"rc":this.store.dispatch((0,F.jg)(i))}}onBinaryMessage(e){if(0===e.byteLength)return;const t=new DataView(e),n=t.getUint8(0);switch(this.timeLastPing=Date.now(),n){case 193:this.pixelTransferController&&this.pixelTransferController.receivePixelUpdate(function(e){const t=e.getUint8(1),n=e.getUint8(2),i=[];let r=e.byteLength;for(;r>3;){const t=e.getUint8(r-=1),n=e.getUint16(r-=2),o=e.getUint8(r-=1)<<16;i.push([o|n,t])}return{i:t,j:n,pixels:i}}(t));break;case 195:{const e=this.reqQueue.findIndex((e=>"pu"===e[0]));~e&&this.reqQueue.splice(e,1)[0][1](function(e){return{retCode:e.getUint8(1),wait:e.getUint32(2),coolDownSeconds:e.getInt16(6),pxlCnt:e.getUint8(8),rankedPxlCnt:e.getUint8(9)}}(t));break}case 167:this.store.dispatch((0,F.Wm)(function(e){const t={};t.total=e.getUint16(1);let n=e.byteLength;for(;n>3;){const i=e.getUint16(n-=2);t[e.getUint8(n-=1)]=i}return t}(t)));break;case 194:this.store.dispatch((0,F.At)(function(e){return e.getUint32(1)}(t)));break;case 166:console.log("Websocket requested api/me reload"),this.store.dispatch((0,d.aM)()),this.reconnect();break;case 198:{const e=this.reqQueue.findIndex((e=>"cs"===e[0]));~e&&this.reqQueue.splice(e,1)[0][1](function(e){return e.getUint8(1)}(t));break}default:console.error(`Unknown op_code ${n} received`)}}onClose(e){this.store.dispatch((0,F.WV)()),this.ws=null,this.readyState=WebSocket.CONNECTING;const t=this.timeLastConnecting<Date.now()-7e3?1e3:5e3;console.warn(`Socket is closed. Reconnect will be attempted in ${t} ms.`,e.reason),setTimeout((()=>this.connect()),t)}reconnect(){this.readyState===WebSocket.OPEN&&(this.readyState=WebSocket.CLOSING,console.log("Restarting WebSocket"),this.ws.onclose=null,this.ws.onmessage=null,this.ws.close(),this.ws=null,this.connect())}};var K=n(785);class Z{type;static db;constructor(e){this.type=e}async initialize(){return await Z.openDB(),this}static openDB(){return Z.db?Z.db:new Promise(((e,t)=>{const n=window.indexedDB.open("ppfun_files",1);n.onsuccess=t=>{const n=t.target.result;n.onerror=e=>{console.error("indexedDB error:",e.target.error)},Z.db=n,e(n)},n.onupgradeneeded=e=>{const t=e.target.result.createObjectStore("files",{autoIncrement:!0});t.createIndex("type","type",{unique:!1}),t.createIndex("mimetype","mimetype",{unique:!1})},n.onerror=()=>{console.error("Error on opening indexedDB:",n.error),t(n.error)}}))}async saveFile(e){const{db:t}=Z;if(!t)return null;const n=Array.isArray(e)?e:[e],i=await Promise.all(n.map((e=>e.arrayBuffer())));return new Promise(((r,o)=>{const s=[],a=t.transaction("files","readwrite");a.oncomplete=()=>{r(Array.isArray(e)?s:s[0])},a.onabort=e=>{e.stopPropagation(),o(e.target.error)};const l=a.objectStore("files");n.forEach(((e,t)=>{s.push(null),l.add({type:this.type,mimetype:e.type,buffer:i[t]}).onsuccess=e=>{s[t]=e.target.result}}))}))}async updateFile(e,t){const{db:n}=Z;if(!n)return null;const i=await t.arrayBuffer();return new Promise(((r,o)=>{const s=n.transaction("files","readwrite");s.onabort=e=>{e.stopPropagation(),o(e.target.error)},s.objectStore("files").put({type:this.type,mimetpe:t.type,buffer:i},e).onsuccess=e=>r(e.target.result)}))}loadFile(e){const{db:t}=Z;if(!t)return null;const n=Array.isArray(e)?e:[e];return new Promise(((i,r)=>{const o=[],s=t.transaction("files","readonly");s.oncomplete=()=>{i(Array.isArray(e)?o:o[0])},s.onabort=e=>{e.stopPropagation(),r(e.target.error)};const a=s.objectStore("files");n.forEach(((e,t)=>{o.push(null),a.get(e).onsuccess=e=>{o[t]=e.target.result}}))}))}deleteFile(e){const{db:t}=Z;if(!t)return null;const n=Array.isArray(e)?e:[e];return new Promise(((e,i)=>{const r=t.transaction("files","readwrite");r.oncomplete=()=>{e()},r.onabort=e=>{e.stopPropagation(),i(e.target.error)};const o=r.objectStore("files");n.forEach((e=>{o.delete(e)}))}))}getAllKeys(){const{db:e}=Z;return e?new Promise(((t,n)=>{const i=e.transaction("files","readonly");i.objectStore("files").index("type").getAllKeys(this.type).onsuccess=e=>{t(e.target.result)},i.onabort=e=>{e.stopPropagation(),n(e.target.error)}})):null}async sync(e){const t=await this.getAllKeys(),n=t.filter((t=>!e.includes(t)));n.length&&(console.log("Templaes: Keys in db but not in store",n),await this.deleteFile(n));const i=e.filter((e=>!t.includes(e)));return i.length&&console.log("Templates: Keys in store but not in db",i),i}}const j=Z;var Y=n(875);const q=class{image;id;width;height;ready=!1;#e;constructor(e){this.id=e}get imageSmall(){if(!this.#e){const e=this.image.getContext("2d").getImageData(0,0,this.width,this.height),t=document.createElement("canvas");t.width=3*this.width,t.height=3*this.height;const n=t.getContext("2d"),i=n.getImageData(0,0,t.width,t.height);let r=0,o=4*i.width+4;for(;r<e.data.length;){for(let t=0;t<e.width;t+=1)i.data[o]=e.data[r],i.data[++o]=e.data[++r],i.data[++o]=e.data[++r],i.data[++o]=e.data[++r],o+=9,r+=1;o+=4*i.width*2}n.putImageData(i,0,0),this.#e=t}return this.#e}async arrayBuffer(){return(0,Y.nE)(this.image)}setDimensionFromCanvas(){const{width:e,height:t}=this.image;return this.width=e,this.height=t,this.read=!0,[e,t]}fromImage(e){return this.image=(0,Y.zE)(e),this.setDimensionFromCanvas()}async fromFile(e){return this.image=await(0,Y.NE)(e),this.setDimensionFromCanvas()}async fromBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";return this.image=await(0,Y.NF)(e,t),this.setDimensionFromCanvas()}},Q=new class{#t;#n=new j("templates");#i=new Map;ready=!1;async initialize(e){try{this.#t=e,await this.#n.initialize(),this.ready=!0,this.#t.dispatch({type:"TEMPLATES_READY"}),await this.syncDB()}catch(e){console.warn(`Couldn't initialize Templates: ${e.message}`)}}async getTemplate(e){if(!this.ready)return null;let t=this.#i.get(e);return t?t.image:(t=await this.loadExistingTemplate(e),t?t.image:null)}getTemplateSync(e){if(!this.ready)return null;const t=this.#i.get(e);return t?t.image:(this.loadExistingTemplate(e),null)}getSmallTemplateSync(e){if(!this.ready)return null;const t=this.#i.get(e);return t?t.imageSmall:(this.loadExistingTemplate(e),null)}getColorOfPixel(e,t,n){const i=this.#t.getState().templates.list.filter((i=>i.enabled&&i.canvasId===e&&i.x<=t&&i.y<=n&&i.x+i.width>t&&i.y+i.height>n));for(const e of i){const i=this.getTemplateSync(e.imageId);if(!i)continue;const r=i.getContext("2d").getImageData(t-e.x,n-e.y,1,1).data;if(r[3]>200)return[r[0],r[1],r[2]]}return null}getTemplatesInView(e,t,n,i,r){const o=t-i,s=n-r,a=t+i,l=n+r;return this.#t.getState().templates.list.filter((t=>t.enabled&&t.canvasId===e&&t.x<=a&&t.y<=l&&t.x+t.width>o&&t.y+t.height>s))}async syncDB(){try{const{list:e}=this.#t.getState().templates,t=e.map((e=>e.imageId)),n=await this.#n.sync(t);e.filter((e=>n.includes(e.imageId))).forEach((e=>{this.#t.dispatch(a(e.title))}))}catch(e){console.error(`Error on syncing templates store and indexedDB: ${e.message}`)}}async loadAllMissing(){const{templates:e}=this.#t.getState(),t=e.list.map((e=>e.imageId)).filter((e=>!this.#i.has(e)));for(const e of t)await this.loadExistingTemplate(e)}async loadExistingTemplate(e){try{const t=await this.#n.loadFile(e);if(!t)throw new Error("File does not exist in indexedDB");const{mimetype:n,buffer:i}=t,r=new q(e);return await r.fromBuffer(i,n),this.#i.set(e,r),this.#t.dispatch({type:"REC_TEMPLATE"}),r}catch(t){return console.error(`Error loading template ${e}: ${t.message}`),null}}async addFile(e,t,n,i,r){try{const o=await this.#n.saveFile(e),a=new q(o),l=await a.fromFile(e);this.#i.set(o,a),this.#t.dispatch(s(o,t,n,i,r,...l))}catch(e){console.error(`Error saving template ${t}: ${e.message}`)}}async updateFile(e,t){try{await this.#n.updateFile(e,t);const n=new q(e),i=await n.fromFile(t);this.#i.set(e,n),this.#t.dispatch(function(e,t,n){return{type:"s/UPD_TEMPLATE_IMG",imageId:e,width:t,height:n}}(e,...i))}catch(t){console.error(`Error updating file ${e}: ${t.message}`)}}changeTemplate(e,t){this.#t.dispatch(l(e,t))}deleteTemplate(e){const{list:t}=this.#t.getState().templates,n=t.find((t=>t.title===e));if(!n)return;const{imageId:i}=n;this.#t.dispatch(a(e)),this.#n.deleteFile(i),this.#i.delete(i)}async exportEnabledTemplates(){const{list:e}=this.#t.getState().templates,t=e.filter((e=>e.enabled));if(!t.length||t.length>20)return this.#t.dispatch((0,o.UI)("Fehler :(","Kann nicht mehr als 20 Vorlagen exportieren!","error")),null;const n=await this.#n.loadFile(t.map((e=>e.imageId))),i=[];for(let e=0;e<t.length;e+=1){const{buffer:r,mimetype:o}=n[e];i.push({...t[e],buffer:await(0,k.h$)(r),mimetype:o})}return i}async importTemplates(e){const t=JSON.parse(await e.text());if(!t.length||t.length>20)return void this.#t.dispatch((0,o.UI)("Fehler :(","Kann nicht mehr als 20 Vorlagen importieren!","error"));const n=await Promise.all(t.map((e=>(0,k._V)(e.buffer)))),i=[];for(let e=0;e<t.length;e+=1){const{mimetype:r}=t[e];i.push(new Blob([n[e]],{type:r}))}const{list:r}=this.#t.getState().templates,a=await this.#n.saveFile(i),l=[];for(let e=0;e<t.length;e+=1){const{x:n,y:i,width:o,height:c,canvasId:d,title:u}=t[e],h=a[e],f=r.find((e=>e.title===u));f?(l.push(f.imageId),this.changeTemplate(u,{imageId:h,title:u,canvasId:d,x:n,y:i,width:o,height:c})):this.#t.dispatch(s(h,u,d,n,i,o,c))}l.length&&this.#n.deleteFile(l)}};window.templateLoader=Q;const X=Q,J=1.2;function ee(e,t,n,i,r){const{width:o,height:s}=t,a=t.getContext("2d");if(!a)return;a.globalAlpha=.5,a.fillStyle=r?"#DDDDDD":"#222222";let[l,c]=(0,k.nK)(n,i,t,[0,0]),[d,u]=(0,k.Cr)(n,i,t,[l,c]);for(;d<o;d+=i){const e=l++%10==0?2:1;a.fillRect(d,0,e,s)}for(;u<s;u+=i){const e=c++%10==0?2:1;a.fillRect(0,u,o,e)}a.globalAlpha=1}class te{store;renderer;viewport;clickTapStartView=[0,0];clickTapStartTime=0;tapStartDist=50;clickTapStartCoords=[0,0];speedScalar=0;isClicking=!1;isMultiTap=!1;wasEverMultiTap=!1;isTapPainting=!1;tapTimeout=null;prevTime=Date.now();coolDownDelta=!1;constructor(e,t,n){this.store=n,this.renderer=e,this.viewport=t,this.onMouseDown=this.onMouseDown.bind(this),this.onAuxClick=this.onAuxClick.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onWheel=this.onWheel.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),t.addEventListener("auxclick",this.onAuxClick,!1),t.addEventListener("mousedown",this.onMouseDown,!1),t.addEventListener("mousemove",this.onMouseMove,!1),t.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("wheel",this.onWheel,!1),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("mouseout",this.onMouseOut,!1),t.addEventListener("touchcancel",this.onMouseOut,!1)}dispose(){}gotCoolDownDelta(e){this.coolDownDelta=!0,setTimeout((()=>{this.coolDownDelta=!1}),1e3*e)}onMouseDown(e){if(e.preventDefault(),document.activeElement.blur(),0===e.button){this.renderer.cancelStoreViewInState(),this.isClicking=!0;const{clientX:t,clientY:n}=e;this.clickTapStartTime=Date.now(),this.clickTapStartCoords=[t,n],this.clickTapStartView=this.renderer.view;const{viewport:i}=this;setTimeout((()=>{this.isClicking&&(i.style.cursor="move")}),300)}}onMouseUp(e){e.preventDefault();const{store:t,renderer:n}=this;if(0===e.button){this.isClicking=!1;const{clientX:i,clientY:r}=e,{clickTapStartCoords:o,clickTapStartTime:s}=this,a=[o[0]-i,o[1]-r].map(Math.abs);s>Date.now()-250&&a[0]<6&&a[1]<6&&te.placePixel(t,n,this.screenToWorld([i,r])),this.viewport.style.cursor="auto"}n.storeViewInState()}static getTouchCenter(e){let t=0,n=0;for(const{pageX:i,pageY:r}of e.touches)t+=i,n+=r;const{length:i}=e.touches;return[t/i,n/i]}static placePixel(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=e.getState();if(r.canvas.isHistoricalView)return;const o=i??te.getWantedColor(r,t,n);if(null===o)return;const{viewscale:s}=t;if(r.gui.autoZoomIn&&s<8)return void t.updateView([n[0],n[1],12]);if(s<3)return;const a=t.getColorIndexOfPixel(...n);if(o===a)return;if(o<r.canvas.clrIgnore){const{palette:e}=r.canvas,{rgb:t}=e;let n=3*o;const i=t[n++],s=t[n++],l=t[n];if(e.getIndexOfColor(i,s,l)===a)return}const{canvasSize:l}=r.canvas,[c,d]=n;if(c>5275&&d>-8713&&c<5398&&d<-8614&&"0"===r.canvas.canvasId)return void(window.location.href="https://files.catbox.moe/gh2wtr.mp4");const u=l/2;if(c<-u||c>=u||d<-u||d>=u)return;const[f,p]=(0,k.sG)(l,c,d),m=(0,k.NK)(l,c,d);h.Z.tryPlacePixel(f,p,m,o,a)}static getMultiTouchDistance(e){if(e.touches.length<2)return 1;const t=e.touches[0],n=e.touches[1];return Math.sqrt((n.pageX-t.pageX)**2+(n.pageY-t.pageY)**2)}onTouchStart(e){e.preventDefault(),document.activeElement.blur(),this.renderer.cancelStoreViewInState(),this.clearTabTimeout(),this.isTapPainting=!1,this.clickTapStartTime=Date.now(),this.clickTapStartCoords=(0,k.bt)(e),this.clickTapStartView=this.renderer.view,e.touches.length>1?(this.tapStartDist=te.getMultiTouchDistance(e),this.isMultiTap=!0,this.wasEverMultiTap=!0):(this.isMultiTap=!1,this.wasEverMultiTap=!1,this.store.getState().gui.holdPaint?this.tapTimeout=setTimeout((()=>{this.isTapPainting=!0,te.placePixel(this.store,this.renderer,this.screenToWorld(this.clickTapStartCoords))}),200):this.tapTimeout=setTimeout((()=>{this.selectColorFromScreen(this.clickTapStartCoords)}),600))}onTouchEnd(e){if(e.preventDefault(),e.touches.length)return;const{store:t,renderer:n}=this;if(!this.wasEverMultiTap){const[n,i]=(0,k.bt)(e),{clickTapStartCoords:r,clickTapStartTime:s}=this,a=[r[0]-n,r[1]-i].map(Math.abs);s>Date.now()-580&&a[0]<6&&a[1]<6&&(te.placePixel(t,this.renderer,this.screenToWorld([n,i])),setTimeout((()=>{t.dispatch((0,o.BH)())}),500))}n.storeViewInState(),this.clearTabTimeout()}onTouchMove(e){e.preventDefault(),e.stopPropagation();const t=e.touches.length>1,n=this.store.getState(),[i,r]=(0,k.bt)(e);if(this.isMultiTap!==t)return this.wasEverMultiTap=!0,this.isMultiTap=t,this.clickTapStartCoords=[i,r],this.clickTapStartView=this.renderer.view,void(this.tapStartDist=te.getMultiTouchDistance(e));const{clickTapStartView:o,clickTapStartCoords:s}=this;if(t){this.clearTabTimeout();const t=e.touches[0],n=e.touches[1],i=Math.sqrt((n.pageX-t.pageX)**2+(n.pageY-t.pageY)**2)/this.tapStartDist,[r,s]=this.renderer.view;this.renderer.updateView([r,s,o[2]*i])}if(!n.gui.holdPaint||t){const[e,t]=o,n=i-s[0],a=r-s[1];(n>5||a>5)&&this.clearTabTimeout();const{viewscale:l}=this.renderer;this.renderer.updateView([e-n/l,t-a/l])}else this.wasEverMultiTap||this.coolDownDelta||(this.isTapPainting?te.placePixel(this.store,this.renderer,this.screenToWorld([i,r])):(this.clickTapStartCoords=[i,r],this.clickTapStartView=this.renderer.view,this.tapStartDist=te.getMultiTouchDistance(e)))}clearTabTimeout(){this.tapTimeout&&(clearTimeout(this.tapTimeout),this.tapTimeout=null)}zoom(e,t){const[n,i,r]=this.renderer.view,o=r>=1?1.1:1.04,s=e>0?r*o:r/o;this.renderer.updateView([n,i,s],t),this.renderer.storeViewInState()}step(e){const[t,n,i]=this.renderer.view,[r,o]=e.map((e=>100*e/i));this.renderer.updateView([t+r,n+o]),this.renderer.storeViewInState()}holdPaintStarted(e){if(!e)return;const{hover:t}=this.store.getState().canvas;t&&te.placePixel(this.store,this.renderer,t)}onWheel(e){e.preventDefault(),e.stopPropagation(),document.activeElement.blur();const{deltaY:t}=e,{store:n}=this,{hover:i}=n.getState().canvas,r=i||null;t<0&&this.zoom(1,r),t>0&&this.zoom(-1,r)}static getWantedColor(e,t,n){if(e.gui.holdPaint===c.EQ.HISTORY)return t.getColorIndexOfPixel(...n,!0);if(e.gui.holdPaint===c.EQ.OVERLAY){const{canvasId:t}=e.canvas,i=X.getColorOfPixel(t,...n);return i?e.canvas.palette.getClosestIndexOfColor(...i):null}return e.canvas.selectedColor}screenToWorld(e){return(0,k.nK)(this.renderer.view,this.renderer.viewscale,this.viewport,e)}setHoverFromScrrenCoor(e){const{store:t}=this,n=t.getState(),{hover:i}=n.canvas,r=this.screenToWorld(e),[s,a]=r,{canvasSize:l}=n.canvas,c=l/2;return s<-c||s>=c||a<-c||a>=c?(i&&t.dispatch((0,o.BH)()),null):i&&i[0]===s&&i[1]===a?null:(t.dispatch((0,o.GZ)(r)),r)}onMouseMove(e){e.preventDefault();const{clientX:t,clientY:n}=e,{renderer:i,isClicking:r}=this,{viewscale:o}=i;if(r){if(Date.now()<this.clickTapStartTime+100)return;const{clickTapStartView:e,clickTapStartCoords:i}=this,[r,s]=e,a=t-i[0],l=n-i[1];this.renderer.updateView([r-a/o,s-l/o])}else{const e=this.setHoverFromScrrenCoor([t,n]);if(!e)return;const i=this.store.getState();!this.coolDownDelta&&i.gui.holdPaint&&te.placePixel(this.store,this.renderer,e)}}onMouseOut(){const{store:e,viewport:t}=this;t.style.cursor="auto",e.dispatch((0,o.BH)()),this.isClicking=!1,this.clearTabTimeout()}selectColorFromScreen(e){const{renderer:t,store:n}=this;if(this.renderer.viewscale<3)return;const i=this.screenToWorld(e),r=t.getColorIndexOfPixel(...i);null!==r&&n.dispatch((0,o.Oh)(r))}onAuxClick(e){const{which:t,clientX:n,clientY:i}=e;2===t&&(e.preventDefault(),this.selectColorFromScreen([n,i]))}update(){let e=Date.now();const{moveU:t,moveV:n,moveW:i}=this.store.getState().gui;if(!(t||n||i))return this.prevTime=e,this.speedScalar=0,!1;e-=this.prevTime,this.prevTime+=e,this.speedScalar=Math.min(1,this.speedScalar+.025);const[r,o,s]=this.renderer.view,a=.4*e/s*this.speedScalar;let l=s>=1?1.0005:1.0003;return l**=i*this.speedScalar,this.renderer.updateView([r+a*t,o+a*n,s*l**e]),!0}}const ne=te;var ie=n(686),re=n(802);class oe extends re.Z{image;ready;isEmpty;palette;constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0),this.palette=e,this.image=document.createElement("canvas"),this.image.getContext("2d"),this.image.width=c.I_,this.image.height=c.I_,this.ready=!1,this.isEmpty=!1}fromBuffer(e){this.recUpdates=!0;const t=new ImageData(c.I_,c.I_),n=new Uint32Array(t.data.buffer),{abgr:i}=this.palette;let r=e.byteLength;for(let t=0;t<r;t+=1)n[t]=i[63&e[t]];const o=c.I_**2,s=this.palette.abgr[0];for(;r<o;)n[r]=s,r+=1;this.image.getContext("2d").putImageData(t,0,0),this.ready=!0}preLoad(e,t,n,i){if(this.ready)return;this.ready=!0;const r=this.image.getContext("2d");r.save(),r.msImageSmoothingEnabled=!1,r.webkitImageSmoothingEnabled=!1,r.imageSmoothingEnabled=!1,r.scale(t,t);const o=c.I_/t;r.drawImage(e,n,i,o,o,0,0,o,o),r.restore()}fromImage(e){this.ready=!0,this.image.getContext("2d").drawImage(e,0,0)}empty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.ready=!0,this.isEmpty=!0,!e){const{image:e,palette:t}=this,n=e.getContext("2d");n.fillStyle=t.colors[0],n.fillRect(0,0,c.I_,c.I_)}}static getIndexFromCell(e){let[t,n]=e;return t+c.I_*n}getColorIndex(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const[n,i]=e,r=this.image.getContext("2d").getImageData(n,i,1,1).data;return t||0!==r[3]?t?this.palette.getClosestIndexOfColor(r[0],r[1],r[2]):this.palette.getIndexOfColor(r[0],r[1],r[2]):null}hasColorIn(e,t){const n=oe.getIndexFromCell(e),i=this.image.getContext("2d").getImageData(0,0,c.I_,c.I_);return new Uint32Array(i.data.buffer)[n]===this.palette.abgr[t]}setColor(e,t){const[n,i]=e,r=this.image.getContext("2d");return r.fillStyle=this.palette.colors[t],r.fillRect(n,i,1,1),!0}}const se=oe,ae=/^([\w]+:)?\/\//;function le(e){return new Promise(((t,n)=>{const i=new Image;i.addEventListener("load",(()=>t(i))),i.addEventListener("error",(()=>{n(new Error(`Failed to load image's URL: ${e}`))})),function(e){return ae&&e.replace(ae,"").indexOf(window.location.host)}(e)&&(i.crossOrigin="anonymous"),i.src=e}))}const ce=new class{tiles;constructor(){this.tiles={},this.loadLoadingTile(0)}getTile(e){return void 0===this.tiles[e]&&this.loadLoadingTile(e),this.tiles[e]||this.tiles[0]||null}async loadLoadingTile(e){null!==this.tiles[e]&&(this.tiles[e]=null,this.tiles[e]=await le(`./loading${e}.png`))}};class de extends ie.Z{canvasMaxTiledZoom;historicalMaxTiledZooms;palette;canvasSize;constructor(e,t,n,i,r){super(e,t),this.palette=n,this.canvasSize=i,this.canvasMaxTiledZoom=(0,k.W4)(i),this.historicalMaxTiledZooms=r?r.map((e=>{const[t,n]=e;return[t,(0,k.W4)(n)]})):[]}getPixelUpdate(e,t,n,i){const r=this.cget(`${this.canvasMaxTiledZoom}:${e}:${t}`);if(r){const e=n%c.I_,t=Math.floor(n/c.I_);r.setColor([e,t],i)}}getColorIndexOfPixel(e,t){const{canvasSize:n}=this,[i,r]=(0,k.sG)(n,e,t),o=`${this.canvasMaxTiledZoom}:${i}:${r}`,s=this.cget(o);return s?s.getColorIndex((0,k.D0)(n,[e,t])):null}getHistoricalIndexOfPixel(e,t,n,i,r){if(!n)return null;const[o,s]=(0,k.sG)(r,e,t),a=(0,k.D0)(r,[e,t]),l=Date.now();if(i&&i&&"0000"!==i){const e=`${n}${i}:${o}:${s}`,t=this.cget(e);if(t){const e=t.getColorIndex(a,!1);if(t.timestamp=l,null!==e)return e}}const c=`${n}:${o}:${s}`,d=this.cget(c);return d?(d.timestamp=l,d.getColorIndex(a)):null}preLoadChunk(e,t,n,i){if(e<=0)return null;try{let r=e-1,o=c.p7,[s,a]=[t,n].map((e=>Math.floor(e/o))),l=this.getChunk(r,s,a,!1,!1,!0);if(l||(r>0&&(r-=1),o=c.p7**(e-r),[s,a]=[t,n].map((e=>Math.floor(e/o))),l=this.getChunk(r,s,a,!0,!1,!0)),l){const e=t%o*c.I_/o,r=n%o*c.I_/o;return i.preLoad(l,o,e,r),i.image}}catch(i){return console.warn(`Error occurred while preloading for ${e}:${t}:${n}`,i),null}return null}getChunk(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const s=`${e}:${t}:${n}`;let a=this.cget(s);if(a){if(a.ready)return a.image}else i&&(a=new se(this.palette,e,t,n),this.cset(s,a),this.canvasMaxTiledZoom===e?this.fetchBaseChunk(t,n,a):this.fetchTile(e,t,n,a));if(o&&a){const i=this.preLoadChunk(e,t,n,a);if(i)return i}return r?ce.getTile(this.canvasId):null}getHistoricalChunk(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=r?`${i}${r}`:i;o+=`:${e}:${t}`;const s=this.cget(o),{canvasId:a}=this;if(s)return s.ready?s.image:r?null:ce.getTile(a);if(n){const n=(0,k.Ss)(i,this.canvasMaxTiledZoom,this.historicalMaxTiledZooms),s=new se(this.palette,n,e,t);this.cset(o,s),this.fetchHistoricalChunk(e,t,i,r,s)}return r?null:ce.getTile(a)}async fetchHistoricalChunk(e,t,n,i,r){const{canvasId:o}=this;let s=`${window.ssv.backupurl}/${n.slice(0,4)}/${n.slice(4,6)}/${n.slice(6)}/`;s+=i?`${o}/${i}/${e}/${t}.png`:`${o}/tiles/${e}/${t}.png`,this.bcReqChunk(r);try{const e=await le(s);r.fromImage(e),this.bcRecChunk(r)}catch(e){this.bcReqChunkFail(r,e),i?r.empty(!0):r.empty()}}async fetchBaseChunk(e,t,n){this.bcReqChunk(n);try{const i=`${G.Fx}/chunks/${this.canvasId}/${e}/${t}.bmp`,r=await fetch(i);if(!r.ok)throw new Error("Network response was not ok.");{const e=await r.arrayBuffer();if(!e.byteLength)throw new Error("Chunk response was invalid");{const t=new Uint8Array(e);n.fromBuffer(t)}this.bcRecChunk(n)}}catch(e){n.empty(),n.recUpdates=!0,this.bcReqChunkFail(n,e)}}async fetchTile(e,t,n,i){this.bcReqChunk(i);try{const r=`/tiles/${this.canvasId}/${e}/${t}/${n}.webp`,o=await le(r);i.fromImage(o),this.bcRecChunk(i)}catch(e){i.empty(),this.bcReqChunkFail(i,e)}}}const ue=de;class he{static NOTIFICATION_TIME=1100;scale;notifcircle;notificationRadius;pixelList;constructor(){this.pixelList=[],this.notificationRadius=150,this.notifcircle=document.createElement("canvas"),this.notifcircle.width=200,this.notifcircle.height=200;const e=this.notifcircle.getContext("2d");e&&(e.fillStyle="#FF000055",e.beginPath(),e.arc(100,100,100,0,2*Math.PI),e.closePath(),e.fill())}addPixel(e,t){this.pixelList.length<300&&this.pixelList.unshift([Date.now(),e,t])}doRender(){return 0!==this.pixelList.length}updateScale(e){this.scale=e,this.notificationRadius=(0,k.uZ)(10*this.scale,20,400)}render(e,t,n,i){const r=t.getContext("2d");if(!r)return;const o=Date.now();let s=this.pixelList.length;for(;s>0;){s--;const[e,a,l]=this.pixelList[s],c=o-e;if(c>he.NOTIFICATION_TIME){this.pixelList.pop();continue}const[d,u]=(0,k.Cr)(n,i,t,[a,l]).map((e=>e+this.scale/2)),h=c/he.NOTIFICATION_TIME*this.notificationRadius/100;r.save(),r.scale(h,h),r.drawImage(this.notifcircle,d/h-100,u/h-100),r.restore()}}}const fe=new he;class pe extends K.Z{canvasId=null;viewscale=0;centerChunk=[null,null];tiledScale=0;tiledZoom=4;hover=!1;viewport=null;lastFetch=0;canvas;oldHistoricalTime=null;constructor(e){super(e),this.is3D=!1,this.canvasMaxTiledZoom=0,this.historicalCanvasMaxTiledZoom=0,this.scaleThreshold=1;const t=document.createElement("canvas");t.className="viewport";const n=t.getContext("2d",{alpha:!1});this.viewport=t;const i=document.createElement("canvas"),r=i.getContext("2d",{alpha:!1});this.canvas=i,this.onWindowResize(),r.fillStyle="#C4C4C4",r.fillRect(0,0,this.canvas.width,this.canvas.height),n.fillStyle="#C4C4C4",n.fillRect(0,0,this.viewport.width,this.viewport.height),document.body.appendChild(this.viewport),this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize),this.updateCanvasData(e.getState()),this.controls=new ne(this,this.viewport,e)}destructor(){this.controls.dispose(),window.removeEventListener("resize",this.onWindowResize),this.viewport.remove(),super.destructor()}getViewport(){return this.viewport}onWindowResize(){this.viewport.width=window.innerWidth,this.viewport.height=window.innerHeight;const e=2*Math.ceil(window.screen.width/2)+c.p7*c.I_,t=2*Math.ceil(window.screen.height/2)+c.p7*c.I_;this.canvas.width===e&&this.canvas.height===t||(console.log(`Noticed screen: ${e} / ${t}`),this.canvas.width=e,this.canvas.height=t,this.scaleThreshold=Math.min(e/c.I_/3,t/c.I_/3)),this.forceNextRender=!0}updateCanvasData(e){const{canvasId:t}=e.canvas;if(t!==this.canvasId){if(this.canvasId=t,null!==t){const{palette:n,canvasSize:i,canvases:r}=e.canvas;this.canvasMaxTiledZoom=(0,k.W4)(i),this.historicalCanvasMaxTiledZoom=this.canvasMaxTiledZoom,this.chunkLoader=new ue(this.store,t,n,i,r[t].historicalSizes)}this._view[2]=0,this.updateView(e.canvas.view),this.forceNextRender=!0}}updateOldHistoricalTime(e,t){this.oldHistoricalTime="0000"===t?null:t}updateHistoricalTime(e,t,n){this.historicalCanvasMaxTiledZoom=(0,k.W4)(n),this.forceNextRender=!0,this.updateView(this.store.getState().canvas.view)}getColorIndexOfPixel(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){const n=this.store.getState(),{historicalDate:i,historicalTime:r,historicalCanvasSize:o}=n.canvas;return this.chunkLoader.getHistoricalIndexOfPixel(e,t,i,r,o)}return this.chunkLoader.getColorIndexOfPixel(e,t)}getPointedColor(){const{hover:e}=this.store.getState().canvas;return e?this.getColorIndexOfPixel(...e):null}updateView(e,t){let[n,i,r]=e;const o=this.store.getState(),{isHistoricalView:s}=o.canvas,a=s?o.canvas.historicalCanvasSize:o.canvas.canvasSize;if(r){const o=s?.7:c.I_/a;if(r=(0,k.uZ)(e[2],o,c.Fv),t){let e=this.viewscale;this.viewscale=r>.85&&r<1.2?1:r,e/=this.viewscale;const[o,s]=t;n=o+(n-o)*e,i=s+(i-s)*e}else this.viewscale=r}else[,,r]=this._view;const l=-a/2,d=a/2-1;n=(0,k.uZ)(n,l,d),i=(0,k.uZ)(i,l,d);const u=this.view[2];if(super.updateView([n,i,r]),u!==r){const{viewscale:e}=this;fe.updateScale(e);let t=e>.5?0:Math.round(2*Math.log2(e)/c.p7);t=c.p7**t;const n=(s?this.historicalCanvasMaxTiledZoom:this.canvasMaxTiledZoom)+2*Math.log2(t)/c.p7,i=e/t;this.tiledScale=t,this.tiledZoom=n,this.relScale=i,e<this.scaleThreshold||u<this.scaleThreshold||o.templates.ovEnabled&&(u<=c.vB&&r>c.vB||u>c.vB&&r<=c.vB)?this.forceNextRender=!0:this.forceNextSubrender=!0}const h=this.centerChunk,f=(0,k.HD)(this.tiledScale,[n,i],a);h&&h[0]===f[0]&&h[1]===f[1]?this.forceNextSubrender=!0:(this.centerChunk=f,this.forceNextRender=!0)}renderPixel(e,t,n,i,r){const o=this.store.getState(),{canvasSize:s,palette:a,isHistoricalView:l}=o.canvas,d=this.viewscale;if(this.chunkLoader.getPixelUpdate(e,t,n,i),d<.8||l)return;const u=d>this.scaleThreshold?1:d,h=this.canvas.getContext("2d");if(!h)return;const[f,p]=(0,k._O)(e,t,n,s),[m,v]=this.centerChunk.map((e=>(e+.5)*c.I_-s/2)),{width:g,height:w}=this.canvas,y=(f-m)*u+g/2,b=(p-v)*u+w/2;y<0||y>=g||b<0||b>=w||(h.fillStyle=a.colors[i],h.fillRect(y,b,u,u),r&&fe.addPixel(f,p),this.forceNextSubrender=!0)}isChunkInView(e,t,n){const{tiledZoom:i}=this;if(e>i+1)return!1;let[r,o]=this.centerChunk,{relScale:s}=this;if(e!==i){const t=c.p7**(e-i);r=Math.floor(r*t),o=Math.floor(o*t),s*=t}const{width:a,height:l}=this.viewport,d=Math.ceil(a/c.I_/2/s),u=Math.ceil(l/c.I_/2/s);return Math.abs(t-r)<=d&&Math.abs(n-o)<=u}renderChunks(e){const t=this.canvas.getContext("2d");if(!t)return;const{centerChunk:n,tiledScale:i,tiledZoom:r,viewport:o,viewscale:s}=this,{canvasSize:a}=e.canvas;let{relScale:l}=this;s>=1?(t.msImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1):(t.msImageSmoothingEnabled=!0,t.webkitImageSmoothingEnabled=!0,t.imageSmoothingEnabled=!0);const{width:d,height:u}=o,h=Math.ceil(d/c.I_/2/l),f=Math.ceil(u/c.I_/2/l);s>this.scaleThreshold&&(l=1),t.save(),t.fillStyle="#C4C4C4",t.scale(l,l);const p=Date.now();let m=!1;p>this.lastFetch+150&&(this.lastFetch=p,m=!0);const v=this.canvas.width/2/l-c.I_/2,g=this.canvas.height/2/l-c.I_/2,[w,y]=n;let b;for(let e=-h;e<=h;e+=1)for(let n=-f;n<=f;n+=1){const o=w+e,s=y+n,l=v+e*c.I_,d=g+n*c.I_,u=a/c.I_;o<0||o>=u*i||s<0||s>=u*i?t.fillRect(l,d,c.I_,c.I_):(b=this.chunkLoader.getChunk(r,o,s),b?(t.drawImage(b,l,d),m&&(b.timestamp=p)):t.fillRect(l,d,c.I_,c.I_))}t.restore(),e.templates.ovEnabled&&(s<c.vB||!e.templates.oSmallPxls)&&function(e,t,n,i,r,o){if(!X.ready||i<.035)return;const{canvasSize:s,canvasId:a}=e.canvas,[l,d]=n.map((e=>e*c.I_/r+c.I_/2/r-s/2)),u=i>o?1:i,{width:h,height:f}=t,p=h/2/u,m=f/2/u,v=X.getTemplatesInView(a,l,d,p,m);if(!v.length)return;const g=t.getContext("2d");if(g){g.imageSmoothingEnabled=!1,g.save(),g.scale(u,u),g.globalAlpha=e.templates.oOpacity/100;for(const e of v){if(e.width*u<1||e.height*u<1)continue;const t=X.getTemplateSync(e.imageId);t&&g.drawImage(t,e.x-l+h/2/u,e.y-d+f/2/u)}g.restore()}}(e,this.canvas,n,s,this.tiledScale,this.scaleThreshold)}render(){if(!this.chunkLoader)return;super.render();const e=this.store.getState();e.canvas.isHistoricalView?this.renderHistorical(e):this.renderMain(e)}renderMain(e){const{_view:t,viewport:n,viewscale:i}=this,{showGrid:r,showPixelNotify:o,isPotato:s,isLightGrid:a}=e.gui,{fetchingPixel:l}=e.fetching,{canvasSize:d,hover:u}=e.canvas,[h,f]=t,[p,m]=this.centerChunk,v=i>=.5&&o&&fe.doRender(),g=i>=3&&!l&&(u||this.hover)&&!s,w=i>=3&&!l&&(u!==this.hover||this.forceNextRender||this.forceNextSubrender||v)&&s;if(!(this.forceNextRender||g||w||v||this.forceNextSubrender))return;this.hover=u,this.forceNextRender&&this.renderChunks(e),this.forceNextRender=!1,this.forceNextSubrender=!1;const{width:y,height:b}=n,S=n.getContext("2d");if(!S)return;S.msImageSmoothingEnabled=!1,S.webkitImageSmoothingEnabled=!1,S.imageSmoothingEnabled=!1;const E=d/2;i>this.scaleThreshold?(S.save(),S.scale(i,i),S.drawImage(this.canvas,y/2/i-this.canvas.width/2+((p+.5)*c.I_-E-h),b/2/i-this.canvas.height/2+((m+.5)*c.I_-E-f)),S.restore()):S.drawImage(this.canvas,Math.floor(y/2-this.canvas.width/2+((p+.5)*c.I_/this.tiledScale-E-h)*i),Math.floor(b/2-this.canvas.height/2+((m+.5)*c.I_/this.tiledScale-E-f)*i)),e.templates.ovEnabled&&e.templates.oSmallPxls&&i>=c.vB&&function(e,t,n,i){if(!X.ready)return;const{canvasId:r}=e.canvas,[o,s]=n,{width:a,height:l}=t,c=a/2/i,d=l/2/i,u=X.getTemplatesInView(r,o,s,c,d);if(!u.length)return;const h=t.getContext("2d");if(!h)return;const f=i/3;h.imageSmoothingEnabled=!1,h.save(),h.scale(f,f);for(const e of u){const t=X.getSmallTemplateSync(e.imageId);t&&h.drawImage(t,3*(e.x-o)+a/2/f,3*(e.y-s)+l/2/f)}h.restore()}(e,n,t,i),r&&i>=8&&ee(0,n,t,i,a),v&&fe.render(e,n,t,i),u&&g&&function(e,t,n,i){const r=t.getContext("2d"),{hover:o,palette:s,selectedColor:a}=e.canvas,[l,c]=(0,k.Cr)(n,i,t,o);r.save(),r.translate(l+i/2,c+i/2);const d=Math.sin(Date.now()/250)/4;r.rotate(d),r.fillStyle="#000",r.fillRect(-.6*i-1,-.6*i-1,i*J+2,i*J+2),r.fillStyle=s.colors[a],r.fillRect(.6*-i,.6*-i,i*J,i*J),r.restore()}(e,n,t,i),u&&w&&function(e,t,n,i){const r=t.getContext("2d"),{palette:o,selectedColor:s,hover:a}=e.canvas,[l,c]=(0,k.Cr)(n,i,t,a);r.save(),r.fillStyle="#000",r.fillRect(l-1,c-1,4,i+2),r.fillRect(l-1,c-1,i+2,4),r.fillRect(l+i-2,c-1,4,i+2),r.fillRect(l-1,c+i-2,i+1,4),r.fillStyle=o.colors[s],r.fillRect(l,c,2,i),r.fillRect(l,c,i,2),r.fillRect(l+i-1,c,2,i),r.fillRect(l,c+i-1,i,2),r.restore()}(e,n,t,i)}renderHistoricalChunks(e){const t=this.canvas.getContext("2d");if(!t)return;const{centerChunk:n,viewport:i,viewscale:r,oldHistoricalTime:o}=this,{historicalDate:s,historicalTime:a,historicalCanvasSize:l}=e.canvas;r>=1?(t.msImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1):(t.msImageSmoothingEnabled=!0,t.webkitImageSmoothingEnabled=!0,t.imageSmoothingEnabled=!0);const d=r>this.scaleThreshold?1:r,{width:u,height:h}=i,f=Math.ceil(u/c.I_/2/d),p=Math.ceil(h/c.I_/2/d);if(t.save(),t.fillStyle="#C4C4C4",!s||!a)return t.fillRect(0,0,this.canvas.width,this.canvas.height),void t.restore();t.scale(d,d);const m=Date.now();let v=!1;m>this.lastFetch+150&&(this.lastFetch=m,v=!0);const g=this.canvas.width/2/d-c.I_/2,w=this.canvas.height/2/d-c.I_/2,[y,b]=n;let S;for(let e=-f;e<=f;e+=1)for(let n=-p;n<=p;n+=1){const i=y+e,r=b+n,d=g+e*c.I_,u=w+n*c.I_,h=l/c.I_;if(i<0||i>=h||r<0||r>=h)t.fillRect(d,u,c.I_,c.I_);else{if(S=this.chunkLoader.getHistoricalChunk(i,r,!0,s),S?(t.drawImage(S,d,u),v&&(S.timestamp=m)):t.fillRect(d,u,c.I_,c.I_),"0000"===a)continue;S=this.chunkLoader.getHistoricalChunk(i,r,!0,s,a),S?S.isEmpty||(t.drawImage(S,d,u),v&&(S.timestamp=m)):o&&(S=this.chunkLoader.getHistoricalChunk(i,r,!1,s,o),S&&!S.isEmpty&&(t.drawImage(S,d,u),v&&(S.timestamp=m)))}}t.restore()}renderHistorical(e){const{viewport:t,viewscale:n}=this,{showGrid:i,isLightGrid:r}=e.gui,{historicalCanvasSize:o}=e.canvas,[s,a]=this._view,[l,d]=this.centerChunk;if(!this.forceNextRender&&!this.forceNextSubrender)return;this.forceNextRender&&this.renderHistoricalChunks(e),this.forceNextRender=!1,this.forceNextSubrender=!1;const{width:u,height:h}=t,f=t.getContext("2d");if(!f)return;f.msImageSmoothingEnabled=!1,f.webkitImageSmoothingEnabled=!1,f.imageSmoothingEnabled=!1;const p=o/2;n>this.scaleThreshold?(f.save(),f.scale(n,n),f.drawImage(this.canvas,u/2/n-this.canvas.width/2+((l+.5)*c.I_-p-s),h/2/n-this.canvas.height/2+((d+.5)*c.I_-p-a)),f.restore()):f.drawImage(this.canvas,Math.floor(u/2-this.canvas.width/2+((l+.5)*c.I_-p-s)*n),Math.floor(h/2-this.canvas.height/2+((d+.5)*c.I_-p-a)*n)),i&&n>=8&&ee(0,t,this._view,n,r)}}const me=pe,ve=new K.Z;let ge=ve;async function we(e,t){switch(ge.destructor(),t){case!0:if((0,k.b3)()){const t=(await Promise.all([n.e(841),n.e(882)]).then(n.bind(n,156))).default;ge=new t(e)}else e.dispatch((0,o.UI)("Leinwand Fehler","Kann die 3D Leinwand nicht laden. Ist WebGL2 im Browser deaktiviert?","error","OK")),ge=ve;break;case!1:ge=new me(e);break;default:ge=ve}return ge}function ye(){return ge}!function e(){ge.render(),window.requestAnimationFrame(e)}();const be="PixelPlanet.fun";let Se=null;const ke=new class{constructor(){this.wins=[],this.origin=window.location.origin,window.addEventListener("beforeunload",(()=>{this.dispatch((0,o.Rz)())}))}add(e){-1===this.wins.indexOf(e)&&this.wins.push(e)}remove(e){const t=this.wins.indexOf(e);~t&&this.wins.splice(t,1)}dispatch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{wins:n}=this;try{for(let i=0;i<n.length;i+=1){const r=n[i];r.closed?(n.splice(i,1),i-=1):r!==t&&r.postMessage(e,this.origin)}}catch{return!1}return!0}closeAll(){for(;this.wins.length;)this.wins.pop().close()}};var Ee=n(7187);let Ce=!1;const Te=new(n.n(Ee)());function Ie(e){!Ce||e.is3D||e.origUpdateView||(console.log("Extension hooked into Renderer"),e.origUpdateView=e.updateView,e.updateView=function(){const[e,t,n]=this._view;this.origUpdateView(...arguments);const[i,r,o]=this._view;if(i===e&&r===t||Te.emit("setviewcoordinates",[i,r]),o!==n){const e=(arguments.length<=1?void 0:arguments[1])&&o>.85&&o<1.2?1:o;Te.emit("setscale",e)}})}!function(){function e(){console.log("Extension active"),Te.once=Te.origOnce,Te.addListener=Te.origAdd,Te.on=Te.addListener,delete Te.origOnce,delete Te.origAdd,Ce=!0,Ie(ye())}Te.origOnce=Te.once,Te.origAdd=Te.addListener,Te.once=function(){Te.origOnce(...arguments),e()},Te.addListener=function(){Te.origAdd(...arguments),e()},Te.on=Te.addListener}(),window.pixelPlanetEvents=Te;const xe=(0,i.OJ)({key:"wind",storage:m.Z,version:17,migrate:L},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_WIN":{const{windowType:n,title:i,cloneable:r,args:o,xPos:s,yPos:a,width:l,height:c}=t,[d,u]=R(l,c,!0),[h,f]=D(s,a,d,u),p=!e.showWindows||t.fullscreen;if(e.windows.length>=100)return e;const m=O(e),v=e.zMax+1;return M({...e,zMax:v,windows:[...e.windows,{windowId:m,windowType:n,open:!0,hidden:!1,fullscreen:p,title:i,cloneable:r}],args:{...e.args,[m]:{...o}},positions:{...e.positions,[m]:{width:d,height:u,xPos:h,yPos:f,z:v}}})}case"REMOVE_WIN":{const{windowId:n}=t,i={...e.args},r={...e.positions};return delete i[n],delete r[n],{...e,windows:e.windows.filter((e=>e.windowId!==n)),args:i,positions:r}}case"CLOSE_WIN":{const{windowId:n}=t,i=e.windows.map((e=>e.windowId!==n?e:{...e,open:!1}));return{...e,windows:i}}case"CLOSE_ALL_WIN_TYPE":{const{windowType:n}=t,i=e.windows.map((e=>e.windowType!==n?e:{...e,open:!1}));return{...e,windows:i}}case"HIDE_ALL_WIN_TYPE":{const{windowType:n,hide:i}=t,r=e.windows.map((e=>e.windowType!==n?e:{...e,hidden:i}));return{...e,windows:r}}case"CLONE_WIN":{const{windowId:n}=t,i=e.windows.find((e=>e.windowId===n)),r=e.positions[n],o=O(e),s=e.zMax+1,{innerWidth:a,innerHeight:l}=window;return M({...e,zMax:s,windows:[...e.windows,{...i,windowId:o}],args:{...e.args,[o]:{...e.args[n]}},positions:{...e.positions,[o]:{...r,xPos:Math.min(r.xPos+15,a-70),yPos:Math.min(r.yPos+15,l-30),z:s}}})}case"CHANGE_WIN_TYPE":{const{windowId:n,windowType:i,title:r}=t,o={...e.args,[n]:{...t.args}},s=e.windows.map((e=>e.windowId!==n?e:{...e,windowType:i,title:r}));return{...e,args:o,windows:s}}case"FOCUS_WIN":{const{windowId:n}=t,{zMax:i}=e,{z:r}=e.positions[n];return r===i?e:M({...e,zMax:i+1,positions:{...e.positions,[n]:{...e.positions[n],z:i+1}}})}case"TGL_MAXIMIZE_WIN":{const{windowId:n}=t,i=e.windows.map((e=>e.windowId!==n?e:{...e,fullscreen:!e.fullscreen,open:!0,hidden:!1}));return{...e,windows:i}}case"CLOSE_FULLSCREEN_WINS":{const t=e.windows.map((e=>e.fullscreen?{...e,open:!1}:e));return{...e,windows:t}}case"MOVE_WIN":{const{windowId:n,xDiff:i,yDiff:r}=t;let{xPos:o,yPos:s}=e.positions[n];const{width:a,height:l}=e.positions[n];return[o,s]=D(o+i,s+r,a,l),{...e,positions:{...e.positions,[n]:{...e.positions[n],xPos:o,yPos:s}}}}case"RESIZE_WIN":{const{windowId:n,xDiff:i,yDiff:r}=t;let{width:o,height:s}=e.positions[n];return[o,s]=R(o+i,s+r,!1),{...e,positions:{...e.positions,[n]:{...e.positions[n],width:o,height:s}}}}case"persist/REHYDRATE":{const{showWindows:n}=e;if(!n||"wind"!==t.key)return e;const i={...e,...t.payload},r={...i.args},o={...i.positions},s=i.windows.filter((e=>!(!e.open||!e.fullscreen&&!n)||(console.log(`Cleaning up window from previous session: ${e.windowId}`),delete r[e.windowId],delete o[e.windowId],!1)));return M($({...i,windows:s,args:r,positions:o}))}case"WIN_RESIZE":{const t=window.innerWidth>604;return t?$(t===e.showWindows?e:{...e,showWindows:t}):{...e,showWindows:t}}case"SET_WIN_TITLE":{const{windowId:n,title:i}=t,r=e.windows.map((e=>e.windowId!==n?e:{...e,title:i}));return{...e,windows:r}}case"SET_WIN_ARGS":{const{windowId:n,args:i}=t;return{...e,args:{...e.args,[n]:{...e.args[n],...i}}}}default:return e}})),Ne=(0,f.UY)({...P,windows:xe,alert:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ALERT":{const{title:n,message:i,alertType:r,btn:o}=t;return{...e,open:!0,title:n,message:i,alertType:r,btn:o}}case"CLOSE_ALERT":return{...e,open:!1};default:return e}}}),_e=(0,f.MT)(Ne,(0,f.md)(p.Z,(()=>e=>t=>Array.isArray(t)?t.map(e):e(t)),(e=>t=>n=>{if(n instanceof MessageEvent){if(n.origin!==window.location.origin||!n.data.type)return null;if("t/UNLOAD"===n.data.type)console.log("popup closed"),ke.remove(n.source);else if("t/LOAD"===n.data.type){const t=e.getState();n.source.postMessage((0,o.GY)(t),window.location.origin),ke.add(n.source),console.log("popup added")}else n.data.type.startsWith("s/")&&ke.dispatch(n.data,n.source);return t(n.data)}return ke.wins.length&&n.type&&n.type.startsWith("s/")&&ke.dispatch(n),t(n)}),(e=>t=>n=>{const i=e.getState(),{mute:r,chatNotify:o}=i.gui;if(!r&&H)switch(n.type){case"SELECT_COLOR":{const e=H.createOscillator(),t=H.createGain(),{currentTime:n}=H;e.type="sine",e.detune.value=-600,e.frequency.setValueAtTime(600,n),e.frequency.setValueAtTime(700,n+.1),t.gain.setValueAtTime(.3,n),t.gain.exponentialRampToValueAtTime(.2,n+.1),e.connect(t),t.connect(H.destination),e.start(),e.stop(n+.2);break}case"SET_NOTIFICATION":{const{notification:e}=n;if("string"!=typeof e)break;const t=H.createOscillator(),i=H.createGain(),{currentTime:r}=H;t.type="sine",t.detune.value=-1200,t.frequency.setValueAtTime(500,r),t.frequency.setValueAtTime(600,r+.1),i.gain.setValueAtTime(.3,r),i.gain.exponentialRampToValueAtTime(.2,r+.1),t.connect(i),i.connect(H.destination),t.start(),t.stop(r+.2);break}case"ALERT":{const e=H.createOscillator(),t=H.createGain(),{currentTime:i}=H;if("captcha"===n.alertType)e.type="sine",e.detune.value=-600,e.start(i),e.frequency.setValueAtTime(1479.98,i),e.frequency.exponentialRampToValueAtTime(493.88,i+.01),e.stop(i+.1),t.gain.setValueAtTime(.5,i),t.gain.setTargetAtTime(0,i,.1),e.connect(t),t.connect(H.destination);else{e.type="sine",e.detune.value=-900,e.start(i),e.frequency.setValueAtTime(600,i),e.frequency.setValueAtTime(1400,i+.025),e.frequency.setValueAtTime(1200,i+.05),e.frequency.setValueAtTime(900,i+.075),e.stop(i+.3);const n=H.createOscillator();n.type="sine",n.start(i),n.frequency.setValueAtTime(2,i),n.stop(i+.3),n.connect(t),t.gain.setValueAtTime(1,i),t.gain.setTargetAtTime(0,i,3),e.connect(t),t.connect(H.destination)}break}case"REC_SET_PXLS":switch(n.retCode){case 0:{const{palette:e,selectedColor:t}=i.canvas,n=e.colors.length,r=100+300*Math.log(t/n+1),o=H.createOscillator(),s=H.createGain(),{currentTime:a}=H;o.type="sine",o.start(a),o.frequency.setValueAtTime(r,a),o.frequency.exponentialRampToValueAtTime(1400,a+.2),o.stop(a+.1),s.gain.setValueAtTime(.5,a),s.gain.setTargetAtTime(0,a,.1),o.connect(s),s.connect(H.destination);break}case 9:{const e=H.createOscillator(),t=H.createGain(),{currentTime:n}=H;e.type="sine",e.start(n),e.frequency.setValueAtTime(1479.98,n),e.frequency.exponentialRampToValueAtTime(493.88,n+.01),e.stop(n+.1),t.gain.setValueAtTime(.5,n),t.gain.setTargetAtTime(0,n,.1),e.connect(t),t.connect(H.destination);break}}break;case"COOLDOWN_END":{const{lastCoolDownEnd:e}=i.user;if(e&&e+5e3>Date.now())break;const t=H.createOscillator(),n=H.createGain(),{currentTime:r}=H;t.type="sine",t.frequency.setValueAtTime(349.23,r),t.frequency.setValueAtTime(523.25,r+.1),t.frequency.setValueAtTime(698.46,r+.2),n.gain.setValueAtTime(.5,r),n.gain.exponentialRampToValueAtTime(.2,r+.15),t.connect(n),n.connect(H.destination),t.start(),t.stop(r+.3);break}case"s/REC_CHAT_MESSAGE":{if(o)break;const{isPing:e,channel:t}=n,{mute:r,chatChannel:s}=i.chatRead;if(r.includes(t)||r.includes(`${t}`))break;const{channels:a}=i.chat,l=H.createOscillator(),c=H.createGain(),{currentTime:d}=H;l.type="sine",l.frequency.setValueAtTime(310,d);const u=e||a[t]&&1===a[t][1]&&t!=s?540:355;l.frequency.exponentialRampToValueAtTime(u,d+.025),c.gain.setValueAtTime(.1,d),c.gain.exponentialRampToValueAtTime(.1,d+.1),l.connect(c),c.connect(H.destination),l.start(),l.stop(d+.075);break}}return t(n)}),(e=>t=>n=>{try{if(!document.hasFocus())switch(n.type){case"s/REC_ME":window.Notification&&"granted"!==Notification.permission&&"denied"!==Notification.permission&&Notification.requestPermission();break;case"COOLDOWN_END":{const t=e.getState(),{lastCoolDownEnd:n}=t.user;if(n&&n+15e3>Date.now())break;window.Notification&&"granted"===Notification.permission&&new Notification("Deine nächsten Pixel sind verfügbar",{icon:"/tile.png",silent:!1,vibrate:[200,100],body:"Du kannst nun mehr Pixel auf pixelplanet.fun setzen :)"});break}case"s/REC_CHAT_MESSAGE":{const t=e.getState(),{chatNotify:i}=t.gui;if(!i)break;const{isPing:r}=n;if(!r)break;const{name:o}=n;window.Notification&&"granted"===Notification.permission&&new Notification(`${o} hat dich erwähnt`,{icon:"/tile.png",silent:!1,vibrate:[200,100],body:"Du hast neue Nachrichten in der Kommentarsektion"});break}}}catch(e){console.error(e)}return t(n)}),(e=>t=>n=>{const i=t(n);switch(n.type){case"COOLDOWN_SET":{const{coolDown:t}=e.getState().user,n=`${(0,k.VL)(t,!0)} | ${be}`;if(Se===n)break;Se=n,document.title=n;break}case"COOLDOWN_END":document.title=be;break;case"s/SELECT_CANVAS":case"s/REC_ME":case"RELOAD_URL":case"UPDATE_VIEW":{const t=e.getState(),{view:i,canvasIdent:r,is3D:o}=t.canvas;if("UPDATE_VIEW"!==n.type){const[e,n,i]=t.canvas.palette.rgb;!function(e,t,n){const i=document.querySelector("meta[name=theme-color]");i&&i.setAttribute("content",`rgb(${e}, ${t}, ${n})`)}(e,n,i)}const s=`#${r},${i.map(((e,t)=>(2!==t||o||(e=10*Math.log2(e)),Math.round(e)))).join(",")}`;window.history.replaceState(void 0,void 0,s);break}}return i}),(e=>t=>n=>{switch(n.type){case"REC_BIG_CHUNK":case"REC_BIG_CHUNK_FAILURE":{const{chunk:e}=n;e.recUpdates&&B.registerChunk(n.chunk.id);break}case"REMOVE_CHUNKS":{const{chunks:e}=n,t=e.filter((e=>e.recUpdates)).map((e=>e.id));t.length&&B.deRegisterChunks(t);break}case"s/SET_NAME":case"s/LOGIN":case"s/LOGOUT":B.reconnect();break;case"s/REQ_CHAT_MESSAGE":{const{text:e,channel:t}=n;B.sendChatMessage(e,t);break}case"RELOAD_URL":case"s/SELECT_CANVAS":case"s/REC_ME":{const i=e.getState(),r=t(n),o=e.getState(),{canvasId:s}=o.canvas;return i.canvas.canvasId!==s&&B.setCanvas(s),r}}return t(n)}),(()=>e=>t=>{const{type:n}=t;switch(n){case"s/SELECT_CANVAS":Te.emit("selectcanvas",t.canvasId);break;case"SET_HOVER":Te.emit("sethover",t.hover);break;case"REC_BIG_CHUNK":Te.emit("receivechunk",t.chunk)}const i=e(t);switch(n){case"RELOAD_URL":case"s/SELECT_CANVAS":case"s/TGL_EASTER_EGG":case"s/REC_ME":Ce&&Ie(ye())}return i}),(e=>t=>n=>{const{type:i}=n;switch(i){case"SET_HISTORICAL_TIME":{const t=e.getState(),n=ye(),{historicalDate:i,historicalTime:r}=t.canvas;n.updateOldHistoricalTime(i,r);break}case"SELECT_HOVER_COLOR":{const t=ye().getPointedColor();null!==t&&e.dispatch((0,o.Oh)(t));break}}const r=t(n),s=e.getState();switch(i){case"RELOAD_URL":case"s/SELECT_CANVAS":case"s/REC_ME":{const t=ye(),{is3D:n}=s.canvas;if(n===t.is3D?(t.updateCanvasData(s),"RELOAD_URL"===i&&t.updateView(s.canvas.view)):we(e,n),s.canvas.isHistoricalView){const{historicalDate:e,historicalTime:n,historicalCanvasSize:i}=s.canvas;t.updateHistoricalTime(e,n,i)}break}case"s/TGL_EASTER_EGG":{const t=ye(),{is3D:n}=s.canvas;n&&we(e,!t.is3D);break}case"SET_HISTORICAL_TIME":{const{historicalDate:e,historicalTime:t,historicalCanvasSize:n}=s.canvas;ye().updateHistoricalTime(e,t,n);break}case"s/CHG_TEMPLATE":case"s/TGL_OVENABLED":case"s/TGL_SMALLPXLS":case"s/REM_TEMPLATE":case"s/UPD_TEMPLATE_IMG":case"s/SET_O_OPACITY":case"REQ_BIG_CHUNK":case"PRE_LOADED_BIG_CHUNK":case"REC_BIG_CHUNK":case"REC_BIG_CHUNK_FAILURE":ye().forceNextRender=!0;break;case"s/TGL_GRID":case"ALLOW_SETTING_PXL":ye().forceNextSubrender=!0;break;case"s/TGL_HISTORICAL_VIEW":{const e=ye();e.updateView(e.view,e.view),e.forceNextRender=!0;break}case"s/SELECT_HOLD_PAINT":if(n.value){const e=ye();e.controls.holdPaintStarted?.(n.immediate)}break;case"s/SET_MOVE_U":case"s/SET_MOVE_V":case"s/SET_MOVE_W":case"s/CANCEL_MOVE":n.value||ye().storeViewInState();break;case"SET_VIEW_COORDINATES":{const e=ye();e.updateView(n.view),e.storeViewInState();break}case"SET_SCALE":{const e=ye(),[t,i]=e.view;e.updateView([t,i,n.scale],n.zoompoint),e.storeViewInState();break}case"REC_SET_PXLS":{const e=ye();e.forceNextSubrender=!0;const{coolDownSeconds:t}=n;t<0&&e&&e.controls&&e.controls.gotCoolDownDelta&&e.controls.gotCoolDownDelta(-1*t);break}}return r}))),Ae=_e;var Le,Pe=n(7294),Oe=n(743),Re=n(745),De=n(7479);function $e(e,t,n,i){Le||(Le="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Le,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Me(){let e=(0,Oe.v9)((e=>e.gui.style));if(!window.ssv.availableStyles)return null;const t=new Date,n=t.getMonth()+1,i=t.getDate();(31===i&&10===n||1===i&&11===n)&&(e="dark-spooky");const r=window.ssv.availableStyles[e];return"default"!==e&&r?$e("link",{rel:"stylesheet",type:"text/css",href:r}):null}const We=Pe.memo(Me);var ze;function Ve(e,t,n,i){ze||(ze="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ze,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const He=()=>{const[e,t,n]=(0,Oe.v9)((e=>[e.canvas.view,e.canvas.hover,e.canvas.is3D]),Oe.wU),i=(0,Oe.I0)();let o;if(t)o=t;else{const[t,i,r]=e;o=(n?[t,i,r]:[t,i]).map(Math.round)}return Ve("div",{className:"coorbox",onClick:()=>{(0,r.Z)(window.location.hash),i((0,d.h4)("Kopiert"))},role:"button",title:"Kopiere in die Zwischenablage",tabIndex:"0"},void 0,`(${o.join(", ")})`)},Ue=Pe.memo(He);var Fe=n(9583);const Ge={USERAREA:["activeTab"],CHAT:["chatChannel"]},Be=["HELP","SETTINGS","USERAREA","CHAT","CANVAS_SELECTION","ARCHIVE","REGISTER","FORGOT_PASSWORD"];function Ke(){const e=window.location.pathname.split("/")[1];return e&&Be.includes(e.toUpperCase())}function Ze(e,t){const n={...t};let i=`/${e.toLowerCase()}`;const r=Ge[e];if(r)for(let e=0;e<r.length;e+=1){const t=r[e];n[t]&&(i+=`/${encodeURIComponent(n[t])}`,delete n[t])}let o=new URLSearchParams;const s=Object.keys(n);for(let e=0;e<s.length;e+=1){const t=s[e];o.append(t,n[t])}return o=o.toString(),o&&(i+=`?${o}`),i}const je=Be;function Ye(e){return{type:"OPEN_WIN",windowType:e,title:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",args:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,fullscreen:arguments.length>3&&void 0!==arguments[3]&&arguments[3],cloneable:!(arguments.length>4&&void 0!==arguments[4])||arguments[4],xPos:arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,yPos:arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,width:arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,height:arguments.length>8&&void 0!==arguments[8]?arguments[8]:null}}function qe(e,t){return{type:"HIDE_ALL_WIN_TYPE",windowType:e,hide:t}}const Qe=(0,Pe.createContext)();function Xe(e,t,n,i,r,o){!function(e,t,n,i,r){let o,s;try{if(window.innerWidth<=604?(i=window.innerWidth,r=window.innerHeight,o=window.top.screenX,s=window.top.screenY):(o=Math.round(window.top.screenX+t),s=Math.round(window.top.screenY+n)),Number.isNaN(o)||Number.isNaN(s))throw new Error("NaN")}catch{o=0,s=0}try{return window.open(e,e,`popup=yes,width=${i},height=${r},left=${o},top=${s},toolbar=no,status=no,directories=no,menubar=no`)}catch{return null}}(Ze(e,t),n,i,r,o)}const Je=function(){const e=(0,Oe.I0)(),t=(0,Pe.useContext)(Qe);return(0,Pe.useCallback)((function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{xPos:r=null,yPos:o=null,width:s=null,height:a=null,args:l=null}=i;if("popup"===i.target)return void Xe(n,l,r,o,s,a);const{title:c=""}=i,d=!Ke();if("blank"===i.target&&d){const{cloneable:t=!0}=i;e(Ye(n.toUpperCase(),c,l,!1,t,r,o,s,a))}else if("fullscreen"===i.target&&d){const{cloneable:t=!0}=i;e(Ye(n.toUpperCase(),c,l,!0,t,r,o,s,a))}else t?t.changeType(n,c,l):window.location.href=Ze(n,l)}),[t,e])};var et,tt;function nt(e,t,n,i){tt||(tt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:tt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const it=()=>{const e=Je();return nt("div",{id:"canvasbutton",className:"actionbuttons",onClick:()=>e("CANVAS_SELECTION",{target:"fullscreen"}),role:"button",title:"Leinwand auswahl",tabIndex:-1},void 0,et||(et=nt(Fe.n6C,{})))},rt=Pe.memo(it);var ot,st,at,lt,ct;function dt(e,t,n,i){ct||(ct="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ct,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ut=()=>{const[e,t,n,i,r]=(0,Oe.v9)((e=>[e.ranks.online,e.ranks.totalPixels,e.user.name,e.gui.onlineCanvas,e.canvas.canvasId]),Oe.wU),s=(0,Oe.I0)();return dt("div",{className:"onlinebox",role:"button",tabIndex:"0",onClick:()=>s((0,o._)())},void 0,i?dt("span",{title:"Spieler auf dieser Leinwand"},void 0,e[r]||0,ot||(ot=dt(Fe.Xws,{})),st||(st=dt(Fe.n6C,{}))):dt("span",{title:"Spieler insgesamt"},void 0,e.total,at||(at=dt(Fe.Xws,{})))," ",null!=n&&dt("span",{title:"Pixels placed"},void 0,(0,k.D$)(t)," ",lt||(lt=dt(Fe._TT,{}))))},ht=Pe.memo(ut);var ft,pt,mt=n(5434);function vt(e,t,n,i){pt||(pt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:pt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gt=e=>[e.windows.windows.some((t=>"CHAT"===t.windowType&&!1===t.hidden&&(e.windows.showWindows||t.fullscreen))),e.windows.windows.some((e=>"CHAT"===e.windowType&&!0===e.hidden))&&e.windows.showWindows],wt=()=>{const[e,t]=(0,Pe.useState)(!1),n=(0,Oe.I0)(),[i,r]=(0,Oe.v9)(gt,Oe.wU),o=(0,Oe.v9)((e=>e.gui.chatNotify)),s=(0,Oe.v9)((e=>e.chat.channels)),[a,l]=(0,Oe.v9)((e=>[e.chatRead.unread,e.chatRead.mute]),Oe.wU);return(0,Pe.useEffect)((()=>{if(!o||i)return void t(!1);const e=Object.keys(s);let n=0;for(;n<e.length;){const i=e[n];if(0!==s[i][1]&&a[i]&&!l.includes(i)){t(!0);break}n+=1}n===e.length&&t(!1)}),[o,i,s,a,l]),vt("div",{id:"chatbutton",className:"actionbuttons",onClick:()=>{n(i?qe("CHAT",!0):r?qe("CHAT",!1):Ye("CHAT","",null,!1,!0,window.innerWidth-350-62,window.innerHeight-350-64,350,350))},role:"button",title:i?"Schließe Kommentarsektion":"Öffne Kommentarsektion",tabIndex:0},void 0,e&&vt("div",{style:{position:"fixed",bottom:27,right:62,top:"unset"},className:"chnunread"},void 0,"⦿"),ft||(ft=vt(mt.Rlc,{})))},yt=Pe.memo(wt);var bt,St;function kt(e,t,n,i){St||(St="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:St,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Et=()=>{const e=Je();return kt("div",{id:"helpbutton",className:"actionbuttons",onClick:()=>e("HELP",{target:"fullscreen"}),role:"button",title:"Hilfe",tabIndex:-1},void 0,bt||(bt=kt(Fe.g_g,{})))},Ct=Pe.memo(Et);var Tt,It;function xt(e,t,n,i){It||(It="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:It,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nt=()=>{const e=Je();return xt("div",{id:"settingsbutton",className:"actionbuttons",onClick:()=>e("SETTINGS",{target:"fullscreen"}),role:"button",title:"Einstellungen",tabIndex:-1},void 0,Tt||(Tt=xt(Fe.p4t,{})))},_t=Pe.memo(Nt);var At,Lt;function Pt(e,t,n,i){Lt||(Lt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Lt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ot=()=>{const e=Je();return Pt("div",{id:"loginbutton",className:"actionbuttons",onClick:()=>e("USERAREA",{target:"fullscreen"}),role:"button",title:"Spielerbereich",tabIndex:-1},void 0,At||(At=Pt(mt.Vyx,{})))},Rt=Pe.memo(Ot);var Dt,$t,Mt=n(5823),Wt=n.n(Mt);function zt(e,t,n,i){$t||($t="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$t,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vt=()=>{const e=(0,Oe.v9)((e=>e.canvas.view));return zt("div",{id:"downloadbutton",className:"actionbuttons",role:"button",title:"Erstelle eine Bildschirmaufnahme",tabIndex:0,onClick:()=>function(e){const t=ye().getViewport();if(!t)return;const[n,i]=e.map(Math.round),r=`pixelplanet-${n}-${i}.png`;t.toBlob((e=>Wt()(e,r)))}(e)},void 0,Dt||(Dt=zt(mt.tEr,{})))},Ht=Pe.memo(Vt);var Ut,Ft,Gt,Bt,Kt;function Zt(e,t,n,i){Kt||(Kt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Kt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const jt=()=>{const[e,t]=(0,Pe.useState)(!1),n=(0,Oe.v9)((e=>e.gui.menuOpen));return(0,Pe.useEffect)((()=>{n&&setTimeout((()=>t(!0)),10)}),[n]),(e||n)&&Zt("div",{className:n&&e?"menu show":"menu",onTransitionEnd:()=>{n||t(!1)}},void 0,Ut||(Ut=Zt(_t,{})),Ft||(Ft=Zt(Rt,{})),Gt||(Gt=Zt(Ht,{})),Bt||(Bt=Zt(Ct,{})))},Yt=Pe.memo(jt);var qt;function Qt(e,t,n,i){qt||(qt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:qt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xt=()=>{const e=(0,Oe.v9)((e=>e.user.coolDown));return Qt("div",{className:e&&e>=300?"cooldownbox show":"cooldownbox"},void 0,e&&(0,k.VL)(e,!0))},Jt=Pe.memo(Xt);var en;function tn(e,t,n,i){en||(en="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:en,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nn=()=>{const[e,t]=(0,Pe.useState)("notifybox"),n=(0,Oe.v9)((e=>e.user.notification));return(0,Pe.useEffect)((()=>{if(n){let i="notifybox";n&&"string"!=typeof n&&(i+=n>0?" green":" red"),i!==e&&t(i)}}),[n,e]),tn("div",{className:n?`${e} show`:e},void 0,n)},rn=Pe.memo(nn);var on,sn;function an(e,t,n,i){sn||(sn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:sn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ln=()=>{const[e,t,n,i]=(0,Oe.v9)((e=>[e.canvas.canvasId,e.canvas.canvasIdent,e.canvas.canvasSize,e.canvas.view]),Oe.wU);return an("div",{role:"button",tabIndex:-1,id:"globebutton",title:"Globus Ansicht",className:"actionbuttons",onClick:()=>function(e,t,n,i){const[r,o]=i.map(Math.round);window.location.href=`globe#${t},${e},${n},${r},${o}`}(e,t,n,i)},void 0,on||(on=an(mt.gb5,{})))},cn=Pe.memo(ln);var dn,un;function hn(e,t,n,i){un||(un="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:un,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fn=()=>{const e=(0,Oe.v9)((e=>e.gui.paletteOpen)),[t,n]=(0,Oe.v9)((e=>[e.canvas.palette,e.canvas.selectedColor]),Oe.wU),i=(0,Oe.I0)();return hn("div",{id:"palselbutton",className:"actionbuttons"+(e?" pressed":""),style:{color:t.isDark(n)?"white":"black",backgroundColor:t.colors[n]},role:"button",title:e?"Schließe Palette":"Öffne Palette",tabIndex:0,onClick:()=>i((0,o.KB)())},void 0,dn||(dn=hn(mt.Zox,{})))},pn=Pe.memo(fn);var mn=n(106);const vn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600;const[i,r]=(0,Pe.useState)(null),o=(0,Pe.useRef)(),s=(0,Pe.useCallback)((e=>{e.preventDefault(),r(setTimeout((()=>{t(e),r(null)}),n))}),[t,n]),a=(0,Pe.useCallback)((t=>{t.preventDefault(),i&&(clearTimeout(i),e&&e(t),r(null))}),[i,e]),l=(0,Pe.useCallback)((e=>{e.preventDefault(),clearTimeout(i),r(null)}),[i]);return(0,Pe.useCallback)((e=>{if(e)o.current=e,e.addEventListener("mousedown",s,{passive:!1}),e.addEventListener("mouseup",a,{passive:!1}),e.addEventListener("touchstart",s,{passive:!1}),e.addEventListener("touchend",a,{passive:!1}),e.addEventListener("mouseleave",l,{passive:!1}),e.addEventListener("touchcancel",l,{passive:!1});else if(o.current){const e=o.current;e.removeEventListener("mousedown",s,{passive:!1}),e.removeEventListener("mouseup",a,{passive:!1}),e.removeEventListener("touchstart",s,{passive:!1}),e.removeEventListener("touchend",a,{passive:!1}),e.removeEventListener("mouseleave",l,{passive:!1}),e.removeEventListener("touchcancel",l,{passive:!1})}}),[l,s,a])};var gn,wn,yn;function bn(e,t,n,i){yn||(yn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:yn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Sn=()=>{const[e,t]=(0,Oe.v9)((e=>[e.gui.holdPaint,e.gui.showMvmCtrls]),Oe.wU),n=(0,Oe.I0)(),i=(0,Pe.useCallback)((()=>{let t;switch(e){case c.EQ.OFF:case c.EQ.PENCIL:if(window.ssv?.backupurl){t=c.EQ.HISTORY,n((0,d.h4)("History Pencil ON"));break}case c.EQ.HISTORY:t=c.EQ.OVERLAY,n((0,d.h4)("Overlay Pencil ON"));break;default:t=e?c.EQ.OFF:c.EQ.PENCIL}n((0,o.UW)(t))}),[e,n]),r=(0,Pe.useCallback)((()=>{let t;t=e?c.EQ.OFF:c.EQ.PENCIL,n((0,o.UW)(t))}),[e,n]),s=vn(r,i);let a="actionbuttons",l="Pinsel einschalten";switch(e){case c.EQ.PENCIL:a+=" ppencil pressed",l="Deaktiviere Pinsel";break;case c.EQ.HISTORY:a+=" phistory pressed",l="Historischen Pinsel ausschalten";break;case c.EQ.OVERLAY:a+=" poverlay pressed",l="Vorlagen Pinsel ausschalten"}return Pe.createElement("div",{id:"pencilbutton",className:a,style:{bottom:e||t?180:98},role:"button",title:l,tabIndex:-1,ref:s},e?gn||(gn=bn(mn.nxI,{})):wn||(wn=bn(mn.Lik,{})))},kn=Pe.memo(Sn);var En,Cn,Tn,In,xn,Nn,_n,An,Ln,Pn=n(225),On=n(130);function Rn(e,t,n,i){Ln||(Ln="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ln,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Dn=()=>{const[e,t]=(0,Pe.useState)(!1),[n,i]=(0,Oe.v9)(On.x,Oe.wU),r=(0,Oe.I0)();(0,Pe.useEffect)((()=>{i&&window.setTimeout((()=>t(!0)),10)}),[i]);const s=(0,Pe.useCallback)((e=>{if(!e)return;const t=e=>{switch(e.preventDefault(),e.currentTarget.id){case"forwardbtn":r((0,o.mx)(-1));break;case"backwardbtn":r((0,o.mx)(1));break;case"leftbtn":r((0,o.mW)(-1));break;case"rightbtn":r((0,o.mW)(1));break;case"upbtn":r((0,o.WW)(-1));break;case"downbtn":r((0,o.WW)(1))}},n=e=>{switch(e.preventDefault(),e.currentTarget.id){case"forwardbtn":case"backwardbtn":r((0,o.mx)(0));break;case"leftbtn":case"rightbtn":r((0,o.mW)(0));break;case"upbtn":case"downbtn":r((0,o.WW)(0))}},i=e=>{e.preventDefault(),r((0,o.OJ)())};e.addEventListener("touchstart",t,{passive:!1}),e.addEventListener("mousedown",t,{passive:!1}),e.addEventListener("touchend",n,{passive:!1}),e.addEventListener("mouseup",n,{passive:!1}),e.addEventListener("mouseleave",i,{passive:!1}),e.addEventListener("touchcancel",i,{passive:!1})}),[r]);return(e||i)&&Rn("div",{id:"mvmctrls",className:e&&i?"show":"",onTransitionEnd:()=>!i&&t(!1)},void 0,Pe.createElement("div",{className:"actionbuttons",id:"forwardbtn",role:"button",key:"forward",tabIndex:0,style:{left:57,bottom:139},ref:s},En||(En=Rn(Pn.x8Z,{}))),Pe.createElement("div",{className:"actionbuttons",id:"backwardbtn",role:"button",key:"backward",tabIndex:0,style:{left:57,bottom:98},ref:s},Cn||(Cn=Rn(Pn._tY,{}))),Pe.createElement("div",{className:"actionbuttons",id:"leftbtn",role:"button",key:"left",tabIndex:0,style:{left:16,bottom:98},ref:s},Tn||(Tn=Rn(Pn.uMh,{}))),Pe.createElement("div",{className:"actionbuttons",id:"rightbtn",role:"button",key:"right",tabIndex:0,style:{left:98,bottom:98},ref:s},In||(In=Rn(Pn.aiH,{}))),Pe.createElement("div",{className:"actionbuttons",id:"upbtn",role:"button",key:"up",tabIndex:0,style:{left:16,bottom:139},ref:s},n?xn||(xn=Rn(Pn.V6o,{})):Nn||(Nn=Rn(Pn.owN,{}))),Pe.createElement("div",{className:"actionbuttons",id:"downbtn",role:"button",key:"down",tabIndex:0,style:{left:98,bottom:139},ref:s},n?_n||(_n=Rn(Pn.Hgk,{})):An||(An=Rn(Pn.svp,{}))))};var $n;function Mn(e,t,n,i){$n||($n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$n,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wn=()=>{const[e,t]=(0,Pe.useState)(!1),[n,i,r,s,a,l]=(0,Oe.v9)((e=>[e.gui.paletteOpen,e.gui.compactPalette,e.canvas.palette.colors,e.canvas.clrIgnore,e.canvas.selectedColor,e.user.userlvl]),Oe.wU),c=(0,Oe.I0)();(0,Pe.useEffect)((()=>{window.setTimeout((()=>{n&&t(!0)}),10)}),[n]);const d=0===l?s:0,[u,h]=function(e,t,n,i,r){const{width:o,height:s}=t,a=n.length-i;let l,c,d;o<=300||s<=432?(c=24,d=5,l="row"):a>30||r?(c=28,d=5,l="row"):(c=24,d=s<801?2:1,l="column");const u=Math.ceil(a/d)*c,h=c*d;return e?[{display:"flex",flexWrap:"wrap",textAlign:"center",lineHeight:0,height:u,width:h,flexDirection:l,visibility:"visible"},{display:"block",width:c,height:c,margin:0,padding:0,cursor:"pointer",visibility:"visible"}]:[{display:"flex",flexWrap:"wrap",textAlign:"center",lineHeight:0,height:0,width:h,flexDirection:l,visibility:"hidden"},{display:"block",height:0,width:c,margin:0,padding:0,visibility:"hidden"}]}(e&&n,function(){const[e,t]=(0,Pe.useState)({width:window.innerWidth,height:window.innerHeight});return(0,Pe.useEffect)((()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}(),r,d,i);return(e||n)&&Mn("div",{id:"palettebox",style:u,onTransitionEnd:()=>{n||t(!1)}},void 0,r.slice(d).map(((e,t)=>Mn("span",{style:{backgroundColor:e,...h},role:"button",tabIndex:0,"aria-label":`color ${t+d}`,className:a===t+d?"selected":"unselected",color:e,onClick:()=>c((0,o.Oh)(t+d))},`${e}-${t+d}`))))},zn=Pe.memo(Wn);var Vn,Hn,Un=n(155);function Fn(e,t,n,i){Hn||(Hn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Hn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Gn={width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},Bn=e=>{let{autoload:t,width:n,setLegit:i}=e;const[r,o]=(0,Pe.useState)({}),[s,a]=(0,Pe.useState)([]),[l,c]=(0,Pe.useState)(!1),d=async()=>{l&&c(!1);const e=await async function(){const e=`${G.Fx}/captcha.svg`,t=await fetch(e,{cache:"no-cache"});if(t.ok){const e=t.headers.get("captcha-id"),n=await t.blob();return[URL.createObjectURL(n),e]}return null}();if(!e)return void a(["Konnte Captcha nicht laden"]);const[t,n]=e;o({url:t,id:n})};(0,Pe.useEffect)((()=>{t&&d()}),[]);const u=n||100;return Pe.createElement(Pe.Fragment,null,Fn("p",{},void 0,"Gebe die Zeichen aus dem folgenden Bild ein:"," ",Fn("span",{style:{fontSize:11}},void 0,"(","Tipp: Groß- und Kleinschreibung wird nicht berücksichtigt; l und I sind dasselbe",")")),s.map((e=>Fn("p",{className:"errormessage"},e,Fn("span",{},void 0,"Fehler"),": ",e))),Fn("div",{style:{width:`${u}%`,paddingTop:`${Math.floor(.6*u)}%`,position:"relative",display:"inline-block",backgroundColor:"#e0e0e0"}},void 0,r.url?Fn("img",{style:{...Gn,opacity:l?1:0,transition:"100ms"},src:r.url,alt:"CAPTCHA",onLoad:()=>{a([]),c(!0)},onError:()=>{a(["Konnte Captcha nicht laden"])}}):Fn("span",{style:Gn,role:"button",tabIndex:0,title:"Lade Captcha",className:"modallink",onClick:d,onKeyPress:d},void 0,"Klicke um Captcha zu laden")),Fn("p",{},void 0,"Unlesbar? Hier neu laden:"," ",Fn("span",{role:"button",tabIndex:-1,title:"Neu laden",className:"modallink",style:{fontSize:28},onClick:d},void 0,Vn||(Vn=Fn(Un.q9I,{})))),Fn("input",{name:"captcha",placeholder:"Zeichen eingeben",type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onChange:()=>i&&i(!0),autoFocus:t,style:{width:"6em",fontSize:21,margin:5}}),Fn("input",{type:"hidden",name:"captchaid",value:r.id||"0"}))},Kn=Pe.memo(Bn);var Zn;function jn(e,t,n,i){Zn||(Zn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Zn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yn=e=>{let{close:t}=e;const[n,i]=(0,Pe.useState)(null),[r,o]=(0,Pe.useState)(!1),[s,a]=(0,Pe.useState)(!1),[l,c]=(0,Pe.useState)(Date.now());return jn("form",{onSubmit:async e=>{e.preventDefault();const n=e.target.captcha.value.slice(0,6);if(r||!n)return;s||await(0,G.jK)(2);const a=e.target.captchaid.value;let l;try{switch(o(!0),await B.sendCaptchaSolution(n,a)){case 0:return void t();case 1:l="Du hast zu lange gebraucht, versuche es noch einmal.";break;case 2:l="Captcha Text ist falsch";break;case 3:l="Kein oder falscher Captcha Text";break;case 4:l="Keine Captcha-Id angegeben";break;default:l="Unbekannter Captcha-Fehler"}}catch(e){l=`${e.message}`}o(!1),c(Date.now()),i(l)}},void 0,n&&jn("p",{className:"errormessage"},n,jn("span",{},void 0,"Fehler"),": ",n),jn(Kn,{autoload:!0,setLegit:a},l),jn("p",{},void 0,jn("button",{type:"button",onClick:t},void 0,"Abbrechen")," ",jn("button",{type:"submit"},void 0,r?"...":"Senden")))},qn=Pe.memo(Yn);var Qn,Xn=n(389);function Jn(e,t,n,i){Qn||(Qn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Qn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ei=e=>{let{close:t}=e;const[n,i]=(0,Pe.useState)([]),[r,o]=(0,Pe.useState)(null),[s,a]=(0,Pe.useState)(null),[l,c]=(0,Pe.useState)(0),[d,u]=(0,Pe.useState)(null),[h,f]=(0,Pe.useState)(!1),p=Je(),m=async()=>{if(h)return;f(!0),i([]);const e=await(0,G.Es)();if(f(!1),e.errors)return void i(e.errors);const{sleft:t,mod:n,reason:r}=e;if(t){const e=new Date(Date.now()+1e3*t);c(t),u(e.toLocaleString())}a(n),o(r)};return(0,Xn.Z)((()=>{l>0&&(c(l-1),1===l&&m())}),1e3),Jn("div",{style:{userSelect:"text"}},void 0,Jn("p",{},void 0,"Du bist gebannt. Wenn du glaubst, dass dies ein Irrtum war, sehe in die ",Jn("span",{role:"button",tabIndex:0,className:"modallink",onClick:()=>{p("HELP",{target:"fullscreen"}),t()}},void 0,"Hilfe")," um zu erfahren, wie du Einspruch einlegen kannst."),n.map((e=>Jn("p",{className:"errormessage"},e,Jn("span",{},void 0,"Fehler"),": ",e))),r&&Jn(Pe.Fragment,{},"rea",Jn("h3",{},void 0,"Grund",":"),Jn("p",{},void 0,r)),s&&Jn(Pe.Fragment,{},"mod",Jn("h3",{},void 0,"Von Moderator",":"),Jn("p",{},void 0,s)),l>0&&Jn(Pe.Fragment,{},"exp",Jn("h3",{},void 0,"Dauer",":"),Jn("p",{},void 0,"Dein ban dauert bis ",Jn("span",{style:{fontWeight:"bold"}},void 0,d)," was noch so lange dauert: ",Jn("span",{style:{fontWeight:"bold"}},void 0,(0,k.gx)(l)))),l<0&&Jn(Pe.Fragment,{},"nb",Jn("h3",{},void 0,"Wieder entbannt",":"),Jn("p",{},void 0,"Nun da du diese Nachricht gelesen hast, darfst du wieder spielen.")),Jn("p",{},void 0,!r&&Jn(Pe.Fragment,{},"btnr",Jn("button",{type:"button",style:{fontWeight:"bold",animation:"glowing 1300ms infinite"},onClick:m},void 0,h?"...":"Wieso?")," "),Jn("button",{type:"submit",onClick:t},void 0,"OK")))},ti=Pe.memo(ei);var ni;function ii(e,t,n,i){ni||(ni="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ni,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ri=e=>{let{show:t,onClick:n,z:i}=e;const[r,o]=(0,Pe.useState)(!1);return(0,Pe.useEffect)((()=>{t&&window.setTimeout((()=>{o(!0)}),10)}),[t]),r||t?ii("div",{className:t&&r?"overlay show":"overlay",style:i?{zIndex:i}:{},onTransitionEnd:()=>{t||o(!1)},tabIndex:-1,onClick:n}):null},oi=Pe.memo(ri);var si;function ai(e,t,n,i){si||(si="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:si,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const li=()=>{const[e,t]=(0,Pe.useState)(!1),{open:n,alertType:i,title:r,message:s,btn:a}=(0,Oe.v9)((e=>e.alert)),l=(0,Oe.I0)(),c=(0,Pe.useCallback)((()=>{l((0,o.M6)())}),[l]);(0,Pe.useEffect)((()=>{n&&window.setTimeout((()=>{t(!0)}),10)}),[n]);let d=null;switch(i){case"captcha":d=qn;break;case"ban":d=ti}if(!e&&!n)return null;const u=n&&e;return Pe.createElement(Pe.Fragment,null,ai(oi,{z:6,show:u,onClick:c}),ai("div",{className:u?"Alert show":"Alert",onTransitionEnd:()=>{n||t(!1)}},void 0,ai("h2",{},void 0,r),s&&ai("p",{},void 0,s),d?ai(d,{close:c}):ai("button",{type:"button",onClick:c},void 0,a)),")")},ci=Pe.memo(li);var di;function ui(e,t,n,i){di||(di="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:di,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function hi(e){return e?`${e.substring(0,2)}:${e.substring(2)}`:""}const fi=()=>{const e=(0,Pe.useRef)(null),[t,n]=(0,Pe.useState)(!1),[i,r]=(0,Pe.useState)([]),[s]=(0,Pe.useState)((0,k.x2)()),[a,l,c,d,u]=(0,Oe.v9)((e=>[e.canvas.canvasId,e.canvas.canvasStartDate,e.canvas.canvasEndDate,e.canvas.historicalDate,e.canvas.historicalTime]),Oe.wU),h=(0,Oe.I0)(),f=(0,Pe.useCallback)(((e,t)=>{const n=t.substring(0,2)+t.substring(3,5),i=(0,k.UW)(e);h((0,o.on)(i,n))}),[h]),p=(0,Pe.useCallback)((async e=>{if(t)return;n(!0);const i=e.target.value,o=await(0,G.No)(i,a);o&&o.length&&(r(o),f(i,o[0])),n(!1)}),[t,a,f]),m=(0,Pe.useCallback)((async t=>{if(!(i.length&&e&&e.current&&e.current.value))return;let o=i,s=i.indexOf(hi(u))+t,l=e.current.value;if(s>=i.length||s<0){if(n(!0),s<0?e.current.stepDown(1):e.current.stepUp(1),l=e.current.value,o=await(0,G.No)(l,a),n(!1),!o||!o.length)return;s=s<0?o.length-1:0}r(o),f(l,o[s])}),[u,i,a,f]),v=(g=d)?`${g.substring(0,4)}-${g.substring(4,6)}-${g.substring(6)}`:"";var g;const w=hi(u);return ui("div",{id:"historyselect"},void 0,Pe.createElement("input",{type:"date",pattern:"\\d{4}-\\d{2}-\\d{2}",key:"dateinput",value:v,min:l,max:c||s,ref:e,onChange:p}),ui("div",{},"timeselcon",!!i.length&&u&&!t&&ui("div",{},"timesel",ui("button",{type:"button",className:"hsar",onClick:()=>m(-1)},void 0,"←"),ui("select",{value:w,onChange:e=>f(v,e.target.value)},void 0,i.map((e=>ui("option",{value:e},e,e)))),ui("button",{type:"button",className:"hsar",onClick:()=>m(1)},void 0,"→")),t&&ui("p",{},void 0,"Lädt..."),!i.length&&!t&&ui("p",{},void 0,"Datum auswählen")))},pi=Pe.memo(fi);var mi,vi,gi,wi,yi,bi,Si,ki,Ei,Ci;function Ti(e,t,n,i){Ci||(Ci="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ci,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ii=()=>{const[e,t,n]=(0,Oe.v9)((e=>[e.canvas.isHistoricalView,e.canvas.is3D,e.user.isOnMobile]),Oe.wU);return Pe.createElement(Pe.Fragment,null,mi||(mi=Ti(ci,{})),vi||(vi=Ti(Dn,{})),e?gi||(gi=Ti(pi,{})):Pe.createElement(Pe.Fragment,null,wi||(wi=Ti(pn,{})),yi||(yi=Ti(zn,{})),!t&&(bi||(bi=Ti(cn,{}))),!t&&n&&(Si||(Si=Ti(kn,{}))),ki||(ki=Ti(Jt,{}))),Ei||(Ei=Ti(rn,{})))},xi=Pe.memo(Ii);var Ni,_i,Ai;function Li(e,t,n,i){Ai||(Ai="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ai,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pi=()=>{const e=(0,Oe.v9)((e=>e.gui.menuOpen)),t=(0,Oe.I0)();return Li("div",{id:"menubutton",className:"actionbuttons"+(e?" pressed":""),role:"button",title:e?"Schließe Menü":"Öffne Menü",tabIndex:-1,onClick:()=>t((0,o.vN)())},void 0,e?Ni||(Ni=Li(mt.Faw,{})):_i||(_i=Li(mt.Yc6,{})))},Oi=Pe.memo(Pi);var Ri=n(7516),Di=n(573);const $i=e=>e.windows.windows,Mi=e=>e.windows.showWindows,Wi=(0,Di.P1)($i,Mi,((e,t)=>[e.some((e=>e.fullscreen&&!e.hidden))||t,e.some((e=>e.fullscreen&&e.open&&!e.hidden))])),zi=(0,Di.P1)($i,Mi,((e,t)=>(t||(e=e.filter((e=>e.fullscreen))),e.map((e=>e.windowId))))),Vi=function(e,t,n){const i=(0,Pe.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),t&&t();let{clientX:i,clientY:r}=e.touches?e.touches[0]:e;const o=e=>{e.preventDefault(),e.stopPropagation();const{clientX:t,clientY:o}=e.touches?e.touches[0]:e;n(t-i,o-r),i=t,r=o};document.addEventListener("mousemove",o),document.addEventListener("touchmove",o);const s=e=>{e.preventDefault(),e.stopPropagation(),document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",s),document.removeEventListener("touchcancel",s),document.removeEventListener("touchend",s)};document.addEventListener("mouseup",s),document.addEventListener("touchcancel",s),document.addEventListener("touchend",s)}),[t,n]);(0,Pe.useEffect)((()=>{const t=e.current;if(t)return t.addEventListener("mousedown",i,{passive:!1}),t.addEventListener("touchstart",i,{passive:!1}),()=>{t.removeEventListener("mousedown",i),t.removeEventListener("touchstart",i)}}),[e,i])};var Hi,Ui=n(2585);function Fi(e,t,n,i){Hi||(Hi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Hi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Gi=()=>{const[e,t]=(0,Pe.useState)(""),[n,i]=(0,Pe.useState)(!1),o=(0,Oe.I0)();return Fi("p",{},void 0,Fi("input",{style:{display:"inline-block",width:"100%",maxWidth:"18em"},readOnly:!0,value:e}),e?Fi("button",{type:"button",onClick:()=>{(0,r.Z)(e),o((0,d.h4)("Kopiert"))}},"cobtn","Kopiere"):Fi("button",{type:"button",onClick:async()=>{i(!0);const e=await(0,G.JL)();e.iid&&t(e.iid),i(!1)}},"subtn",n?"...":"Gib IID"))},Bi=Pe.memo(Gi);var Ki,Zi,ji,Yi,qi,Qi,Xi,Ji,er,tr,nr,ir,rr,or,sr,ar,lr,cr,dr,ur,hr,fr,pr,mr,vr,gr,wr,yr,br,Sr,kr,Er,Cr,Tr,Ir,xr,Nr,_r,Ar,Lr,Pr,Or;function Rr(e,t,n,i){Or||(Or="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Or,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Dr,$r,Mr=n(888);function Wr(e,t,n,i){$r||($r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zr=Pe.memo((e=>{let{title:t,keyBind:n,value:i,onToggle:r,children:o,deactivated:s}=e;return Wr("div",{className:"setitem"},void 0,Wr("div",{className:"setrow"},void 0,Wr("h3",{className:"settitle"},void 0,t," ",n&&Wr("kbd",{},void 0,n)),Wr(Mr.Z,{checked:i,onChange:r,disabled:s})),Wr("div",{className:"modaldesc"},void 0,o),Dr||(Dr=Wr("div",{className:"modaldivider"})))}),((e,t)=>e.value===t.value));var Vr;function Hr(e,t,n,i){Vr||(Vr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Vr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ur=function(){const[e,t]=(0,Pe.useState)(window.ssv.lang),[n,i]=(0,Pe.useState)("xx");return(0,Pe.useEffect)((()=>{const{langs:t}=window.ssv;for(let n=0;n<t.length;n+=1){const[r,o]=t[n];if(r===e)return void i(o)}}),[e]),navigator.cookieEnabled?Hr("div",{style:{textAlign:"right"}},void 0,Hr("span",{},void 0,Hr("select",{value:e,onChange:e=>{const n=e.target;t(n.options[n.selectedIndex].value)}},void 0,window.ssv.langs.map((e=>{let[t]=e;return Hr("option",{value:t},t,t.toUpperCase())})))),"  ",Hr("span",{},void 0,Hr("img",{style:{height:"1em",imageRendering:"crisp-edges"},alt:"",src:`/cf/${n}.gif`})),Hr("button",{type:"submit",style:{display:"block",margin:5},onClick:()=>{const t=new Date;t.setTime(t.getTime()+24*c.vc);let{hostname:n}=window.location;n=n.lastIndexOf(".")!==n.indexOf(".")?n.slice(n.indexOf(".")):`.${n}`,document.cookie=`plang=${e};expires=${t.toUTCString()};path=/;domain=${n}`,window.location.reload()}},void 0,"Speichern")):null};var Fr;function Gr(e,t,n,i){Fr||(Fr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Fr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Br=e=>{let{enabled:t,title:n,canvasId:i,x:r,y:s,width:a,height:c,imageId:d,startEditing:u}=e;const h=(0,Pe.useRef)(),f=(0,Oe.v9)((e=>e.canvas.canvases)),p=(0,Oe.I0)();return(0,Pe.useEffect)((()=>{(async()=>{if(!d||!h.current)return;const e=await X.getTemplate(d);if(!e)return;const t=await createImageBitmap(e);h.current.getContext("bitmaprenderer").transferFromImageBitmap(t),t.close()})()}),[d]),Gr("div",{className:t?"tmpitm":"tmpitm disabled",style:{cursor:"pointer"},onClick:()=>p(l(n,{enabled:!t}))},void 0,Gr("div",{className:"tmpitm-preview"},void 0,Pe.createElement("canvas",{className:"tmpitm-img",ref:h,key:"showimg",width:a,height:c})),Gr("div",{className:"tmpitm-desc"},void 0,Gr("h4",{},void 0,n),Gr("p",{},void 0,"Leinwand",": ",Gr("span",{},void 0,f[i]?.title)),Gr("p",{},void 0,"Koordinaten",": ",Gr("span",{},void 0,`${r},${s}`)),Gr("p",{},void 0,"Dimensionen",": ",Gr("span",{},void 0,`${a} x ${c}`))),Gr("div",{className:"tmpitm-actions"},void 0,Gr("button",{onClick:e=>{e.stopPropagation(),u(n)},type:"button"},void 0,"Bearbeiten"),Gr("button",{onClick:e=>{e.stopPropagation(),p((0,o.SC)(i)),p((0,o.w5)([r+a/2,s+c/2]))},type:"button"},void 0,"Gehe zu")))},Kr=Pe.memo(Br);var Zr;function jr(e,t,n,i){Zr||(Zr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Zr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yr=e=>{let{title:t,canvasId:n,x:i,y:r,imageId:o,stopEditing:s}=e;const[a]=(0,Pe.useMemo)((()=>[Number.isNaN(parseInt(i,10))||Number.isNaN(parseInt(r,10))?null:[i,r]]),[i,r]),[l,c]=(0,Pe.useState)(a),[d,u]=(0,Pe.useState)(null),[h,f]=(0,Pe.useState)(t||""),[p,m]=(0,Pe.useState)(null),[v,g]=(0,Pe.useState)(!0),w=(0,Pe.useRef)(),y=(0,Pe.useRef)(),[b,S,E]=(0,Oe.v9)((e=>[e.canvas.canvasId,e.canvas.canvases,e.templates.list]),Oe.wU),[C,T]=(0,Pe.useState)(n??b);(0,Pe.useEffect)((()=>{(async()=>{if(!o||!w.current)return;const e=await X.getTemplate(o);if(!e)return;const t=await createImageBitmap(e),n=w.current,{width:i,height:r}=t;n.width=i,n.height=r,n.getContext("bitmaprenderer").transferFromImageBitmap(t),u([i,r]),t.close()})()}),[o]),(0,Pe.useEffect)((()=>{p&&w.current&&(async()=>{const e=await createImageBitmap(p),t=w.current,{width:n,height:i}=e;t.width=n,t.height=i,t.getContext("bitmaprenderer").transferFromImageBitmap(e),u([n,i]),e.close()})()}),[p]);const I=w.current&&(p||o)&&v&&l&&h&&d;return jr("div",{className:"tmpitm"},void 0,jr("div",{className:"tmpitm-preview"},void 0,jr("div",{style:{width:"100%",height:"100%"}},void 0,Pe.createElement("canvas",{className:"tmpitm-img",ref:w,key:"editimg",style:{opacity:.4}})),jr("div",{className:"centered-on-img modallink",onClick:()=>y.current?.click()},void 0,"Datei auswählen"),Pe.createElement("input",{type:"file",key:"hinpt",accept:"image/*",ref:y,style:{display:"none"},onChange:e=>{u(null),m(e.target.files?.[0])}})),jr("div",{className:"tmpitm-desc"},void 0,jr("h4",{},void 0,jr("input",{value:h,style:{width:"10em"},type:"text",onChange:e=>{const t=e.target.value;g(!E.some((e=>e.title===t))),f(e.target.value)},placeholder:"Vorlagenname"})),jr("p",{},void 0,"Leinwand",": ",jr("span",{},void 0,jr("select",{value:C,onChange:e=>{const t=e.target;T(t.options[t.selectedIndex].value)}},void 0,Object.keys(S).filter((e=>!S[e].v&&!S[e].ed)).map((e=>jr("option",{value:e},e,S[e].title)))))),jr("p",{},void 0,"Koordinaten",": ",jr("span",{},void 0,jr("input",{type:"text",defaultValue:l&&l.join("_"),style:{display:"inline-block",maxWidth:"8em"},placeholder:"X_Y or URL",onChange:e=>{const t=(0,k._I)(e.target.value.trim());t&&(e.target.value=t.join("_")),c(t)}}))),jr("p",{},void 0,"Dimensionen",": ",jr("span",{},void 0,d?d.join(" x "):"N/A"))),jr("div",{className:"tmpitm-actions"},void 0,t&&jr("button",{onClick:()=>{s(t),X.deleteTemplate(t)},type:"button"},void 0,"Löschen"),jr("button",{onClick:()=>s(h),type:"button"},void 0,"Abbrechen"),jr("button",{disabled:!I,onClick:async()=>{if(!I)return;const[e,a]=l;t?(p&&o&&await X.updateFile(o,p),!t||t===h&&i===e&&r===a&&n===C||X.changeTemplate(t,{title:h,canvasId:C,x:e,y:a})):await X.addFile(p,h,C,e,a),s(t)},type:"button"},void 0,"Speichern")))},qr=Pe.memo(Yr);var Qr,Xr;function Jr(e,t,n,i){Xr||(Xr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Xr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eo=()=>{const[e,t]=(0,Pe.useState)(!1),[n,i,r,o,s,a]=(0,Oe.v9)((e=>[e.templates.list,e.templates.ovEnabled,e.templates.oSmallPxls,e.templates.oOpacity,e.templates.oRightShift,e.user.isOnMobile]),Oe.wU),[l,c]=(0,Pe.useState)([]),d=(0,Pe.useCallback)((()=>t(!1)),[]),u=(0,Pe.useRef)(),h=(0,Oe.I0)(),f=(0,Pe.useCallback)((e=>{const t=n.findIndex((t=>t.title===e)),i=l.indexOf(t);c(-1===i?[...l,t]:l.toSpliced(i,1))}),[n,l]);return Pe.createElement(Pe.Fragment,null,Jr("h2",{},void 0,"Vorlagen"),Jr("p",{},void 0,"Bist du es leid, immer nur eine Farbe zu spammen? Willst du stattdessen Kunst zeichnen, aber Pixel von einem Bild zu zählen ist zu anstrengen? Vorlagen können dir hier aushelfen! Vorlagen können als Overlay angezeigt werden, über die du zeichnen kannst. Ein Pixel in der Vorlage, soll ein Pixel auf der Leinwand repräsentieren."),Jr(zr,{title:"Overlay einschalten",keyBind:"T",value:i,onToggle:()=>h({type:"s/TGL_OVENABLED"})},void 0,"Zeige Vorlagen als Overlay über der Leinwand."),Jr(zr,{title:"Klein-Pixel Zoom",value:r,onToggle:()=>h({type:"s/TGL_SMALLPXLS"})},void 0,"Zeige Overlay als kleine einzelne Pixel in hohen Vergrößerungsstufen."),Jr("div",{className:"setitem"},void 0,Jr("div",{className:"setrow"},void 0,Jr("h3",{className:"settitle"},void 0,"Overlay Deckkraft"),Jr("div",{style:{textAlign:"right"}},void 0,Jr("input",{type:"number",value:o,style:{maxWidth:"6em"},step:"1",min:"10",max:"100",onChange:e=>h({type:"s/SET_O_OPACITY",opacity:e.target.value})}))),Jr("div",{className:"modaldesc"},void 0,"Deckkraft des Overlay in Prozent."),Qr||(Qr=Jr("div",{className:"modaldivider"}))),!a&&Jr(zr,{title:"Right-Shift Auto-Color",value:s,onToggle:()=>h({type:"s/TGL_RIGHTSHIFT"})},void 0,"Place pixels from overlay on right-shift, instead of history."),n.map(((e,t)=>{let{enabled:n,imageId:i,canvasId:r,title:o,x:s,y:a,width:c,height:d}=e;return l.includes(t)?Jr(qr,{enabled:n,title:o,imageId:i,canvasId:r,x:s,y:a,stopEditing:f},t):Jr(Kr,{enabled:n,title:o,imageId:i,canvasId:r,x:s,y:a,width:c,height:d,startEditing:f},t)})),e&&Jr(qr,{stopEditing:d}),e?Jr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>d()},void 0," ","Hinzufügen abbrechen"):Jr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t(!0)},void 0," ","Vorlage hinzufügen"),n.some((e=>e.enabled))&&Jr(Pe.Fragment,{},"exps"," | ",Jr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:async()=>{const e=await X.exportEnabledTemplates();e&&Wt()(JSON.stringify(e),"PixelplanetTemplates.json")}},void 0,"Exportiere eingeschaltete Vorlagen"))," | ",Jr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:async()=>u.current?.click()},void 0,"Importiere Vorlagen"),Pe.createElement("input",{type:"file",key:"impin",ref:u,style:{display:"none"},onChange:e=>{X.importTemplates(e.target.files?.[0])}}))};var to,no,io,ro,oo;function so(e,t,n,i){oo||(oo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:oo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ao=e=>{let{title:t,values:n,selected:i,onSelect:r,icon:o,children:s}=e;return so("div",{className:"setitem"},void 0,so("div",{className:"setrow"},void 0,so("h3",{className:"settitle"},void 0,t),o&&so("img",{alt:"",src:o}),so("select",{value:i,onChange:e=>{const t=e.target;r(t.options[t.selectedIndex].value)}},void 0,n.map((e=>so("option",{value:e},e,e))))),so("div",{className:"modaldesc"},void 0,s),to||(to=so("div",{className:"modaldivider"})))},lo=()=>{const[e,t,n,i,r,s,a,l,c,d,u,h]=(0,Oe.v9)((e=>[e.gui.showGrid,e.gui.showPixelNotify,e.gui.showMvmCtrls,e.gui.autoZoomIn,e.gui.compactPalette,e.gui.isPotato,e.gui.isLightGrid,e.gui.style,e.gui.mute,e.gui.chatNotify,e.canvas.isHistoricalView,e.templates.available]),Oe.wU),f=(0,Oe.I0)(),p=window.AudioContext||window.webkitAudioContext;return so("div",{className:"content"},void 0,so(zr,{title:"Zeige Raster",keyBind:"G",value:e,onToggle:()=>f((0,o.xK)())},void 0,"Aktiviere das Raster um Pixelgrenzen zu sehen."),so(zr,{title:"Zeige Pixelaktivität",keyBind:"X",value:t,onToggle:()=>f((0,o.Xb)())},void 0,"Zeige Kreise wo Pixel von Spielern gesetzt werden."),so(zr,{title:"Zeige Bewegungssteuerung immer",keyBind:"N",value:n,onToggle:()=>f((0,o.qP)())},void 0,"Zeige die Tasten zur Bewegungssteuerung immer"),so(zr,{title:"Deaktiviere Spiel Ton",keyBind:"M",deactivated:!p,value:!p||c,onToggle:()=>f((0,o.$t)())},void 0,["Alle Toneffekte werden ausgeschaltet.",!p&&so("p",{className:"warn"},void 0,"Dein Browser erlaubt uns nicht, mit AudioContext Töne abzuspielen. Werden wir von Privatsphäreneinstellungen blockiert?")]),so(zr,{title:"Aktiviere Chat Benachrichtigungen",value:d,onToggle:()=>f((0,o.c7)())},void 0,"Spiele ein Geräusch wenn eine neue Chat Nachricht eintrifft"),so(zr,{title:"Automaticher Zoom",value:i,onToggle:()=>f((0,o.o7)())},void 0,"Zoome rein anstatt ein Pixel zu setzen wenn auf kleineren Zoomlevel geklickt wird."),so(zr,{title:"Kompakte Palette",value:r,onToggle:()=>f((0,o.Cd)())},void 0,"Zeige die Palette in einer kleineren Form an, welche weniger Platz benötigt."),so(zr,{title:"Erdapfel Modus",value:s,onToggle:()=>f((0,o.RL)())},void 0,"Wenn du auf einer Kartoffel spielst."),so(zr,{title:"Helles Raster",value:a,onToggle:()=>f((0,o.ts)())},void 0,"Zeige das Raster in weiß anstatt schwarz."),window.ssv&&window.ssv.backupurl&&so(zr,{title:"Historische Ansicht",value:u,keyBind:"H",onToggle:()=>f((0,o.FI)())},void 0,"Siehe vergangene Versionen der Leinwand."),window.ssv&&window.ssv.availableStyles&&so(ao,{title:"Themen",values:Object.keys(window.ssv.availableStyles),selected:l,onSelect:e=>f((0,o.MM)(e))},void 0,"Wähle aus wie pixelplanet aussehen soll."),window.ssv&&navigator.cookieEnabled&&window.ssv.langs&&so("div",{className:"setitem"},void 0,so("div",{className:"setrow"},void 0,so("h3",{className:"settitle"},void 0,"Sprache Auswählen"),no||(no=so(Ur,{})))),io||(io=so("div",{className:"modaldivider"})),h&&(ro||(ro=so(eo,{}))))},co=Pe.memo(lo),uo=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;function ho(e){return e?e.length<5?"Email sollte zumindest 5 Zeichen lang sein.":e.length>40?"E-Mail kann nicht länger als 40 Zeichen sein.":-1===e.indexOf(".")?"Email sollte zumindest einen Punkt beinhalten":1!==e.split("").filter((e=>"@"===e)).length?"E-Mail sollte ein @ beinhalten":!uo.test(e)&&"Your Email looks shady":"E-Mail Feld kann nicht leer sein."}function fo(e){return e?e.length<2?"Name muss mindestens 2 Zeichen lang sein":e.length>26?"Name muss kleiner als 26 Zeichen sein":(-1!==e.indexOf("@")||-1!==e.indexOf("/")||-1!==e.indexOf("\\")||-1!==e.indexOf(">")||-1!==e.indexOf("<")||-1!==e.indexOf("#"))&&"Ungültige Zeichen im Namen wie @,/.\\ oder #":"Name kann nicht leer sein."}function po(e){return e?e.length<6?"Passwort muss mindestens 6 Zeichen lang sein.":e.length>60&&"Passwort muss kleiner als 60 Zeichen sein.":"Kein Passwort eingegeben."}var mo,vo;function go(e,t,n,i){vo||(vo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:vo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wo={display:"inline-block",width:"75%",maxWidth:"35em"},yo=()=>{const[e,t]=(0,Pe.useState)(""),[n,i]=(0,Pe.useState)(""),[r,s]=(0,Pe.useState)(!1),[a,l]=(0,Pe.useState)([]),c=(0,Oe.I0)();return go("form",{onSubmit:async t=>{if(t.preventDefault(),r)return;const i=function(e,t){const n=[],i=-1!==e.indexOf("@")?ho(e):fo(e);i&&n.push(i);const r=po(t);return r&&n.push(r),n}(e,n);if(i.length>0)return void l(i);s(!0);const{errors:a,me:d}=await(0,G.Pw)(e,n);s(!1),a?l(a):c((0,o.pH)(d))}},void 0,a.map((e=>go("p",{},e,go("span",{},void 0,"Fehler"),": ",e))),go("input",{value:e,style:wo,onChange:e=>t(e.target.value),type:"text",placeholder:"Name oder Email"}),mo||(mo=go("br",{})),go("input",{value:n,style:wo,onChange:e=>i(e.target.value),type:"password",placeholder:"Passwort"}),go("p",{},void 0,go("button",{type:"submit"},void 0,r?"...":"Einloggen")))},bo=Pe.memo(yo);var So,ko,Eo,Co,To,Io,xo,No;function _o(e,t,n,i){No||(No="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:No,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ao={marginRight:5},Lo=()=>{const e=Je();return _o("div",{style:{textAlign:"center"}},void 0,_o("p",{},void 0,"Melde dich and um mehr Funktionen und Statistikan zu sehen."),So||(So=_o("br",{})),_o("h2",{},void 0,"Mit Name oder Mail anmelden:"),ko||(ko=_o(bo,{})),_o("p",{className:"modallink",onClick:()=>e("FORGOT_PASSWORD"),role:"presentation"},void 0,"Ich habe mein Passwort vergessen."),_o("h2",{},void 0,"oder melde dich an mit:"),Eo||(Eo=_o("a",{href:"/api/auth/discord"},void 0,_o("img",{style:Ao,width:32,src:"/discordlogo.svg",alt:"Discord"}))),Co||(Co=_o("a",{href:"/api/auth/google"},void 0,_o("img",{style:Ao,width:32,src:"/googlelogo.svg",alt:"Google"}))),To||(To=_o("a",{href:"/api/auth/facebook"},void 0,_o("img",{style:Ao,width:32,src:"/facebooklogo.svg",alt:"Facebook"}))),Io||(Io=_o("a",{href:"/api/auth/vk"},void 0,_o("img",{style:Ao,width:32,src:"/vklogo.svg",alt:"VK"}))),xo||(xo=_o("a",{href:"/api/auth/reddit"},void 0,_o("img",{style:Ao,width:32,src:"/redditlogo.svg",alt:"Reddit"}))),_o("h2",{},void 0,"oder registriere dich hier:"),_o("button",{type:"button",onClick:()=>e("REGISTER")},void 0,"Registrieren"))},Po=Pe.memo(Lo);var Oo;function Ro(e,t,n,i){Oo||(Oo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Oo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Do=e=>{let{onClick:t,active:n,label:i}=e,r="tab-list-item";return n&&(r+=" active"),Ro("li",{role:"presentation",className:r,onClick:()=>t(i)},void 0,i)};var $o;function Mo(e,t,n,i){$o||($o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wo=e=>{let{children:t,activeTab:n,setActiveTab:i}=e;return Mo("div",{className:"tabs"},void 0,Mo("ol",{className:"tab-list"},void 0,t.map((e=>{if(!e.props)return;const{label:t}=e.props;return Mo(Do,{active:n===t,label:t,onClick:e=>i(e)},t)}))),Mo("div",{className:"tab-content"},void 0,t.map((e=>{if(e.props&&e.props.label===n)return e.props.children}))))};var zo;function Vo(e,t,n,i){zo||(zo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:zo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ho=()=>{const[e,t]=(0,Pe.useState)(!1),[n,i]=(0,Pe.useState)(null),r=(0,Oe.v9)((e=>e.user.messages));return r?Vo("div",{style:{paddingLeft:"5%",paddingRight:"5%"}},void 0,r.includes("not_verified")&&Vo("p",{className:"usermessages"},void 0,"Bitte bestätige deine E-Mail Adresse oder dein Konto könnte nach einigen Tagen gelöscht werden.",n?Vo("span",{className:"modallink"},void 0,n):Vo("span",{role:"button",tabIndex:-1,className:"modallink",onClick:async()=>{if(e)return;t(!0);const{errors:n}=await(0,G.ft)(),r=n?n[0]:"Eine neue Bestätigungsmail wurde gesendet.";i(r)}},void 0,"Klicke hier um eine neue Bestätigungsmail zu beantragen.")),r.map((e=>"not_verified"===e?null:Vo("p",{className:"usermessages"},e,e)))):null},Uo=Pe.memo(Ho);var Fo,Go,Bo,Ko;function Zo(e,t,n,i){Ko||(Ko="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ko,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const jo=e=>{let{done:t}=e;const[n,i]=(0,Pe.useState)(""),[r,s]=(0,Pe.useState)(""),[a,l]=(0,Pe.useState)(""),[c,d]=(0,Pe.useState)(!1),[u,h]=(0,Pe.useState)(!1),[f,p]=(0,Pe.useState)([]),m=(0,Oe.v9)((e=>e.user.mailreg)),v=(0,Oe.I0)();return c?Zo("div",{className:"inarea"},void 0,Zo("p",{className:"modalmessage"},void 0,"Passwort erfolgreich geändert."),Zo("button",{type:"button",onClick:t},void 0,"Close")):Zo("div",{className:"inarea"},void 0,Zo("form",{onSubmit:async e=>{if(e.preventDefault(),u)return;const t=function(e,t,n,i){const r=[];if(e){const e=po(t);e&&r.push(e)}if(n!==i)return r.push("Passwörter stimmen nicht überein."),r;const o=po(n);return o&&r.push(o),r}(m,n,r,a);if(p(t),t.length)return;h(!0);const{errors:i}=await(0,G.Oh)(r,n);if(i)return p(i),void h(!1);v((0,o.Y2)(!0)),d(!0)}},void 0,f.map((e=>Zo("p",{className:"errormessage"},e,Zo("span",{},void 0,"Fehler"),": ",e))),m&&Zo("input",{value:n,onChange:e=>i(e.target.value),type:"password",placeholder:"Altes Passwort"}),Fo||(Fo=Zo("br",{})),Zo("input",{value:r,onChange:e=>s(e.target.value),type:"password",placeholder:"Neues Passwort"}),Go||(Go=Zo("br",{})),Zo("input",{value:a,onChange:e=>l(e.target.value),type:"password",placeholder:"Neues Passwort bestätigen"}),Bo||(Bo=Zo("br",{})),Zo("button",{type:"submit"},void 0,u?"...":"Speichern"),Zo("button",{type:"button",onClick:t},void 0,"Abbrechen")))},Yo=Pe.memo(jo);var qo,Qo;function Xo(e,t,n,i){Qo||(Qo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Qo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Jo=e=>{let{done:t}=e;const[n,i]=(0,Pe.useState)(""),[r,s]=(0,Pe.useState)(!1),[a,l]=(0,Pe.useState)([]),c=(0,Oe.I0)();return Xo("div",{className:"inarea"},void 0,Xo("form",{onSubmit:async e=>{if(e.preventDefault(),r)return;const i=function(e){const t=[],n=fo(e);return n&&t.push(n),t}(n);if(i.length>0)return void l(i);s(!0);const{errors:a}=await(0,G.Wt)(n);s(!1),a?l(a):(c((0,o.qC)(n)),t())}},void 0,a.map((e=>Xo("p",{className:"errormessage"},e,Xo("span",{},void 0,"Fehler"),": ",e))),Xo("input",{value:n,onChange:e=>i(e.target.value),type:"text",placeholder:"Neuer Name"}),qo||(qo=Xo("br",{})),Xo("button",{type:"submit"},void 0,r?"...":"Speichern"),Xo("button",{type:"button",onClick:t},void 0,"Abbrechen")))};var es,ts,ns;function is(e,t,n,i){ns||(ns="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ns,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rs=e=>{let{done:t}=e;const[n,i]=(0,Pe.useState)(""),[r,o]=(0,Pe.useState)(""),[s,a]=(0,Pe.useState)(!1),[l,c]=(0,Pe.useState)(!1),[d,u]=(0,Pe.useState)([]);return l?is("div",{className:"inarea"},void 0,is("p",{className:"modalmessage"},void 0,"Erfolgreich änderte Mail Adresse. Wir haben dir eine neue Bestätigungsmail gesendet."),is("button",{type:"button",onClick:t},void 0,"Close")):is("div",{className:"inarea"},void 0,is("form",{onSubmit:async e=>{if(e.preventDefault(),s)return;const t=function(e,t){const n=[],i=po(t);i&&n.push(i);const r=ho(e);return r&&n.push(r),n}(r,n);if(t.length>0)return void u(t);a(!0);const{errors:i}=await(0,G.fF)(r,n);a(!1),i?u(i):c(!0)}},void 0,d.map((e=>is("p",{className:"errormessage"},e,is("span",{},void 0,"Fehler"),": ",e))),is("input",{value:n,onChange:e=>i(e.target.value),type:"password",placeholder:"Passwort"}),es||(es=is("br",{})),is("input",{value:r,onChange:e=>o(e.target.value),type:"text",placeholder:"Neue Mail"}),ts||(ts=is("br",{})),is("button",{type:"submit"},void 0,s?"...":"Speichern"),is("button",{type:"button",onClick:t},void 0,"Abbrechen")))};var os,ss;function as(e,t,n,i){ss||(ss="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ss,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ls=e=>{let{done:t}=e;const[n,i]=(0,Pe.useState)(""),[r,s]=(0,Pe.useState)(!1),[a,l]=(0,Pe.useState)([]),c=(0,Oe.I0)();return as("div",{className:"inarea",style:{backgroundColor:"#ff6666"}},void 0,as("form",{onSubmit:async e=>{if(e.preventDefault(),r)return;const t=function(e){const t=[],n=po(e);return n&&t.push(n),t}(n);if(t.length>0)return void l(t);s(!0);const{errors:i}=await(0,G.s$)(n);s(!1),i?l(i):c((0,o.TX)())}},void 0,a.map((e=>as("p",{className:"errormessage"},e,as("span",{},void 0,"Fehler"),": ",e))),as("input",{value:n,onChange:e=>i(e.target.value),type:"password",placeholder:"Passwort"}),os||(os=as("br",{})),as("button",{type:"submit"},void 0,r?"...":"Ja, löche mein Konto!"),as("button",{type:"button",onClick:t},void 0,"Abbrechen")))};var cs,ds;function us(e,t,n,i){ds||(ds="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ds,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hs=e=>[e.chat.blocked,e.user.blockDm,e.user.priv,e.fetching.fetchingApi],fs=e=>{let{done:t}=e;const[n,i,r,o]=(0,Oe.v9)(hs,Oe.wU),s=(0,Oe.I0)();return us("div",{className:"inarea"},void 0,us(zr,{title:"Blockiere PNs",value:i,onToggle:()=>{o||s((0,d.R0)(!i))}},void 0,"Blockiere alle Privaten Nachrichten"),us(zr,{title:"Privat",value:r,onToggle:()=>{o||s((0,d.eg)(!r))}},void 0,"Zeige mich nicht in globalen Statistiken"),us("h3",{style:{textAlign:"left",marginLeft:10}},void 0,"Entblocke Spieler"),n.length?us("span",{className:"unblocklist"},void 0,n.map((e=>us("div",{role:"button",tabIndex:0,onClick:()=>{o||s((0,d.Ox)(e[0],e[1],!1))}},e[0],`⦸ ${e[1]}`)))):us("p",{},void 0,"Du hast keinen Spieler geblockt"),cs||(cs=us("div",{className:"modaldivider"})),us("button",{type:"button",onClick:t,style:{margin:10}},void 0,"Done"))};var ps,ms,vs,gs,ws,ys,bs;function Ss(e,t,n,i){bs||(bs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:bs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ks={CHANGE_NAME:Pe.memo(Jo),CHANGE_MAIL:Pe.memo(rs),CHANGE_PASSWORD:Yo,DELETE_ACCOUNT:Pe.memo(ls),SOCIAL_SETTINGS:Pe.memo(fs)},Es=e=>{let{text:t,value:n,rank:i}=e;return Ss("p",{},void 0,Ss("span",{className:"stattext"},void 0,i?`${t}: #`:`${t}: `)," ",Ss("span",{className:"statvalue"},void 0,(0,k.D$)(n)))},Cs=()=>{const[e,t]=(0,Pe.useState)("NONE"),n=(0,Oe.I0)(),i=(0,Pe.useCallback)((async()=>{await(0,G.e9)()&&n((0,o.TX)())}),[n]),r=(0,Oe.v9)((e=>e.user.mailreg)),s=(0,Oe.v9)((e=>e.user.name)),a=(0,Oe.v9)((e=>({totalPixels:e.ranks.totalPixels,dailyTotalPixels:e.ranks.dailyTotalPixels,ranking:e.ranks.ranking,dailyRanking:e.ranks.dailyRanking})),Oe.wU),l=ks[e];return Ss("div",{className:"content"},void 0,ps||(ps=Ss(Uo,{})),Ss(Es,{text:"Heutige Pixel",value:a.dailyTotalPixels}),Ss(Es,{text:"Tägliche Rangliste",value:a.dailyRanking,rank:!0}),Ss(Es,{text:"Plazierte Pixel",value:a.totalPixels}),Ss(Es,{text:"Gesamt Rang",value:a.ranking,rank:!0}),Ss("div",{},void 0,Ss("p",{},void 0,`Dein Name ist: ${s}`),"(",Ss("span",{role:"button",tabIndex:-1,className:"modallink",onClick:i},void 0," ","Abmelden"),ms||(ms=Ss("span",{className:"hdivider"})),Ss("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("CHANGE_NAME")},void 0," ","Ändere Namen"),vs||(vs=Ss("span",{className:"hdivider"})),r&&Ss(Pe.Fragment,{},"mc",Ss("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("CHANGE_MAIL")},void 0," ","Ändere Mail"),gs||(gs=Ss("span",{className:"hdivider"}))),Ss("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("CHANGE_PASSWORD")},void 0," ","Passwort ändern"),ws||(ws=Ss("span",{className:"hdivider"})),Ss("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("DELETE_ACCOUNT")},void 0," ","Lösche Konto")," )",ys||(ys=Ss("br",{})),"(",Ss("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("SOCIAL_SETTINGS")},void 0," ","Soziale Einstellungen")," )"),l&&Ss(l,{done:()=>t(null)}))},Ts=Pe.memo(Cs);var Is,xs,Ns,_s,As,Ls,Ps,Os;function Rs(e,t,n,i){Os||(Os="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Os,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ds=Pe.lazy((()=>n.e(784).then(n.bind(n,563)))),$s=Pe.lazy((()=>n.e(545).then(n.bind(n,865)))),Ms=Pe.lazy((()=>n.e(189).then(n.bind(n,89)))),Ws=()=>{const e=(0,Oe.v9)((e=>e.user.name)),t=(0,Oe.v9)((e=>e.user.userlvl)),n=(0,Oe.v9)((e=>e.ranks.lastFetch)),{args:i,setArgs:r,setTitle:o}=(0,Pe.useContext)(Qe),{activeTab:s="Profil"}=i,a=(0,Oe.I0)(),l=(0,Pe.useCallback)((e=>{r({activeTab:e}),o(e)}),[r,o]);return(0,Xn.Z)((()=>{Date.now()-3e5>n&&a((0,d.mP)())}),3e5),Rs("div",{style:{textAlign:"center"}},void 0,Rs(Wo,{activeTab:s,setActiveTab:l},void 0,Rs("div",{label:"Profil"},void 0,e?Is||(Is=Rs(Ts,{})):xs||(xs=Rs(Po,{}))),Rs("div",{label:"Statistiken"},void 0,Ns||(Ns=Rs(Pe.Suspense,{fallback:Rs("div",{},void 0,"Loading...")},void 0,Rs(Ds,{})))),Rs("div",{label:"Konverter"},void 0,_s||(_s=Rs(Pe.Suspense,{fallback:Rs("div",{},void 0,"Loading...")},void 0,Rs($s,{})))),t&&Rs("div",{label:"Mod Werkzeuge"},void 0,Rs(Pe.Suspense,{fallback:Rs("div",{},void 0,"Lade...")},void 0,As||(As=Rs(Ms,{}))))),Ls||(Ls=Rs("br",{})),"Triff uns und andere Spieler auf guilded:"," ",Rs("a",{href:"./guilded",target:"_blank"},void 0,"Invited to Chat"),Ps||(Ps=Rs("br",{})))},zs=Pe.memo(Ws);var Vs;function Hs(e,t,n,i){Vs||(Vs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Vs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Us=()=>{const[e,t]=(0,Pe.useState)(""),[n,i]=(0,Pe.useState)([]),[r,s]=(0,Pe.useState)(Date.now()),a=(0,Oe.I0)(),l=Je();return Hs("div",{className:"content"},void 0,Hs("form",{style:{paddingLeft:"5%",paddingRight:"5%"},onSubmit:async n=>{if(n.preventDefault(),e)return;const r=n.target.name.value,c=n.target.email.value,d=n.target.password.value,u=n.target.confirmpassword.value,h=n.target.captcha.value,f=n.target.captchaid.value,p=function(e,t,n,i){const r=[],o=ho(t);o&&r.push(o);const s=fo(e);s&&r.push(s);const a=po(n);return a&&r.push(a),n!==i&&r.push("Passwords do not match"),r}(r,c,d,u);if(p.length>0)return void i(p);t(!0);const{errors:m,me:v}=await(0,G.yx)(r,c,d,h,f);if(t(!1),m)return s(Date.now()),void i(m);a((0,o.pH)(v)),l("USERAREA")}},void 0,Hs("p",{},void 0,"Registriere ein neues Konto hier"),n.map((e=>Hs("p",{className:"errormessage"},e,Hs("span",{},void 0,"Fehler"),": ",e))),Hs("h3",{},void 0,"Name",":"),Hs("input",{name:"name",className:"reginput",autoComplete:"username",type:"text",placeholder:"Name"}),Hs("h3",{},void 0,"Email",":"),Hs("input",{name:"email",className:"reginput",autoComplete:"email",type:"text",placeholder:"Email"}),Hs("h3",{},void 0,"Passwort",":"),Hs("input",{name:"password",className:"reginput",autoComplete:"new-password",type:"password",placeholder:"Passwort"}),Hs("h3",{},void 0,"Passwort bestätigen",":"),Hs("input",{name:"confirmpassword",className:"reginput",autoComplete:"new-password",type:"password",placeholder:"Passwort bestätigen"}),Hs("h3",{},void 0,"Captcha",":"),Hs(Kn,{autoload:!1,width:60},r),Hs("button",{type:"submit"},void 0,e?"...":"Absenden"),Hs("button",{type:"button",onClick:()=>l("USERAREA")},void 0,"Abbrechen")))},Fs=Pe.memo(Us);var Gs,Bs,Ks,Zs,js,Ys,qs,Qs,Xs,Js;function ea(e,t,n,i){Js||(Js="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Js,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ta=e=>{let{canvasId:t,canvas:n,selCanvas:i,online:r}=e;return ea("div",{className:"cvbtn",onClick:()=>i(t),role:"button",tabIndex:0},void 0,ea("img",{className:"cvimg",alt:"preview",src:`/preview${t}.png`}),ea("div",{className:"modalcvtext"},void 0,ea("h4",{},void 0,n.title),r&&ea(Pe.Fragment,{},"online","Spieler online",": ",ea("span",{className:"modalinfo"},void 0,r),Gs||(Gs=ea("br",{}))),ea("span",{className:"modalinfo"},void 0,n.desc),Bs||(Bs=ea("br",{})),"Abklingzeit",": ",ea("span",{className:"modalinfo"},void 0,n.pcd&&n.bcd!==n.pcd?ea("span",{},"cdf"," ",n.bcd/1e3,"s / ",n.pcd/1e3,"s"):ea("span",{},"cd"," ",n.bcd/1e3,"s")),Ks||(Ks=ea("br",{})),"Gesamtzeit",": ",ea("span",{className:"modalinfo"},void 0," ",n.cds/1e3,"s"),Zs||(Zs=ea("br",{})),"Gewertet",": ",ea("span",{className:"modalinfo"},void 0,n.ranked?"Ja":"Nein"),js||(js=ea("br",{})),void 0!==n.req&&ea(Pe.Fragment,{},"req",ea("span",{},void 0,"Vorraussetzungen",":",Ys||(Ys=ea("br",{})),ea("span",{className:"modalinfo"},void 0,"number"==typeof n.req?ea("span",{},void 0,"Konto"," "):null,n.req>0?ea("span",{},void 0," ",`und ${n.req} gesetzte Pixel`," "):null,"top"===n.req&&ea("span",{},void 0,"Top 10 Platzierung am Vortag"))),qs||(qs=ea("br",{}))),"Dimensionen",": ",ea("span",{className:"modalinfo"},void 0," ",n.size," x ",n.size,n.v?Qs||(Qs=ea("span",{},"voxsize"," x ",c.Tj," Voxels")):Xs||(Xs=ea("span",{},"pxlsize"," Pixels")))))},na=Pe.memo(ta);var ia;function ra(e,t,n,i){ia||(ia="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ia,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oa=()=>{const[e,t,n]=(0,Oe.v9)((e=>[e.canvas.canvases,e.gui.easterEgg,e.ranks.online]),Oe.wU),i=(0,Oe.I0)(),r=(0,Pe.useCallback)((e=>i((0,o.SC)(e))),[i]),s=Je();return ra("div",{className:"content"},void 0,ra("p",{},void 0,"Wähle die Leinwand aus, welche du benutzen willst.\nJede Leinwand ist einzigartig und hat unterschiedliche Paletten, Abklingzeiten und Voraussetzungen.\nDas Archiv von vergangenen Leinwänden kann hier eingesehen werden:"," ",ra("span",{role:"button",tabIndex:0,className:"modallink",onClick:()=>s("ARCHIVE")},void 0,"Archiv")),Object.keys(e).sort(((t,n)=>t===window.ssv.dc?-1:n===window.ssv.dc?1:(null!=e[t].linkcd&&(t=e[t].linkcd+.1),null!=e[n].linkcd&&(n=e[n].linkcd+.1),t-n))).map((i=>(!e[i].hid||t)&&!e[i].ed&&ra(na,{online:n[i],canvasId:i,canvas:e[i],selCanvas:r},i))),window.ssv?.backupurl&&Object.keys(e).some((t=>e[t].ed))&&Pe.createElement(Pe.Fragment,null,ra("h3",{},void 0,"Ausgediente Leinwände (nur historisch)"),Object.keys(e).map((t=>e[t].ed&&ra(na,{online:n[t],canvasId:t,canvas:e[t],selCanvas:r},t)))))},sa=Pe.memo(oa);var aa,la,ca,da;function ua(e,t,n,i){da||(da="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:da,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ha,fa=n(9210),pa=n(3935);function ma(e,t,n,i){ha||(ha="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ha,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const va=e=>{let{args:t,close:n}=e;const i=(0,Oe.v9)((e=>e.chat.channels)),r=(0,Oe.v9)((e=>e.fetching.fetchingApi)),o=(0,Oe.I0)(),{name:s,uid:a,setChannel:l,addToInput:c}=t;return Pe.createElement(Pe.Fragment,null,ma("div",{role:"button",tabIndex:0,onClick:()=>{const e=`@[${(0,k.lg)(s)}](${a})`;c(e),n()},style:{borderTop:"none"}},"ping","Erwähnen"),ma("div",{role:"button",tabIndex:0,onClick:()=>{const e=Object.keys(i);for(let t=0;t<e.length;t+=1){const r=e[t];if(4===i[r].length&&i[r][3]===a)return l(r),void n()}r||o((0,d.YB)({userId:a},l)),n()}},"dm","DM"),ma("div",{role:"button",tabIndex:-1,onClick:()=>{o((0,d.Ox)(a,s,!0)),n()}},"block","Blocke"))};var ga;function wa(e,t,n,i){ga||(ga="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ga,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ya=e=>{let{args:t,close:n}=e;const i=(0,Oe.v9)((e=>e.chat.channels)),r=(0,Oe.v9)((e=>e.chatRead.mute)),{cid:s}=t,a=(0,Oe.I0)(),l=r.includes(s);return Pe.createElement(Pe.Fragment,null,wa("div",{role:"button",onClick:()=>{a(l?(0,o.wC)(s):(0,o.nb)(s))},tabIndex:0,style:{borderTop:"none"}},"mute",(l?"✔":"✘")+" Stummschalten"),0!==i[s][1]&&wa("div",{role:"button",onClick:()=>{a((0,d.K6)(s)),n()},tabIndex:0},"leave","Schließen"))};var ba;function Sa(e,t,n,i){ba||(ba="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ba,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ka={USER:Pe.memo(va),CHANNEL:Pe.memo(ya)},Ea=e=>{let{type:t,x:n,y:i,args:r,close:o,align:s}=e;const a=(0,Pe.useRef)(null);var l,c;if(l=[a],c=o,(0,Pe.useEffect)((()=>{const e=l.some((e=>e.current))?l.map((e=>e.current)):null;if(null===e)return;const t=t=>{e.every((e=>!e||!e.contains(t.target)))&&c()},n=()=>{c()};return document.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("resize",n),()=>{document.removeEventListener("mousedown",t,{capture:!0}),window.removeEventListener("resize",n)}}),[l,c]),!t)return null;const d={};switch(s){case"tr":d.right=window.innerWidth-n,d.top=i;break;case"br":d.right=window.innerWidth-n,d.bottom=window.innerHeight-i;break;case"bl":d.left=n,d.bottom=window.innerHeight-i;break;default:d.left=n,d.top=i}const u=ka[t];return pa.createPortal(Pe.createElement("div",{ref:a,className:`contextmenu ${t}`,style:d},Sa(u,{close:o,args:r})),document.getElementById("app"))},Ca=Pe.memo(Ea);var Ta,Ia,xa=n(3854);function Na(e,t,n,i){Ia||(Ia="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ia,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _a=e=>{let{url:t}=e;const[n,i]=(0,Pe.useState)(null);return(0,Pe.useEffect)((()=>{!async function(){const e=`${window.location.protocol}//www.tiktok.com/oembed?url=${encodeURIComponent(t)}`,n=await fetch(e),r=await n.json();r.html&&i(r.html)}()}),[t]),n?Na("iframe",{style:{width:"100%",height:756},srcDoc:n,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded tiktok"}):Ta||(Ta=Na("div",{},void 0,"LOADING"))},Aa=[Pe.memo(_a),e=>e.includes("/video/"),e=>function(e){let t=e.indexOf("/@");if(-1===t)return e;t+=1;let n=e.indexOf("/",t);return-1===n&&(n=e.length),e.substring(t,n)}(e),"/embico/tiktok.png"];var La;function Pa(e,t,n,i){La||(La="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:La,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Oa(e){let t,n=-1;if(e.includes("youtube")&&(n=e.indexOf("v=")),e.includes("youtu.be")&&(n=e.indexOf("e/")),-1===n)return null;for(n+=2,t=n;t<e.length&&!["&","?","/"].includes(e[t]);t+=1);return e.substring(n,t)}const Ra=e=>{let{url:t}=e;const n=Oa(t);return n?Pa("div",{className:"vemb",style:{paddingBottom:"56.25%"}},void 0,Pa("iframe",{className:"vembc",src:`https://www.youtube.com/embed/${n}`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded youtube"})):null},Da=[Pe.memo(Ra),Oa,e=>Oa(e),"/embico/youtube.png"];var $a;function Ma(e,t,n,i){$a||($a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wa=e=>{let{url:t}=e;const n=t.substring(0,t.indexOf("?type="));return t.includes("?type=video")?Ma("div",{className:"vemb"},void 0,Ma("video",{className:"vembc",controls:!0,autoPlay:!0,src:n})):Ma("img",{alt:`Matrix ${n}`,src:n,style:{maxWidth:"100%"}})},za=[Pe.memo(Wa),e=>e.includes("?type=video")||e.includes("?type=image"),null,"/embico/matrix.png"],Va=function(e,t){const n=(0,Pe.useRef)();(0,Pe.useEffect)((()=>{n.current=t}),[t]),(0,Pe.useEffect)((()=>{function t(t){t.source===e.current.contentWindow&&n.current(t.data)}return window.addEventListener("message",t,!1),()=>window.removeEventListener("message",t)}),[e])},Ha="t.me/",Ua=e=>{let{url:t}=e;const[n,i]=(0,Pe.useState)(200),r=(0,Pe.useRef)(null);Va(r,(e=>{try{const t=JSON.parse(e);"resize"===t.event&&t.height&&i(t.height)}catch{console.error(`Could not read postMessage from frame: ${e}`)}}));let o=(0,k._N)(t);o=o.substring(o.indexOf(Ha)+5);const s=o.indexOf("/",o.indexOf("/")+1);return-1!==s&&(o=o.substring(0,s)),Pe.createElement("iframe",{ref:r,style:{width:"100%",height:n},src:`https://t.me/${o}?embed=1`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded telegram"})},Fa=[Pe.memo(Ua),e=>{let t=e.indexOf(Ha);return!(-1===t||t+5+1>=e.length||(t=e.indexOf("/",t+5+1),-1===t||t+2>=e.length))},e=>{let t=e.substring(e.indexOf(Ha)+5);return t=t.substring(0,t.indexOf("/")),t},"/embico/telegram.png"],Ga="/status/",Ba=e=>{let{url:t}=e;const[n,i]=(0,Pe.useState)(200),r=(0,Pe.useRef)(null);Va(r,(e=>{try{e["twttr.embed"]&&"twttr.private.resize"===e["twttr.embed"].method&&e["twttr.embed"].params.length&&e["twttr.embed"].params[0].height&&i(e["twttr.embed"].params[0].height)}catch{console.error(`Could not read postMessage from frame: ${e}`)}}));let o=(0,k._N)(t);return o=o.substring(o.indexOf(Ga)+8),-1!==o.indexOf("/")&&(o=o.substring(o.indexOf("/"))),Pe.createElement("iframe",{ref:r,style:{width:"100%",height:n},src:`https://platform.twitter.com/embed/Tweet.html?dnt=true&embedId=twitter-widget-&frame=false&hideCard=false&hideThread=true&id=${o}&theme=light&width=550px`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",allowFullScreen:!0,title:"Embedded twitter"})},Ka=[Pe.memo(Ba),e=>{const t=e.indexOf(Ga);return!(-1===t||t+8+1>=e.length)},e=>{let t=e.substring(0,e.indexOf(Ga));return t=t.substring(t.lastIndexOf("/")+1),t},"/embico/twitter.png"];var Za;function ja(e,t,n,i){Za||(Za="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Za,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ya(e){const t=e.lastIndexOf(":");return-1!==t?e.substring(0,t):e}const qa="/@",Qa=e=>{let t,{url:n}=e,i=n.indexOf(qa);return-1!==i||(i=n.indexOf("//"),-1===i&&(i=0)),t=n.substring(n.indexOf("/",i+2)+1),t=Ya((0,k._N)(t)),ja("div",{className:"vemb",style:{paddingBottom:"56.25%"}},void 0,ja("iframe",{className:"vembc",src:`https://odysee.com/$/embed/${t}`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded odysee"}))},Xa=[Pe.memo(Qa),e=>{const t=(0,k._N)(e);let n=t.indexOf(qa);return-1!==n?!(-1===n||n+4>=t.length||(n=t.indexOf("/",n+2),-1===n||n+2>=t.length)):(n=t.indexOf("//"),-1===n&&(n=0),n=t.indexOf("/",n+2),!(-1===n||n+2>=t.length))},e=>{let t=(0,k._N)(e),n=t.indexOf(qa);if(-1!==n){t=t.substring(n+2);let e=t.substring(0,t.indexOf("/"));return t=Ya(t.substring(e.length+1)),e=Ya(e),`${e} | ${t}`}return n=t.indexOf("//"),-1===n&&(n=0),t=t.substring(t.indexOf("/",n+2)+1),t=Ya((0,k._N)(t)),t},"/embico/odysee.png"];var Ja;function el(e,t,n,i){Ja||(Ja="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ja,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tl=["webm","mp4"],nl=["jpg","jpeg","png","webp","gif"],il=e=>{let{url:t}=e;const n=(0,k.r6)(t);return tl.includes(n)?el("div",{className:"vemb"},void 0,el("video",{className:"vembc",controls:!0,autoPlay:!0,src:t,referrerPolicy:"no-referrer"})):el("img",{alt:`Matrix ${t}`,src:t,style:{maxWidth:"100%"},referrerPolicy:"no-referrer"})},rl=[Pe.memo(il),e=>{const t=(0,k.r6)(e);return tl.includes(t)||nl.includes(t)},null,"/embico/direct.png"],ol={tiktok:Aa,youtube:Da,"youtu.be":Da,"matrix.pixelplanet.fun":za,"i.4cdn.org":rl,"i.imgur":rl,"litter.catbox.moe":rl,"files.catbox.moe":rl,"i.redd.it":rl,"media.discordapp.net":rl,"media.consumeproduct.win":rl,"cdn.discord.com":rl,"t.me":Fa,twitter:Ka,"nitter.net":Ka,odysee:Xa};var sl,al,ll;function cl(e,t,n,i){ll||(ll="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ll,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dl=["odysee","twitter","matrix.pixelplanet.fun","youtube","youtu.be","t.me"],ul=e=>{let{href:t,title:n,refEmbed:i}=e;const[r,o]=(0,Pe.useState)(!1),s=(0,k.IU)(t);if(s===window.location.hostname&&t.includes("/#")){const e=t.substring(t.indexOf("/#")+1);return Ke()&&window.opener&&!window.opener.closed?cl("a",{href:`/${e}`,target:"main"},void 0,n||e):cl("a",{href:`/${e}`},void 0,n||e)}const a=ol[s],l=a&&a[1](t),c=a&&a[0];let d;return d=n&&dl.includes(s)?n:l&&a[2]?a[2](t):t,Pe.createElement(Pe.Fragment,null,cl("a",{href:t,target:"_blank",rel:"noopener noreferrer"},void 0,d),l&&Pe.createElement(Pe.Fragment,null," ",a[3]&&cl("img",{style:{width:"1em",height:"1em",verticalAlign:"middle"},src:a[3],alt:`${s}-icon`}),cl("span",{style:{cursor:"pointer"},onClick:()=>o(!r)},void 0,r?sl||(sl=cl(xa.TQH,{className:"ebcl"})):al||(al=cl(xa.uwt,{className:"ebex"})))),r&&l&&(i&&i.current?pa.createPortal(cl(c,{url:t}),i.current):cl(c,{url:t})))},hl=Pe.memo(ul);var fl;function pl(e,t,n,i){fl||(fl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:fl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ml=e=>{let{name:t,uid:n}=e;const i=n&&n.trim(),r=(0,Oe.v9)((e=>-1!==e.gui.style.indexOf("dark")));return pl("span",{className:i==(0,Oe.v9)((e=>e.user.id))?"ping":"mention",style:{color:(0,k.TP)((0,k.Z)(t),r)}},void 0,`@${t}`)},vl=Pe.memo(ml);var gl;function wl(e,t,n,i){gl||(gl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:gl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yl=Pe.memo((e=>{let{pArray:t,refEmbed:n}=e;return t.map((e=>{if(!Array.isArray(e))return e;const t=e[0];switch(t){case"c":return wl("code",{},void 0,e[1]);case"*":return wl("strong",{},void 0,wl(yl,{pArray:e[1]}));case"~":return wl("s",{},void 0,wl(yl,{pArray:e[1]}));case"+":return wl("em",{},void 0,wl(yl,{pArray:e[1]}));case"_":return wl("u",{},void 0,wl(yl,{pArray:e[1]}));case"img":case"l":return wl(hl,{refEmbed:n,href:e[2],title:e[1]});case"@":return wl(vl,{uid:e[2],name:e[1]});default:return t}}))}));class bl{constructor(e,t){this.txt=e,this.iter=t||0}done(){return this.iter>=this.txt.length}moveForward(){return this.iter+=1,this.iter<this.txt.length}setIter(e){this.iter=e}getChar(){return this.txt[this.iter]}slice(e,t){return this.txt.slice(e,t||this.iter)}has(e){return this.txt.startsWith(e,this.iter)}move(e){return this.iter+=e,this.iter<this.txt.length}skipSpaces(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(;this.iter<this.txt.length;this.iter+=1){const t=this.txt[this.iter];if(" "!==t&&"\t"!==t&&(!e||"\n"!==t))break}}countRepeatingCharacters(){const e=this.getChar();let t=this.iter+1;for(;t<this.txt.length&&this.txt[t]===e;t+=1);return t-this.iter}moveToNextLine(){const e=this.txt.indexOf("\n",this.iter);this.iter=-1===e?this.txt.length:e+1}getLine(){const e=this.iter;return this.moveToNextLine(),this.txt.slice(e,this.iter)}getIndent(e){let t=0;for(;this.iter<this.txt.length;){const n=this.getChar();if("\t"===n)t+=e;else{if(" "!==n)break;t+=1}this.iter+=1}return t}goToCharInLine(e){let{iter:t}=this;for(;t<this.txt.length&&"\n"!==this.txt[t]&&this.txt[t]!==e;t+=1);return this.txt[t]===e&&(this.iter=t,t)}static isWhiteSpace(e){return" "===e||"\t"===e||"\n"===e}checkIfEnclosure(e){let t=this.iter+1,n=t;const i=[];for(;"]"!==this.txt[n];){const e=this.txt[n];if("\\"!==e){if(n>=this.txt.length||"\n"===e)return null;n+=1}else i.push(n),n+=2}let r=n+1;if("("!==this.txt[r])return null;r+=1;let o=r,s=null;for(;")"!==this.txt[o];){const t=this.txt[o];if(o>=this.txt.length||"\n"===t||"["===t||"("===t)return null;if(e&&":"===t){const e=this.iter;if(this.iter=o,s=this.checkIfLink(!0),o=this.iter,this.iter=e,null===s)return null}else o+=1}if(o<r+1||!s&&e)return null;e||(s=this.txt.slice(r,o));let a="";for(let e=0;e<i.length;e+=1){const n=i[e];a+=this.txt.slice(t,n),t=n+1}return t<n&&(a+=this.txt.slice(t,n)),this.iter=o,[a,s]}checkIfLink(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.iter;if(!this.txt.startsWith("://",t)||t<3)return null;let n=t-1;for(;n>=0&&!bl.isWhiteSpace(this.txt[n])&&"("!==this.txt[n];n-=1);for(n+=1,t+=3;t<this.txt.length&&!bl.isWhiteSpace(this.txt[t])&&(!e||")"!==this.txt[t]);t+=1);if(t<this.iter+4)return null;let i=this.txt.slice(n,t);const r=i.indexOf("http");return-1!==r&&0!==r&&(n+=r,i=this.txt.slice(n,t)),this.iter=t,i}checkIfCoords(){let e=this.iter+1;for(;e<this.txt.length;){const t=this.txt[e];if(","===t)break;if(bl.isWhiteSpace(t)||!Number.isNaN(Number(t)))return null;e+=1}if(e>=this.txt.length||e-this.iter>12||e===this.iter)return null;e+=1;const t=this.txt[e];if("-"!==t&&Number.isNaN(t))return null;e+=1;let n=1;for(;e<this.txt.length&&!bl.isWhiteSpace(this.txt[e]);){const t=this.txt[e];if(","===t)n+=1;else if("-"!==t&&Number.isNaN(Number(t)))return null;e+=1}if(n<2||n>3||","===this.txt[e-1])return null;const i=this.txt.slice(this.iter,e);return this.iter=e,i}}let Sl=()=>{};const kl=["*","~","+","_"];function El(e,t,n){const i=[];let r=e.iter,o=null;for(;!e.done()&&(o=e.getChar(),o!==n);){if("\n"===o){e.moveForward();break}if("\\"===o)r!==e.iter&&i.push(e.slice(r)),r=e.iter+1,e.moveForward();else if("#"===o){const t=e.iter,n=e.checkIfCoords();n&&(r!==t&&i.push(e.slice(r,t)),i.push(["l",null,`${window.location.origin}/${n}`]),r=e.iter)}else if(kl.includes(o)){const n=e.iter;e.moveForward();const s=El(e,t,o);e.getChar()===o?(r!==n&&i.push(e.slice(r,n)),i.push([o,s]),r=e.iter+1):e.setIter(n)}else if("`"===o){const t=e.iter;e.moveForward(),e.goToCharInLine("`")&&(r!==t&&i.push(e.slice(r,t)),i.push(["c",e.slice(t+1)]),r=e.iter+1)}else if(":"===o){const t=e.checkIfLink();if(null!==t){const n=e.iter-t.length;r<n&&i.push(e.slice(r,n)),i.push(["l",null,t]),r=e.iter;continue}}else if("["===o){let t=e.iter,n=null;e.iter>0&&(e.move(-1),n=e.getChar(),e.setIter(t));let o="l",s=!0;"!"===n?(o="img",t-=1):"@"===n&&(s=!1,o="@",t-=1);const a=e.checkIfEnclosure(s);null!==a&&(r<t&&i.push(e.slice(r,t)),i.push([o,a[0],a[1]]),r=e.iter+1)}e.moveForward()}return r!==e.iter&&i.push(e.slice(r)),i}function Cl(e){e.skipSpaces(!1),"\n"===e.getChar()&&e.moveForward();const t=e.iter;for(;!e.done();){if(e.skipSpaces(!0),e.has("```")){const n=["cb",e.slice(t)];return e.move(3),n}e.moveToNextLine()}const n=e.slice(t);return e.move(3),["cb",n]}function Tl(e,t){const n=e.getChar();let i="";for(;e.getChar()===n&&e.moveForward();)i+=e.getLine();const r=new bl(i);return[n,Sl(r,t,0)]}function Il(e,t,n,i){const r=[];let o=[],s=0;for(;!e.done();){const a=e.iter;s+=1;const l=e.getIndent(t.tabWidth);if(l<i&&s>1){e.setIter(a);break}const c=e.getChar();if(!i&&"#"===c)break;let d=!1,u=!1;if("-"===c&&(d=!0,e.moveForward()),!Number.isNaN(parseInt(c,10))){let t=e.iter+1;for(;!Number.isNaN(parseInt(e.txt[t],10));t+=1);const n=e.txt[t];"."!==n&&")"!==n||(u=!0,e.setIter(t+1))}let h=!1,f=null;if(d||u){let i;o.length&&(r.push(["p",o]),o=[]),i=Il(e,t,n,l+1),i=["-",i];const s=d?"ul":"ol";r.length&&r[r.length-1][0]===s?r[r.length-1][1].push(i):r.push([s,[i]])}else if(">"===c||"<"===c)h=!0,f=Tl(e,t);else if(e.has("```"))h=!0,e.move(3),f=Cl(e);else{if(i||"\n"!==c){const n=El(e,t);n&&(o=o.concat(n));continue}if(e.moveForward(),e.skipSpaces(!1),"\n"===e.getChar()){if(n&&t.newlineBreaksArticles)break;e.moveForward()}h=!0}h&&o.length&&(r.push(["p",o]),o=[]),f&&r.push(f)}return o.length&&r.push(["p",o]),r}var xl;function Nl(e,t,n,i){xl||(xl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:xl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function _l(e){let{name:t,uid:n,country:i,msg:r,ts:o,openCm:s}=e;const a=(0,Oe.v9)(On.s),l=(0,Pe.useRef)(),c="info"===t,d="event"===t;let u="msg";c?u+=" info":d?u+=" event":">"===r.charAt(0)?u+=" greentext":"<"===r.charAt(0)&&(u+=" redtext");const h=function(e,t){const n=function(e){const t={};return t.parseLinks=e&&e.parseLinks||!1,t.tabWidth=e&&e.tabWidth||4,t.newlineBreaksArticles=e&&e.newlineBreaksArticles||!0,t}(void 0);return El(new bl(e),n)}(r);return Pe.createElement("li",{className:"chatmsg",ref:l},Nl("div",{className:"msgcont"},void 0,Nl("span",{className:u},void 0,!c&&!d&&Nl(Pe.Fragment,{},"name",Nl("img",{className:"chatflag",alt:"",title:i,src:`/cf/${i}.gif`}),Nl("span",{className:"chatname",style:{color:(0,k.TP)((0,k.Z)(t),a),cursor:"pointer"},role:"button",title:t,tabIndex:-1,onClick:e=>{s(e.clientX,e.clientY,t,n)}},void 0,t),": "),Nl(yl,{refEmbed:l,pArray:h})),Nl("span",{className:"chatts"},void 0,(0,k.tF)(o))))}Sl=(e,t,n)=>{let i=[];for(;!e.done();){const r=Il(e,t,n,0);if(i=i.concat(r),"#"!==e.getChar())break;{let r=e.countRepeatingCharacters();if(r<=n||6===n)break;{e.move(r);const n=e.getLine();r=Math.min(r,6);const o=Sl(e,t,r);i.push(["a",r,n,o])}}}return i};const Al=Pe.memo(_l);var Ll,Pl,Ol,Rl,Dl;function $l(e,t,n,i){Dl||(Dl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Dl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ml=e=>{let{setChatChannel:t,chatChannel:n}=e;const[i,r]=(0,Pe.useState)(!1),[o,s]=(0,Pe.useState)([]),[a,l]=(0,Pe.useState)(0),[c,d]=(0,Pe.useState)(0),[u,h]=(0,Pe.useState)(!1),[f,p]=(0,Pe.useState)("..."),[m,v]=(0,Pe.useState)(!1),g=(0,Pe.useRef)(null),w=(0,Pe.useRef)(null),y=(0,Oe.v9)((e=>e.chatRead.unread)),b=(0,Oe.v9)((e=>e.chatRead.mute)),S=(0,Oe.v9)((e=>e.chat.channels)),k=(0,Oe.v9)((e=>e.gui.chatNotify));return(0,Pe.useEffect)((()=>{d(w.current.clientHeight)}),[w]),function(e,t,n){const i=(0,Pe.useCallback)((t=>{e.every((e=>!e.current||!e.current.contains(t.target)))&&n()}),[n,e]),r=(0,Pe.useCallback)((()=>{n()}),[n]);(0,Pe.useLayoutEffect)((()=>{t?(document.addEventListener("mousedown",i,{capture:!0}),window.addEventListener("resize",r)):(document.removeEventListener("mousedown",i,{capture:!0}),window.removeEventListener("resize",r))}),[t,i,r])}([g],i,(0,Pe.useCallback)((()=>r(!1)),[])),(0,Pe.useEffect)((()=>{if(i&&S[n]){const e=1===S[n][1]?1:0;l(e)}}),[i,S,n]),(0,Pe.useEffect)((()=>{const e=Object.keys(S),t=[];let n=0;for(;n<e.length;){const i=e[n],r=y[i]&&!b.includes(i);t.push([i,r,...S[i]]),!u&&0!==S[i][1]&&r&&h(!0),n+=1}t.sort(((e,t)=>0===e[3]||0===t[3]?0:e[4]>t[4]?-1:t[4]>e[4]?1:0)),t.sort(((e,t)=>0===e[3]||0===t[3]?0:e[1]&&!t[1]?-1:t[1]&&!e[1]?1:0)),s(t),n===e.length&&h(!1)}),[S,y,b,u]),(0,Pe.useEffect)((()=>{const e=Object.keys(S);for(let t=0;t<e.length;t+=1)if(1===S[e[t]][1])return void v(!0);v(!1)}),[S]),(0,Pe.useEffect)((()=>{S[n]&&p(S[n][0])}),[n,S]),$l("div",{style:{position:"relative"}},void 0,Pe.createElement("div",{ref:w,key:"expbtn",role:"button",tabIndex:-1,onClick:()=>r(!0),className:"channelbtn"+(i?" selected":"")},u&&k&&!i&&$l("div",{style:{top:-4},className:"chnunread"},void 0,"⦿"),f),i&&Pe.createElement("div",{ref:g,key:"dropdown",style:{position:"absolute",bottom:c,right:9},className:"channeldd"},$l("div",{className:"chntop"},void 0,$l("span",{style:{borderLeft:"none"},className:"chntype"+(0===a?" selected":""),onClick:()=>l(0),role:"button",tabIndex:-1},void 0,Ll||(Ll=$l(mt.Fmx,{}))),m&&$l("span",{className:"chntype"+(1===a?" selected":""),onClick:()=>l(1),role:"button",tabIndex:-1},void 0,u&&k&&1!==a&&(Pl||(Pl=$l("div",{className:"chnunread"},void 0,"⦿"))),Ol||(Ol=$l(Fe.wN,{})))),$l("div",{className:"channeldds"},void 0,o.filter((e=>{const t=e[3];return 1===a&&1===t||0===a&&1!==t})).map((e=>{const[i,r,o]=e;return $l("div",{onClick:()=>t(i),className:"chn"+(i===n?" selected":""),role:"button",tabIndex:-1},i,r&&k?Rl||(Rl=$l("div",{className:"chnunread"},void 0,"⦿")):null,o)})))))},Wl=Pe.memo(Ml);var zl;function Vl(e,t,n,i){zl||(zl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:zl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Hl,Ul,Fl;function Gl(e,t,n,i){Fl||(Fl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Fl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Bl={display:"inline-block",width:"100%",maxWidth:"35em"},Kl=()=>{const[e,t]=(0,Pe.useState)(""),[n,i]=(0,Pe.useState)(!1),[r,o]=(0,Pe.useState)(!1),[s,a]=(0,Pe.useState)([]),l=Je();return r?Gl("div",{},void 0,Gl("p",{className:"modalmessage"},void 0,"Sendete eine E-Mail mit Instruktionen um das Passwort zurückzusetzen."),Gl("button",{type:"button",onClick:()=>l("USERAREA")},void 0,"Back")):Gl("div",{className:"content"},void 0,Gl("p",{},void 0,"Gib deine Mail Adresse an und wir senden dir ein neues Passwort:"),Hl||(Hl=Gl("br",{})),Gl("form",{onSubmit:async t=>{if(t.preventDefault(),n)return;const r=function(e){const t=[],n=ho(e);return n&&t.push(n),t}(e);if(r.length>0)return void a(r);i(!0);const{errors:s}=await(0,G.hH)(e);i(!1),s?a(s):o(!0)}},void 0,s.map((e=>Gl("p",{},e,Gl("span",{},void 0,"Fehler"),": ",e))),Gl("input",{style:Bl,value:e,onChange:e=>t(e.target.value),type:"text",placeholder:"Email"}),Ul||(Ul=Gl("br",{})),Gl("button",{type:"submit"},void 0,n?"...":"Absenden"),Gl("button",{type:"button",onClick:()=>l("USERAREA")},void 0,"Abbrechen")))},Zl={HELP:[()=>{const e=Rr("kbd",{},void 0,"G"),t=Rr("kbd",{},void 0,"X"),n=Rr("kbd",{},void 0,"H"),i=Rr("kbd",{},void 0,"R"),r=Rr("kbd",{},void 0,"Q"),s=Rr("kbd",{},void 0,"E"),a=Rr("kbd",{},void 0,"W"),l=Rr("kbd",{},void 0,"A"),c=Rr("kbd",{},void 0,"S"),u=Rr("kbd",{},void 0,"D"),h=Ki||(Ki=Rr("kbd",{},void 0,"↑")),f=Zi||(Zi=Rr("kbd",{},void 0,"←")),p=ji||(ji=Rr("kbd",{},void 0,"↓")),m=Yi||(Yi=Rr("kbd",{},void 0,"→")),v=qi||(qi=Rr("kbd",{},void 0,Rr(Ui.nI7,{}))),g=Qi||(Qi=Rr("kbd",{},void 0,Rr(mt.EGB,{}))),w=Rr("kbd",{},void 0,"⇧ ","Shift"),y=Xi||(Xi=Rr("a",{href:"https://twitter.com/starhousedev"},void 0,"starhouse ")),b=Ji||(Ji=Rr("a",{href:"https://twitter.com/Vinikdev"},void 0,"Vinikdev")),S=er||(er=Rr("a",{href:"https://lospec.com/palette-list/lava-gb"},void 0,"Do-Nendo")),k=tr||(tr=Rr("a",{href:"/guilded"},void 0,"guilded")),E=Rr("a",{href:`mailto:${window.ssv.contactAddress}`},void 0,window.ssv.contactAddress),C=(0,Oe.I0)(),T=(0,Oe.v9)((e=>e.gui.easterEgg)),I=(0,Pe.useCallback)((()=>{C((0,o.u0)()),C((0,d.h4)(T?"Osterei AUS":"Osterei EIN"))}),[T,C]),x=vn(null,I,1e3);return Rr("div",{className:"content"},void 0,Pe.createElement("img",{style:{padding:2,maxWidth:"20%",verticalAlign:"middle",display:"inline-block"},alt:"ppfun",src:"./logo.svg",ref:x}),Rr("p",{},void 0,"Zeichne gemeinsam mit anderen Spielern auf einer großen Leinwand online!",nr||(nr=Rr("br",{})),"Unsere Standardleinwand ist eine große Weltkarte. Pixel können überall gesetzen werden, aber es kann nur eine begrenzte Anzahl and Pixels per Zeit platziert werden. Die Vorraussetzungen und die Wartezeit sind im Auswahlmenu zu sehen (Globus Taste am oberen Bildschirmrand). Manche Leinwände haben eine niedrigere Wartezeit für ungesetzte Pixel im Vergleich zu von anderen Spielern gesetzte Pixel. z.B. 4s/7s heißt dass man 4s für jedes neue Pixel warten muss, allerdings 7s wenn man über ein Pixel eines anderen Spielers setzt.",ir||(ir=Rr("br",{})),"Die höheren Zoomlevel brauchen etwas Zeit um aktualisiert zu werden, der 3D Globus wird mindestens einmal pro tag neu geladen.",rr||(rr=Rr("br",{})),"Viel Spaß!"),Rr("p",{className:"modalinfo"},void 0,"Guilded (","empfohlen","): ",Rr("a",{href:"./guilded",target:"_blank",rel:"noopener noreferrer"},void 0,"Invited to Chat")),Rr("p",{className:"modalinfo"},void 0,"Source for pixelplanet on ",or||(or=Rr("a",{href:"https://git.pixelplanet.fun",target:"_blank",rel:"noopener noreferrer"},void 0,"git.pixelplanet.fun"))),Rr("p",{className:"modalinfo"},void 0,"We are Libre Software, ",Rr("a",{href:"/legal",target:"_blank",rel:"noopener noreferrer"},void 0,"check compliance here")),Rr("h3",{},void 0,"Karten Dateien"),Rr("p",{},void 0,"Die Kartendaten welche wir benutzen, zusammen mit konvertierten OpenStreetMap Kacheln zur orientierung können auf mega.nz heruntergeladen werden: ",sr||(sr=Rr("a",{href:"https://mega.nz/#!JpkBwAbJ!EnSLlZmKv3kEBE0HDhakTgAZZycD3ELjduajJxPGaXo"},void 0,"pixelplanetmap.zip"))," (422MB)"),Rr("h3",{},void 0,"Verbannt? Als Proxy erkannt?"),Rr("div",{},void 0,Rr("p",{},void 0,["Solltest do als Proxy erkannt sein, aber du benutzt keines, oder du glaubst zu Unrecht verbannt worden zu sein, bitte kontaktiere uns auf ",k," oder sende uns eine Mail ",E," und gib diese IID an:"]),ar||(ar=Rr(Bi,{}))),Rr("h3",{},void 0,"2D ","Steuerung"),Rr("div",{style:{lineHeight:1.5}},void 0,"Klicke auf eine Farbe in der Palette um sie auszuwählen",lr||(lr=Rr("br",{})),["Drücke ",e," um das Raster ein- und auszuschalten"],cr||(cr=Rr("br",{})),["Drücke ",t," um Pixel Aktivität anzuzeigen"],dr||(dr=Rr("br",{})),["Drücke ",n," um zur historischen Ansicht zu wechseln"],ur||(ur=Rr("br",{})),["Drücke ",i," um aktuelle Koordinaten zu kopieren"],hr||(hr=Rr("br",{})),["Drücke ",r," oder ",s," um zu zoomen"],fr||(fr=Rr("br",{})),["Drücke ",a,", ",l,", ",c,", ",u," zum navigieren"],pr||(pr=Rr("br",{})),["Drücke ",h,", ",f,", ",p,", ",m," zum navigieren"],mr||(mr=Rr("br",{})),["Ziehe mit der ",v," Maus oder ",g," wische zum navigieren"],vr||(vr=Rr("br",{})),["Scrolle ",v," mit them Mausrad oder ",g," benutze Zwei-Finger-Zoom um zu zoomen"],gr||(gr=Rr("br",{})),["Hold left ",w," for placing while moving mouse"],wr||(wr=Rr("br",{})),["Hold right ",w," for placing while moving mouse according to historical view"],yr||(yr=Rr("br",{})),[v," Linksklick oder ",g," tippe um ein Pixel zu platzieren"],br||(br=Rr("br",{})),["Klicke ",v," die mittlere Maustaste oder ",g," tippe lange um eine Farbe von der Leinwand auszuwählen"],Sr||(Sr=Rr("br",{}))),Rr("h3",{},void 0,"3D ","Steuerung"),Rr("div",{style:{lineHeight:1.5}},void 0,["Drücke ",a,", ",l,", ",c,", ",u," zum navigieren"],kr||(kr=Rr("br",{})),["Drücke ",h,", ",f,", ",p,", ",m," zum navigieren"],Er||(Er=Rr("br",{})),["Drücke ",r," oder ",s," um hoch und runter zu fliegen"],Cr||(Cr=Rr("br",{})),[v," Halte die linke Maustaste gedrückt und ziehe um zu rotieren"],Tr||(Tr=Rr("br",{})),[v," Scrolle mit dem Mausrad oder halte ",v," die mittlere Maustaste gedrückt und ziehe um zu zoomen"],Ir||(Ir=Rr("br",{})),[v," Halte die rechte Maustaste gedrückt und ziehe um dich zu bewegen"],xr||(xr=Rr("br",{})),[v," Linksklick oder ",g," tippe um ein Pixel zu platzieren"],Nr||(Nr=Rr("br",{})),[v," Rechtsklick oder ",g," tippe zweimal um ein Voxel zu entfernen"],_r||(_r=Rr("br",{})),["Klicke ",v," die mittlere Maustaste oder ",g," tippe lange um eine Farbe von der Leinwand auszuwählen"],Ar||(Ar=Rr("br",{}))),Lr||(Lr=Rr("h3",{},void 0,"Palette Credits")),Rr("div",{},void 0,["Wir bedanken uns bei diesen Künstlern, welche ihre Farbpaletten der Öffentlichkeit zugänglich machten auf"]," ",Pr||(Pr=Rr("a",{href:"https://lospec.com/"},void 0,"lospec.com")),Rr("p",{},void 0,["Vielen Dank an ",y," für die Palette der Mond Leinwand."]),Rr("p",{},void 0,["Vielen Dank an ",b," für die Palette der Top10 Leinwand."]),Rr("p",{},void 0,["Vielen Dank an ",S," für die Palette der 2bit Leinwand."])))},"Hilfe"],SETTINGS:[co,"Einstellungen"],USERAREA:[zs,"Spielerbereich"],REGISTER:[Fs,"Registrieren"],FORGOT_PASSWORD:[Pe.memo(Kl),"Passwort vergessen"],CHAT:[()=>{const e=(0,Pe.useRef)(),t=(0,Pe.useRef)(),n=(0,Pe.useRef)(),[i,r]=(0,Pe.useState)([]),[s,a]=(0,Pe.useState)(20),[l,c]=(0,Pe.useState)({}),u=(0,Oe.I0)(),h=(0,Oe.v9)((e=>e.user.name)),f=(0,Oe.v9)((e=>e.fetching.fetchingChat)),{channels:p,messages:m,blocked:v}=(0,Oe.v9)((e=>e.chat)),{args:g,setArgs:w,setTitle:y}=(0,Pe.useContext)(Qe),{chatChannel:b=1}=g,S=Je(),k=(0,Pe.useCallback)((e=>{u((0,o.Eo)(e)),w({chatChannel:Number(e)})}),[u]),E=(0,Pe.useCallback)((e=>{const t=n.current;if(!t)return;let i=t.value;" "!==i.slice(-1)&&(i+=" "),i+=`${e} `,t.value=i,n.current.focus()}),[]),C=(0,Pe.useCallback)((()=>{c({})}),[]),T=(0,Pe.useCallback)(((e,t,n,i)=>{c({type:"USER",x:e,y:t,args:{name:n,uid:i,setChannel:k,addToInput:E}})}),[k,E]),{stayScrolled:I}=(0,fa.Z)(e,{initialScroll:1/0,inaccuracy:10}),x=m[b]||[];return(0,Pe.useEffect)((()=>{!p[b]||m[b]||f||u((0,d.TL)(b))}),[p,m,b]),(0,Pe.useEffect)((()=>{if(p[b]){const e=p[b][0];y(`Chan: ${e}`)}}),[b]),(0,Pe.useLayoutEffect)((()=>{I()}),[x.length]),(0,Pe.useEffect)((()=>{setTimeout((()=>{const e=Math.round(t.current.offsetHeight/10);a(Math.min(28,e))}),330)}),[t]),(0,Pe.useEffect)((()=>{const e=[];for(let t=0;t<v.length;t+=1)e.push(v[t][0]);r(e)}),[v.length]),(0,Pe.useEffect)((()=>{if(!b||!p[b]){const e=Object.keys(p);e.length&&k(e[0])}}),[p]),Pe.createElement("div",{ref:t,className:"chat-container"},Vl(Ca,{type:l.type,x:l.x,y:l.y,args:l.args,close:C,align:l.align}),Pe.createElement("ul",{className:"chatarea",ref:e,style:{flexGrow:1},role:"presentation"},!x.length&&Vl(Al,{uid:0,name:"info",country:"xx",msg:"Beginne hier zu unterhalten"}),x.map((e=>i.includes(e[3])?null:Vl(Al,{name:e[0],msg:e[1],country:e[2],uid:e[3],ts:e[4],openCm:T},e[5])))),Vl("form",{className:"chatinput",onSubmit:e=>function(e){e.preventDefault();const t=n.current.value.trim();t&&(u((0,o.bE)(t,b)),n.current.value="")}(e),style:{display:"flex"}},void 0,h?Vl(Pe.Fragment,{},"chtipt",Pe.createElement("input",{style:{flexGrow:1,minWidth:40},ref:n,autoComplete:"off",maxLength:"200",type:"text",placeholder:"Chatte hier"}),Vl("button",{id:"sendbtn",style:{flexGrow:0},type:"submit"},void 0,"‣")):Vl("div",{className:"modallink",onClick:e=>{e.stopPropagation(),S("USERAREA",{target:"fullscreen"})},style:{textAlign:"center",fontSize:13,flexGrow:1},role:"button",tabIndex:0},"nlipt","Melde dich an um dich zu unterhalten"),Vl(Wl,{setChatChannel:k,chatChannel:b},"cdd")),Vl("div",{className:"chatlink",style:{fontSize:s}},void 0,Vl("span",{onClick:e=>{const{clientX:t,clientY:n}=e;c({type:"CHANNEL",x:t,y:n,args:{cid:b},align:"tr"})},role:"button",title:"Kanal Einstellungen",tabIndex:-1},void 0,"⚙")))},"Kommentarsektion"],CANVAS_SELECTION:[sa,"Leinwand auswahl"],ARCHIVE:[()=>ua("div",{className:"content"},void 0,ua("p",{},void 0,"Wir vermeiden es, Leinwände zu entfernen. Allerdings werden manche zum Spaß gestartet oder von Spielern angefragt, weil sie aktuelle Memes mögen. Diese Leinwände können nach einiger Zeit langweilig werden und nach Wochen ohne erwähnenswerte Aktivität, entscheiden wir uns manchmal, diese zu entfernen.",aa||(aa=ua("br",{})),"Hier sammeln wir vergangene Leinwände um sie ordentlich zu archivieren (zur Zeit nur eine)."),ua("h3",{},void 0,"Politischer Kompass Leinwand"),ua("img",{style:{padding:2,maxWidth:"20%",verticalAlign:"middle",display:"inline-block"},alt:"political-compass",src:"https://storage.pixelplanet.fun/compass-preview.png"}),ua("p",{},void 0,"Diese Leinwand wurde zu Zeiten politscher Konlikte auf der Erd-Leinwand gestarted. Es war eine 1024x1024 Abbildung des politischen Kompass mit 5s Abklingzeit und 60s gesamter Wartezeit. Es wurde am 11. Mai 2020 gestartet und war für Monate aktiv bis es am 30. November geschlossen wurde.",la||(la=ua("br",{})),"Wir haben uns entschieden sie in der Form eines Zeitraffers in verlustfrei kodiertes webm zu archivieren. Eine Bildschirmaufnahme aus dem Video ergibt eine perfekte 1:1 Abbildung der Leinwand zu dieser Zeit."),ca||(ca=ua("p",{className:"modalinfo"},void 0,"Timelapse:",ua("a",{href:"https://storage.pixelplanet.fun/compass-timelapse.webm"},void 0,"Download"))),ua("img",{style:{padding:2,maxWidth:"80%",verticalAlign:"middle"},alt:"political-compass",src:"https://storage.pixelplanet.fun/compass-final.png"})),"Leinwand Archiv"]};var jl,Yl,ql;function Ql(e,t,n,i){ql||(ql="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ql,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xl=e=>{let{id:t}=e;const[n,i]=(0,Pe.useState)(!1),r=(0,Pe.useRef)(),o=(0,Pe.useRef)(),s=(0,Pe.useMemo)((()=>{return e=t,(0,Di.P1)($i,(t=>t.find((t=>t.windowId===e))));var e}),[]),a=(0,Pe.useMemo)((()=>{return e=t,t=>t.windows.positions[e];var e}),[]),l=(0,Pe.useMemo)((()=>{return e=t,t=>t.windows.args[e]||{};var e}),[]),c=(0,Oe.v9)(s),d=(0,Oe.v9)(a),u=(0,Oe.v9)(Mi),h=(0,Oe.v9)(l),f=(0,Oe.I0)(),p=(0,Pe.useMemo)((()=>({args:h,setArgs:e=>f(function(e,t){return{type:"SET_WIN_ARGS",windowId:e,args:t}}(t,e)),setTitle:e=>f(function(e,t){return{type:"SET_WIN_TITLE",windowId:e,title:t}}(t,e)),changeType:(e,n,i)=>f(function(e,t){return{type:"CHANGE_WIN_TYPE",windowId:e,windowType:t,title:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",args:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null}}(t,e,n,i))})),[t,h]),{open:m,hidden:v,fullscreen:g}=c,w=(0,Pe.useCallback)((()=>{f({type:"FOCUS_WIN",windowId:t})}),[f]),y=(0,Pe.useCallback)((e=>{e.stopPropagation(),f({type:"CLONE_WIN",windowId:t})}),[f]),b=(0,Pe.useCallback)((()=>{i(!1)}),[f]),S=(0,Pe.useCallback)((e=>{e.stopPropagation(),f({type:"CLOSE_WIN",windowId:t})}),[f]),{xPos:k,yPos:E,width:C,height:T}=d;Vi(r,w,(0,Pe.useCallback)(((e,n)=>f(function(e,t,n){return{type:"MOVE_WIN",windowId:e,xDiff:t,yDiff:n}}(t,e,n))),[g,!n&&v])),Vi(o,w,(0,Pe.useCallback)(((e,n)=>f(function(e,t,n){return{type:"RESIZE_WIN",windowId:e,xDiff:t,yDiff:n}}(t,e,n))),[g,!n&&v]));const I=(0,Pe.useCallback)((()=>{v&&i(!1),m?n||v||(f({type:"TGL_MAXIMIZE_WIN",windowId:t}),setTimeout((()=>i(!0)),10)):f({type:"REMOVE_WIN",windowId:t})}),[f,v,m,n]);if((0,Pe.useEffect)((()=>{m&&!v&&window.setTimeout((()=>{i(!0)}),10)}),[m,v]),!n&&(v||!m))return null;const{title:x,windowType:N}=c,{z:_}=d,[A,L]=Zl[N],P=x?`${L} - ${x}`:L,O=`${N}${m&&!v&&n?" show":""}`;return g?Ql("div",{className:`modal ${O}`,onTransitionEnd:I,onClick:w,style:{zIndex:_}},void 0,Ql("h2",{},void 0,P),Ql("div",{onClick:S,className:"modal-topbtn close",role:"button",label:"close",title:"Schließen",tabIndex:-1},"closebtn","✕"),je.includes(N)&&Ql("div",{onClick:e=>{Xe(N,h,k,E,C,T),S(e)},className:"modal-topbtn pop",role:"button",label:"close",title:"PopUp",tabIndex:-1},"popbtn",jl||(jl=Ql(Ri.srV,{}))),u&&Ql("div",{onClick:b,className:"modal-topbtn restore",role:"button",label:"restore",title:"Wiederherstellen",tabIndex:-1},"resbtn","↓"),Ql("div",{className:"modal-content"},"content",Ql(Qe.Provider,{value:p},void 0,Ql(A,{})))):Ql("div",{className:`window ${O}`,onTransitionEnd:I,onClick:w,style:{left:k,top:E,width:C,height:T,zIndex:_}},void 0,Ql("div",{className:"win-topbar"},"topbar",Ql("span",{className:"win-topbtn",onClick:y,title:"Klonen"},"clonebtn","+"),Pe.createElement("span",{className:"win-title",key:"title",ref:r,title:"Verschieben"},P),je.includes(N)&&Ql("span",{className:"win-topbtn",onClick:e=>{Xe(N,h,k,E,C,T),S(e)}},"pobtnm",Yl||(Yl=Ql(Ri.srV,{}))),Ql("span",{className:"win-topbtn",onClick:b,title:"Maximieren"},"maxbtn","↑"),Ql("span",{className:"win-topbtn close",onClick:S,title:"Schließen"},"closebtn","X")),Pe.createElement("div",{className:"win-resize",key:"winres",title:"Größe ändern",ref:o},"▨"),Ql("div",{className:"win-content"},"content",Ql(Qe.Provider,{value:p},void 0,Ql(A,{}))))},Jl=Pe.memo(Xl);var ec;function tc(e,t,n,i){ec||(ec="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ec,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nc=()=>{const e=(0,Oe.v9)(zi,Oe.wU),[t,n]=(0,Oe.v9)(Wi,Oe.wU),i=(0,Oe.I0)();return t&&e.length?tc("div",{id:"wm"},void 0,tc(oi,{show:n,onClick:()=>i({type:"CLOSE_FULLSCREEN_WINS"})}),e.map((e=>tc(Jl,{id:e},e)))):null};var ic,rc,oc,sc;function ac(e,t,n,i){sc||(sc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:sc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const lc={style:{verticalAlign:"middle"}},cc=()=>Pe.createElement(Pe.Fragment,null,ic||(ic=ac(We,{})),rc||(rc=ac(De.Pd.Provider,{value:lc},void 0,ac(rt,{}),ac(Yt,{}),ac(yt,{}),ac(ht,{}),ac(Ue,{}),ac(Oi,{}),ac(xi,{}),ac(nc,{}))));(0,i.p5)(Ae,{},(()=>{function e(){Ae.dispatch((0,o.Qr)())}window.addEventListener("message",Ae.dispatch),Ae.dispatch({type:"HYDRATED"}),h.Z.initialize(Ae,B,ye),X.initialize(Ae),window.addEventListener("hashchange",(()=>{Ae.dispatch((0,o.fL)())})),window.imMobile=function(){delete window.imMobile,Ae.dispatch((0,o.bv)(!0))},document.addEventListener("touchstart",window.imMobile,{once:!0}),window.addEventListener("resize",e),e(),Ae.dispatch((0,o.vb)()),Ae.dispatch((0,d.aM)()),B.initialize(Ae,h.Z,ye)})),function(){const e=()=>{window.name="main",function(e,t){(0,Re.s)(e).render(ac(Oe.zt,{store:t},void 0,oc||(oc=ac(cc,{}))))}(document.getElementById("app"),Ae);const t=function(e){return t=>{if("INPUT"===t.target.nodeName||"TEXTAREA"===t.target.nodeName)return;let{key:n}=t;const i=Number(n);if(!Number.isNaN(i)&&i>0){const{canvases:t,canvasId:n}=e.getState().canvas,r=Object.keys(t).filter((e=>!t[e].hid));if(i<=r.length){const s=r[i-1];if(s!==n){e.dispatch((0,o.SC)(s));const n=t[s].title;e.dispatch((0,d.h4)(`Gewechselt zu ${n}`))}}}else{switch(t.code){case"ArrowUp":case"KeyW":return void e.dispatch((0,o.mx)(-1));case"ArrowLeft":case"KeyA":return void e.dispatch((0,o.mW)(-1));case"ArrowDown":case"KeyS":return void e.dispatch((0,o.mx)(1));case"ArrowRight":case"KeyD":return void e.dispatch((0,o.mW)(1));case"KeyE":return void e.dispatch((0,o.WW)(1));case"KeyQ":return void e.dispatch((0,o.WW)(-1))}switch(t.key){case"+":return void e.dispatch((0,o.WW)(1));case"-":return void e.dispatch((0,o.WW)(-1));case"Control":return void e.dispatch((0,o.Or)(-1));case"Shift":return t.location===KeyboardEvent.DOM_KEY_LOCATION_LEFT?void e.dispatch((0,o.UW)(c.EQ.PENCIL,!0)):t.location===KeyboardEvent.DOM_KEY_LOCATION_RIGHT?void e.dispatch((0,o.UW)(e.getState().templates.oRightShift?c.EQ.OVERLAY:c.EQ.HISTORY,!0)):void 0}if(!u.includes(n)){if(n=t.code,!n.startsWith("Key"))return;n=n.slice(-1).toLowerCase()}switch(n){case"g":return e.dispatch((0,o.xK)()),void e.dispatch((0,d.h4)(e.getState().gui.showGrid?"Raster Ein":"Raster Aus"));case"h":return void(window?.ssv.backupurl&&e.dispatch((0,o.FI)()));case"x":return e.dispatch((0,o.Xb)()),void e.dispatch((0,d.h4)(e.getState().gui.showPixelNotify?"Pixelaktivität Ein":"Pixelaktivität Aus"));case"m":return e.dispatch((0,o.$t)()),void e.dispatch((0,d.h4)(e.getState().gui.mute?"Ton stummgeschaltet":"Ton eingeschaltet"));case"n":return void e.dispatch((0,o.qP)());case"r":{const{hover:t}=e.getState().canvas,n=t.join("_");return(0,r.Z)(n),void e.dispatch((0,d.h4)("Kopiert"))}case"t":return e.dispatch({type:"s/TGL_OVENABLED"}),void e.dispatch((0,d.h4)(e.getState().templates.ovEnabled?"Overlay EIN":"Overlay AUS"));case"l":e.dispatch((0,o.u0)()),e.dispatch((0,d.h4)(e.getState().gui.easterEgg?"Osterei EIN":"Osterei AUS"))}}}}(Ae),n=function(e){return t=>{switch(t.code){case"ArrowUp":case"KeyW":case"ArrowDown":case"KeyS":return void e.dispatch((0,o.mx)(0));case"ArrowLeft":case"KeyA":case"ArrowRight":case"KeyD":return void e.dispatch((0,o.mW)(0));case"KeyE":case"KeyQ":return void e.dispatch((0,o.WW)(0))}switch(t.key){case"+":case"-":return void e.dispatch((0,o.WW)(0));case"Shift":case"CapsLock":e.dispatch((0,o.UW)(c.EQ.OFF))}}}(Ae);document.addEventListener("keydown",t,!1),document.addEventListener("keyup",n,!1),setInterval((()=>{ye().gc()}),c.PR),document.removeEventListener("DOMContentLoaded",e)};document.addEventListener("DOMContentLoaded",e,!1)}()},389:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(7294);const r=function(e,t){const n=(0,i.useRef)();(0,i.useEffect)((()=>{n.current=e}),[e]),(0,i.useEffect)((()=>{function e(){n.current()}if(null!==t){e();const n=setInterval(e,t);return()=>clearInterval(n)}}),[t])}},940:(e,t,n)=>{n.d(t,{A$:()=>r,EQ:()=>v,Fv:()=>i,I_:()=>l,Kb:()=>u,PR:()=>m,Tj:()=>s,U4:()=>f,V4:()=>o,WF:()=>p,fS:()=>a,p7:()=>c,vB:()=>g,vc:()=>d,wL:()=>h});const i=40,r=3,o="0",s=128,a=32,l=256,c=2,d=2592e6,u=100,h=1e3,f=2e3,p=3e5,m=3e5,v={OFF:0,PENCIL:1,HISTORY:2,OVERLAY:3},g=8},259:(e,t,n)=>{n.d(t,{Cr:()=>g,D$:()=>S,D0:()=>m,HD:()=>c,IU:()=>I,NK:()=>h,Ss:()=>u,TP:()=>E,UW:()=>s,VL:()=>w,W4:()=>d,Z:()=>k,_I:()=>A,_N:()=>N,_O:()=>p,_V:()=>D,ad:()=>P,b3:()=>T,bG:()=>L,bt:()=>O,gx:()=>y,h$:()=>R,lg:()=>C,nK:()=>v,r6:()=>x,s3:()=>f,sG:()=>l,tF:()=>_,uZ:()=>o,x2:()=>a});var i=n(940);function r(e,t){return(e%t+t)%t}function o(e,t,n){return Math.max(t,Math.min(e,n))}function s(e){return e.substring(0,4)+e.substring(5,7)+e.substring(8)}function a(){const e=new Date;let t=e.getUTCDate(),n=e.getUTCMonth()+1;return n<10&&(n=`0${n}`),t<10&&(t=`0${t}`),`${e.getUTCFullYear()}-${n}-${t}`}function l(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=null===r?i.I_:i.fS,s=null==r?n:r;return[Math.floor((t+e/2)/o),Math.floor((s+e/2)/o)]}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.map((t=>Math.floor((t+n/2)/i.I_*e)))}function d(e){return e?Math.log2(e/i.I_)/i.p7*2:0}function u(e,t,n){if(e&&n){let t=n.length;for(;t>0;){t-=1;const[i,r]=n[t];if(e<=i)return r}}return t}function h(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=null===o?i.I_:i.fS,a=null==o?n:o;let l=null===o?0:n*s*s;const c=r(e/2,s),d=r(t+c,s);return l+=r(a+c,s)*s+d,l}function f(e,t){const n=Object.keys(e);for(let i=0;i<n.length;i+=1){const r=n[i];if(e[r].ident===t)return r}return null}function p(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=o?i.fS:i.I_,a=n%s,l=n-a;let c=l%(s*s);const d=o?(l-c)/s/s:null;c/=s;const u=r/2/s;return[(e-u)*s+a,(t-u)*s+c,d]}function m(e,t){return t.map((t=>r(t+e/2,i.I_)))}function v(e,t,n,i){let[r,o]=i;const[s,a]=e,{width:l,height:c}=n;return[Math.floor((r-l/2)/t+s),Math.floor((o-c/2)/t+a)]}function g(e,t,n,i){let[r,o]=i;const[s,a]=e,{width:l,height:c}=n;return[(r-s)*t+l/2,(o-a)*t+c/2]}function w(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Math.ceil(e/1e3);let i;return i=n<60&&t?n:`${Math.floor(n/60)}:${("0"+n%60).slice(-2)}`,i}function y(e){const t=e%60;let n=(e-t)/60;const i=n%60;n=(n-i)/60;const r=n%24;n=(n-r)/24;let o="";return n&&(o+=` ${n}d`),r&&(o+=` ${r}h`),i&&(o+=` ${i}min`),t&&(o+=` ${t}s`),o}const b=["k","M","B"];function S(e){if(!e)return"N/A";if(e<1e3)return e;let t=0;for(;t<b.length;){if(e<1e4)return`${Math.floor(e/1e3)}.${`0${Math.floor(e%1e3/10)}`.slice(-2)}${b[t]}`;if(e<1e5)return`${Math.floor(e/1e3)}.${Math.floor(e%1e3/100)}${b[t]}`;if(e<1e6)return Math.floor(e/1e3)+b[t];t+=1,e=Math.round(e/1e3)}return""}function k(e){if(!e)return"#000000";let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return`#${`00000${(16777215&t).toString(16).toUpperCase()}`.slice(-6)}`}function E(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];3===(e=e.replace(/^\s*#|\s*$/g,"")).length&&(e=e.replace(/(.)/g,"$1$1"));let n=Math.floor(parseInt(e.substring(0,2),16)/2),i=Math.floor(parseInt(e.substring(2,4),16)/2),r=Math.floor(parseInt(e.substring(4,6),16)/2);return t&&(n+=128,i+=128,r+=128),n=`0${n.toString(16)}`.slice(-2),i=`0${i.toString(16)}`.slice(-2),r=`0${r.toString(16)}`.slice(-2),`#${n}${i}${r}`}function C(e){const t=["\\","[","]","(",")","*","~","+","_","\n"];let n="",i=0;for(let r=0;r<e.length;r+=1){const o=e[r];t.includes(o)&&(n+=`${e.slice(i,r)}\\`,i=r)}return 0===i?e:(n+=e.slice(i),n)}function T(){try{const e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch{return!1}}function I(e){let t=e.indexOf("://")+3;t<3&&(t=0),e.startsWith("www.",t)&&(t+=4);let n=e.indexOf("/",t);return-1===n&&(n=e.length),e.endsWith(".com",n)&&(n-=4),n<=t?e:e.slice(t,n)}function x(e){let t=e.indexOf("&");-1===t&&(t=e.length);let n=t-1;for(;n>=0&&"."!==e[n];n-=1)if("/"===e[n])return null;return n+=1,t-n>4?null:e.slice(n,t)}function N(e){let t=e.indexOf("?");return-1===t&&(t=e.indexOf("#")),-1===t?e:e.substring(0,t)}function _(e){const t=new Date,n=new Date(1e3*e);return n.getDate()!==t.getDate()?n.toLocaleString():n.toLocaleTimeString()}function A(e){let t=e.lastIndexOf("#"),n=[];if(-1!==t){let i=e.slice(t+1);t=i.indexOf("?"),-1!==t&&(i=i.slice(0,t)),n=i.split(",").map((e=>parseInt(e,10))).slice(1,3)}return(2!==n.length||n.some(Number.isNaN))&&(n=e.split("_").map((e=>parseInt(e,10)))),(2!==n.length||n.some(Number.isNaN))&&(n=e.split(",").map((e=>parseInt(e,10)))),(2!==n.length||n.some(Number.isNaN))&&(n=null),n}function L(e){if(!e)return 0;const t=e.slice(-1).toLowerCase(),n=parseInt(e.slice(0,-1),10);if(Number.isNaN(n)||n<=0||n>600||!["s","m","h","d"].includes(t))return 0;let i=1e3;return"m"===t?i*=60:"h"===t?i*=3600:"d"===t&&(i*=86400),n*i}function P(e,t){let n=0;for(let i=0;i<e.length;i+=1){const r=Math.abs(e[i]-t[i]);r>n&&(n=r)}return n}function O(e){if(e instanceof TouchEvent){const t=e.touches.length?e.touches:e.changedTouches;let n=0,i=0;for(const{pageX:e,pageY:r}of t)n+=e,i+=r;const{length:r}=t;return[n/r,i/r]}return[e.clientX,e.clientY]}function R(e){return new Promise((t=>{const n=new Blob([e]),i=new FileReader;i.onload=e=>{const n=e.target.result,[,i]=n.split(",");t(i)},i.readAsDataURL(n)}))}async function D(e){const t=`data:application/octet-binary;base64,${e}`;return(await fetch(t)).arrayBuffer()}},631:(e,t,n)=>{n.d(t,{A:()=>N,AP:()=>p,E1:()=>f,Es:()=>x,Fx:()=>o,I6:()=>h,JL:()=>_,K$:()=>I,No:()=>m,Oh:()=>g,PS:()=>d,Pw:()=>k,Wt:()=>b,e9:()=>y,fF:()=>S,ft:()=>w,hH:()=>C,jK:()=>A,ko:()=>u,s$:()=>T,uY:()=>r,uw:()=>v,yx:()=>E});var i=n(259);const r=function(){if(!window.ssv||!window.ssv.shard||"fuckyouarkeros.fun"===window.location.host)return"";const e=window.location.host.split(".");return e.length>2&&e.shift(),`${window.ssv.shard}.${e.join(".")}`}(),o=r&&`${window.location.protocol}//${r}`;async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeout:n=3e4}=t,i=new AbortController,r=setTimeout((()=>i.abort()),n),o=await fetch(e,{...t,signal:i.signal});return clearTimeout(r),o}async function a(e){const{status:t}=e;if(429===t){let t="Zu viele Anfragen gesendet";const n=e.headers.get("Retry-After");return Number.isNaN(Number(n))||(t+=`, versuche es nach ${Math.floor(n/60)}min nochmal`),{errors:[t]}}try{return await e.json()}catch(e){return{errors:[`Verbindungsfehler ${t} :(`]}}}async function l(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])&&(e=`${o}${e}`);try{return a(await s(e,{method:"POST",credentials:n?"include":"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}))}catch(e){return{errors:["Kann nicht zum Server verbinden, bitte versuche es später noch einmal :("]}}}async function c(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e=`${o}${e}`);try{return a(await s(e,{credentials:t?"include":"omit"}))}catch(e){return{errors:["Kann nicht zum Server verbinden, bitte versuche es später noch einmal :("]}}}async function d(e,t){const n=await l("/api/block",{userId:e,block:t});return n.errors?n.errors[0]:"ok"===n.status?null:"Unbekannter Fehler"}async function u(e){const t=await l("/api/privatize",{priv:e});return t.errors?t.errors[0]:"ok"===t.status?null:"Unbekannter Fehler"}async function h(e){const t=await l("/api/startdm",e);return t.errors?t.errors[0]:t.channel?t.channel:"Unbekannter Fehler"}async function f(e){const t=await l("/api/blockdm",{block:e});return t.errors?t.errors[0]:"ok"===t.status?null:"Unbekannter Fehler"}async function p(e){const t=await l("/api/leavechan",{channelId:e});return t.errors?t.errors[0]:"ok"===t.status?null:"Unbekannter Fehler"}async function m(e,t){try{const n=`/history?day=${(0,i.UW)(e)}&id=${t}`,r=await s(n,{credentials:"omit",timeout:45e3});if(200!==r.status)return[];return["00:00",...(await r.json()).map((e=>`${e.substring(0,2)}:${e.substring(2)}`))]}catch{return[]}}async function v(e){const t=await fetch(`${o}/api/chathistory?cid=${e}&limit=50`,{credentials:"include"});if(t.ok){const{history:e}=await t.json();return e}return null}function g(e,t){return l("/api/auth/change_passwd",{password:t,newPassword:e})}async function w(){return c("/api/auth/resend_verify")}async function y(){return!c("/api/auth/logout").errors}function b(e){return l("/api/auth/change_name",{name:e})}function S(e,t){return l("/api/auth/change_mail",{email:e,password:t})}function k(e,t){return l("/api/auth/local",{nameoremail:e,password:t})}function E(e,t,n,i,r){return l("/api/auth/register",{name:e,email:t,password:n,captcha:i,captchaid:r})}function C(e){return l("/api/auth/restore_password",{email:e})}function T(e){return l("/api/auth/delete_account",{password:e})}function I(){return c("/ranking",!1)}function x(){return c("/api/baninfo")}async function N(){if(window.me){const e=await window.me;return delete window.me,a(e)}return c("/api/me")}function _(){return c("/api/getiid")}function A(e){return l("/api/banme",{code:e})}},403:(e,t,n)=>{function i(e,t,n){return{type:"ALERT",title:e,message:t,alertType:n,btn:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OK"}}function r(){return{type:"CLOSE_ALERT"}}function o(){return{type:"s/TGL_HISTORICAL_VIEW"}}function s(){return{type:"s/TGL_EASTER_EGG"}}function a(){return{type:"s/TGL_GRID"}}function l(){return{type:"s/TGL_PXL_NOTIFY"}}function c(){return{type:"s/TGL_MVM_CTRLS"}}function d(){return{type:"s/TGL_AUTO_ZOOM_IN"}}function u(){return{type:"s/TGL_ONLINE_CANVAS"}}function h(){return{type:"s/TGL_MUTE"}}function f(){return{type:"s/TGL_COMPACT_PALETTE"}}function p(){return{type:"s/TGL_CHAT_NOTIFY"}}function m(){return{type:"s/TGL_POTATO_MODE"}}function v(){return{type:"s/TGL_LIGHT_GRID"}}function g(){return{type:"s/TGL_OPEN_PALETTE"}}function w(e,t){return{type:"s/SELECT_HOLD_PAINT",value:e,immediate:t}}function y(){return{type:"SELECT_HOVER_COLOR"}}function b(e){return{type:"s/SELECT_STYLE",style:e}}function S(){return{type:"s/TGL_OPEN_MENU"}}function k(e){return{type:"SET_HOVER",hover:e}}function E(){return{type:"UNSET_HOVER"}}function C(e){return{type:"SET_MOBILE",mobile:e}}function T(){return{type:"WIN_RESIZE"}}function I(e){return{type:"SELECT_COLOR",color:e}}function x(e){return{type:"s/SELECT_CANVAS",canvasId:String(e)}}function N(e){return{type:"UPDATE_VIEW",view:e}}function _(e){return{type:"SET_VIEW_COORDINATES",view:e}}function A(e){return{type:"s/SET_MOVE_U",value:e}}function L(e){return{type:"s/SET_MOVE_V",value:e}}function P(e){return{type:"s/SET_MOVE_W",value:e}}function O(e){return{type:"s/CANCEL_MOVE",value:e}}function R(e){return{type:"REQ_BIG_CHUNK",center:e}}function D(e){return{type:"REMOVE_CHUNKS",chunks:e}}function $(e){return{type:"REC_BIG_CHUNK",chunk:e}}function M(e,t){return{type:"REC_BIG_CHUNK_FAILURE",chunk:e,error:t}}function W(e){return{type:"s/REC_ME",...e}}function z(e){const{ranking:t,dailyRanking:n,dailyCRanking:i,prevTop:r,onlineStats:o,cHistStats:s,histStats:a,pDailyStats:l,pHourlyStats:c}=e;return{type:"REC_STATS",totalRanking:t,totalDailyRanking:n,dailyCRanking:i,prevTop:r,onlineStats:o,cHistStats:s,histStats:a,pDailyStats:l,pHourlyStats:c}}function V(e,t){return{type:"s/REQ_CHAT_MESSAGE",text:e,channel:t}}function H(){return{type:"s/LOGOUT"}}function U(e){return{type:"s/LOGIN",...e}}function F(e){return{type:"s/SET_NAME",name:e}}function G(e){return{type:"s/SET_MAILREG",mailreg:e}}function B(e){return{type:"MARK_CHANNEL_AS_READ",cid:e}}function K(){return(e,t)=>{setInterval((function(){const n=function(e){const t=[],n=Date.now(),{wait:i}=e.user,r=i-n;return null!=i&&(r>0?t.push(function(e){return{type:"COOLDOWN_SET",coolDown:e}}(r)):t.push({type:"COOLDOWN_END"})),t}(t());e(n)}),333)}}function Z(e,t){return{type:"s/BLOCK_USER",userId:e,userName:t}}function j(e,t){return{type:"s/UNBLOCK_USER",userId:e,userName:t}}function Y(e){return{type:"s/SET_BLOCKING_DM",blockDm:e}}function q(e){return{type:"s/SET_PRIVATE",priv:e}}function Q(e){return{type:"s/MUTE_CHAT_CHANNEL",cid:e}}function X(e){return{type:"s/UNMUTE_CHAT_CHANNEL",cid:e}}function J(e,t){return{type:"SET_HISTORICAL_TIME",date:e,time:t}}function ee(){return{type:"RELOAD_URL"}}function te(){return{type:"t/UNLOAD"}}function ne(e){const{id:t,name:n,mailreg:i,blockDm:r,userlvl:o}=e.user,{canvases:s}=e.canvas,{blocked:a,channels:l}=e.chat,{ranking:c,dailyRanking:d,totalPixels:u,dailyTotalPixels:h}=e.ranks;return{type:"s/REC_ME",blockDm:r,blocked:a,canvases:s,channels:l,dailyRanking:d,dailyTotalPixels:h,id:t,mailreg:i,name:n,ranking:c,totalPixels:u,userlvl:o}}n.d(t,{$t:()=>h,Ai:()=>Y,BH:()=>E,Cd:()=>f,Eo:()=>B,FI:()=>o,GY:()=>ne,GZ:()=>k,Hw:()=>W,IN:()=>q,KB:()=>g,M6:()=>r,MM:()=>b,NK:()=>N,OJ:()=>O,Oh:()=>I,Or:()=>y,Qr:()=>T,RL:()=>m,Rz:()=>te,SC:()=>x,TG:()=>R,TX:()=>H,Tl:()=>z,UI:()=>i,UW:()=>w,WW:()=>P,Xb:()=>l,Y2:()=>G,_:()=>u,_P:()=>$,bE:()=>V,bv:()=>C,c7:()=>p,fL:()=>ee,ge:()=>D,mW:()=>A,mx:()=>L,nb:()=>Q,o7:()=>d,on:()=>J,pH:()=>U,qC:()=>F,qP:()=>c,rf:()=>Z,sW:()=>M,ts:()=>v,u0:()=>s,vN:()=>S,vb:()=>K,w5:()=>_,wC:()=>X,xK:()=>a,zv:()=>j})},395:(e,t,n)=>{function i(){return{type:"w/CLOSE"}}function r(){return{type:"w/OPEN"}}function o(e,t,n,i,r){return(o,s)=>{i=Number(i);const a=s();let l;l=a.windows?a.windows.windows.some((e=>"CHAT"===e.windowType&&!e.hidden))&&Object.values(a.windows.args).some((e=>e.chatChannel===i)):"CHAT"===a.popup.windowType||a.popup.args.chatChannel===i,o({type:"s/REC_CHAT_MESSAGE",name:e,text:t,country:n,channel:i,user:r,isPing:!1,isRead:l})}}function s(e){return{type:"REC_COOLDOWN",wait:e}}function a(e){return{type:"REC_ONLINE",online:e}}function l(e){return{type:"s/ADD_CHAT_CHANNEL",channel:e}}function c(e){return{type:"s/REMOVE_CHAT_CHANNEL",cid:e}}function d(e){return{type:"SET_PXLS_FETCHING",fetching:e}}function u(e){return e.type="REC_SET_PXLS",e}n.d(t,{$s:()=>r,At:()=>s,W1:()=>u,WV:()=>i,Wm:()=>a,cC:()=>d,dm:()=>l,jg:()=>c,pl:()=>o})},669:(e,t,n)=>{n.d(t,{K6:()=>m,Ox:()=>h,R0:()=>f,TL:()=>u,YB:()=>l,aM:()=>d,eg:()=>p,h4:()=>g,mP:()=>c});var i=n(631),r=n(403),o=n(395);function s(e){return{type:"SET_API_FETCHING",fetching:e}}function a(e){return{type:"s/SET_CHAT_FETCHING",fetching:e}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return async n=>{n(s(!0));const a=await(0,i.I6)(e);if("string"==typeof a)n((0,r.UI)("Direct Message Error",a,"error","OK"));else{const e=Number(Object.keys(a)[0]);n((0,o.dm)(a)),t&&t(e)}n(s(!1))}}function c(){return async e=>{const t=await(0,i.K$)();t.errors||e((0,r.Tl)(t))}}function d(){return async e=>{const t=await(0,i.A)();t.errors||e((0,r.Hw)(t))}}function u(e){return async t=>{t(a(!0));const n=await(0,i.uw)(e);n?(setTimeout((()=>{t(a(!1))}),500),t(function(e,t){return{type:"s/REC_CHAT_HISTORY",cid:e,history:t}}(e,n))):setTimeout((()=>{t(a(!1))}),5e3)}}function h(e,t,n){return async o=>{o(s(!0));const a=await(0,i.PS)(e,n);o(a?(0,r.UI)("User Block Error",a,"error","OK"):n?(0,r.rf)(e,t):(0,r.zv)(e,t)),o(s(!1))}}function f(e){return async t=>{t(s(!0));const n=await(0,i.E1)(e);t(n?(0,r.UI)("Blocking DMs Error",n,"error","OK"):(0,r.Ai)(e)),t(s(!1))}}function p(e){return async t=>{t(s(!0));const n=await(0,i.ko)(e);t(n?(0,r.UI)("Setting User Private Error",n,"error","OK"):(0,r.IN)(e)),t(s(!1))}}function m(e){return async t=>{t(s(!0));const n=await(0,i.AP)(e);t(n?(0,r.UI)("Leaving Channel Error",n,"error","OK"):(0,o.jg)(e)),t(s(!1))}}let v=null;function g(e){return t=>{t(function(e){return{type:"SET_NOTIFICATION",notification:e}}(e)),v&&(clearTimeout(v),v=null),v=setTimeout((()=>{t({type:"UNSET_NOTIFICATION"})}),1500)}}},130:(e,t,n)=>{n.d(t,{s:()=>i,x:()=>r});const i=e=>-1!==e.gui.style.indexOf("dark"),r=e=>[e.canvas.is3D,e.gui.showMvmCtrls||e.user.isOnMobile&&(e.canvas.is3D||e.gui.holdPaint>0&&!e.canvas.isHistoricalView)]},802:(e,t,n)=>{n.d(t,{Z:()=>i});const i=class{recUpdates=!1;timestamp;z;i;j;constructor(e,t,n){this.timestamp=Date.now(),this.z=e,this.i=t,this.j=n}get id(){return this.i<<8|this.j}touch(){this.timestamp=Date.now()}destructor(){}}},686:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(403),r=n(940);const o=class{#t;#r=new Map;#o;constructor(e,t){this.#t=e,this.#o=t}get canvasId(){return this.#o}get recChunkIds(){const e=[];return this.#r.forEach((t=>{t.recUpdates&&e.push(t.id)})),e}destructor(){this.#r.forEach((e=>{e.destructor()})),this.#r=new Map}cget(e){return this.#r.get(e)}cset(e,t){this.#r.set(e,t)}bcReqChunk(e){const{z:t,i:n,j:r}=e;this.#t.dispatch((0,i.TG)([t,n,r]))}bcRecChunk(e){this.#t.dispatch((0,i._P)(e));const{size:t}=this.#r;if(t>r.U4){const e=t-Math.floor(.9*r.U4),n=Array.from(this.#r.entries()).sort(((e,t)=>e[1].timestamp-t[1].timestamp)).slice(0,e);n.forEach((e=>{let[t]=e;this.#r.delete(t)}));const i=n.map((e=>e[1]));this.bcRemoveChunks(i),console.log(`Cleared ${i.length} to cut amount of chunks to ${this.#r.size}`)}}bcReqChunkFail(e,t){this.#t.dispatch((0,i.sW)(e,t.message))}bcRemoveChunks(e){this.#t.dispatch((0,i.ge)(e))}gc(e){const t=Date.now()-r.WF,n=this.#r,i=[];n.forEach(((r,o)=>{if(t>r.timestamp){const{z:t,i:s,j:a}=r;e.isChunkInView(t,s,a)||(i.push(r),n.delete(o),r.destructor())}})),i.length&&this.bcRemoveChunks(i),console.log(`GC cleaned ${i.length} / ${n.size+i.length} chunks`)}}},906:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(403),r=n(395),o=n(669);const s=new class{constructor(){this.requestFromQueue=this.requestFromQueue.bind(this),this.pixelQueue=[],this.clientPredictions=[],this.extension=null,window.registerPixelUpdates=e=>{this.extension=e}}initialize(e,t,n){this.store=e,this.socketClient=t,this.getRenderer=n}async requestFromQueue(){const{store:e}=this;if(!this.pixelQueue.length)return void e.dispatch((0,r.cC)(!1));e.dispatch((0,r.cC)(!0));const{i:t,j:n,pixels:s}=this.pixelQueue.shift();let a;try{a=await this.socketClient.sendPixelUpdate(t,n,s)}catch{a={retCode:16,coolDownSeconds:0,pxlCnt:0},e.dispatch((0,i.UI)("Zeitüberschreitung","Keine Antwort von pixelplanet erhalten. Falls das Problem weiterhin besteht, versuche es, die Seite neu zu laden.","error"))}const{retCode:l,coolDownSeconds:c,pxlCnt:d}=a;if(c&&e.dispatch((0,o.h4)(c)),d<s.length){const[e]=s[d];this.revertPredictionsAt(t,n,e),this.pixelQueue=[]}let u=null,h=null,f="error";switch(l){case 0:case 9:break;case 1:u="Ungültige Leinwand",h="Diese Leinwand existiert nicht";break;case 2:u="Ungültige Koordinaten",h="x außerhalb des Spielfelds";break;case 3:u="Ungültige Koordinaten",h="y außerhalb des Spielfelds";break;case 4:u="Ungültige Koordinaten",h="z außerhalb des Spielfelds";break;case 5:u="Falsche Farbe",h="Ungültige Farbe ausgewählt";break;case 6:u="Nur für registrierte Spieler",h="Melde dich an um auf dieser Leinwand zu spielen";break;case 7:u="Nicht erlaubt",h="Du kannst diese Leinwand noch nicht verwenden, weil dein Pixel Punktestand zu gering ist. Platziere mehr Pixel";break;case 8:e.dispatch((0,o.h4)("Pixel beschützt"));break;case 10:u="Captcha",h="Bitte beweise, dass du ein Mensch bist",f="captcha";break;case 11:u="Nicht erlaubt",h="Du benutzt ein Proxy.";break;case 12:u="Nicht erlaubt",h="Nur die Top10 Spieler von gestern dürfen hier spielen";break;case 13:u="Du bist seltsam",h="Der Server wurde von deinen Pixeln verwirrt. Spielst du auf mehreren Geräten?";break;case 14:u="Gebannt",f="ban";break;case 15:u="IP Bereich Gebannt",h="Dein Internet Anbieter ist von diesem Spiel verbannt";break;case 16:u="Zeitüberschreitung",h="Keine Antwort von pixelplanet erhalten. Falls das Problem weiterhin besteht, versuche es, die Seite neu zu laden.";break;default:u="Komisch",h="Konnte kein Pixel setzen"}(h||u)&&e.dispatch((0,i.UI)(u||`Fehler ${l}`,h,f)),e.dispatch((0,r.W1)(a)),setTimeout(this.requestFromQueue,100)}revertPredictionsAt(e,t,n){const i=this.getRenderer(),{clientPredictions:r}=this;let o=0;for(;o<r.length;){const i=r[o];if(i[0]===e&&i[1]===t&&i[2]===n)break;o+=1}const s=o;for(;o<r.length;){const[e,t,n,s]=r[o];i.renderPixel(e,t,n,s,!1),o+=1}this.clientPredictions.splice(s)}receivePixelUpdate(e){let{i:t,j:n,pixels:i}=e;this.extension&&this.extension(t,n,i),i.forEach((e=>{const[i,r]=e,{clientPredictions:o}=this;for(let e=0;e<o.length;e+=1){const s=o[e];if(s[0]===t&&s[1]===n&&s[2]===i)return void(s[4]===r?o.splice(e,1):s[3]=r)}this.getRenderer().renderPixel(t,n,i,r,!0)}))}tryPlacePixel(e,t,n,i,r){this.getRenderer().renderPixel(e,t,n,i,!1),this.clientPredictions.push([e,t,n,r,i]);const{pixelQueue:o}=this;if(o.length){const r=o[o.length-1],{i:s,j:a}=r;if(e===s&&t===a)return void r.pixels.push([n,i])}o.push({i:e,j:t,pixels:[[n,i]]}),this.store.getState().fetching.fetchingPixel||this.requestFromQueue()}}},785:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(940),r=n(403);const o=class{store;controls={update(){}};chunkLoader=null;is3D=null;forceNextRender=!0;forceNextSubrender=!0;_view=[0,0,0];#s=null;constructor(e){this.store=e}get view(){return[...this._view]}get chunks(){return this.chunkLoader.chunks}get recChunkIds(){return this.chunkLoader?this.chunkLoader.recChunkIds:[]}destructor(){this.chunkLoader?.destructor(),this.cancelStoreViewInState()}updateView(e){for(let t=0;t<e.length;t+=1)this._view[t]=e[t]}loadViewFromState(){this.store&&this.updateView(this.store.getState().canvas.view)}cancelStoreViewInState(){this.#s&&(clearTimeout(this.#s),this.#s=null)}storeViewInState(){this.store&&(this.cancelStoreViewInState(),this.#s=setTimeout((()=>{this.#s=null,this.store.dispatch((0,r.NK)(this.view))}),i.wL))}render(){return this.controls.update(this.forceNextRender)}renderPixel(){}updateCanvasData(){}getPointedColor(){return null}isChunkInView(){return!0}gc(){this.chunkLoader?.gc(this)}}},917:(e,t,n)=>{async function i(e){e.toBlob((e=>{try{if(!navigator.clipboard)throw new Error("Clipboard API not implemented");navigator.clipboard.write([new ClipboardItem({"image/png":e})])}catch(e){console.log("Couldn't copy canvas to clipboard",e)}}),"image/png")}n.d(t,{Z:()=>r,w:()=>i});const r=async function(e){if(!navigator.clipboard)return function(e){const t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{const e=document.execCommand("copy");return document.body.removeChild(t),e}catch{return document.body.removeChild(t),!1}}(e);try{return await navigator.clipboard.writeText(e),!0}catch{return!1}}},875:(e,t,n)=>{function i(e){const t=document.createElement("canvas");return t.width=e.naturalWidth,t.height=e.naturalHeight,t.getContext("2d").drawImage(e,0,0),t}function r(e){return new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>{const e=new Image;e.onload=()=>{t(i(e))},e.onerror=e=>n(e),e.src=r.result},r.onerror=e=>n(e),r.readAsDataURL(e)}))}function o(e,t){return r(new Blob([e],{type:t}))}function s(e,t){return new Promise(((n,i)=>{e.toBlob((e=>{e.arrayBuffer().then(n).catch(i)}),t)}))}n.d(t,{NE:()=>r,NF:()=>o,nE:()=>s,zE:()=>i})}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,o),n.exports}o.m=i,e=[],o.O=(t,n,i,r)=>{if(!n){var s=1/0;for(d=0;d<e.length;d++){for(var[n,i,r]=e[d],a=!0,l=0;l<n.length;l++)(!1&r||s>=r)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(a=!1,r<s&&(s=r));if(a){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>841===e?"three.1848d82f.js":{189:"modtools",545:"converter",784:"stats",882:"voxel"}[e]+".de."+{189:"10a91915",545:"7a1d1ef0",784:"0bd0748c",882:"5de4fbcc"}[e]+".js",o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="pixelplanet:",o.l=(e,i,r,s)=>{if(t[e])t[e].push(i);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+r){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",n+r),a.src=e),t[e]=[i];var h=(n,i)=>{a.onerror=a.onload=null,clearTimeout(f);var r=t[e];if(delete t[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(i))),n)return n(i)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=47,o.p="/assets/",(()=>{var e={47:0};o.f.j=(t,n)=>{var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=r);var s=o.p+o.u(t),a=new Error;o.l(s,(n=>{if(o.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[s,a,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);if(l)var d=l(o)}for(t&&t(n);c<s.length;c++)r=s[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},n=self.webpackChunkpixelplanet=self.webpackChunkpixelplanet||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=o.O(void 0,[736],(()=>o(633)));s=o.O(s)})();